package com.dvgodoy.spark.benford.integration

import com.dvgodoy.spark.benford.distributions.{Benford, Bootstrap}
import com.dvgodoy.spark.benford.util._
import org.apache.spark.rdd.RDD
import play.api.libs.json._

class BenfordAnalysisSuite extends SparkSuite {
  protected val boot = Bootstrap()
  protected val benf = Benford()

  protected var data: DataByLevel = _
  protected var basicBoot: BasicBoot = _
  protected var dataStatsRDD: Array[RDD[((Long, Int), StatsDigits)]] = _
  protected var sampleRDD: Array[RDD[StatsCIByLevel]] = _
  protected var benfordRDD: Array[RDD[StatsCIByLevel]] = _
  protected var resultsRDD: Array[RDD[ResultsByLevel]] = _

  implicit val jobId = JobId("test")

  override def loadAndProcessData(): Unit = {
    val numSamples = 1000
    data =  boot.loadData(sc, "./src/test/resources/datalevels.csv")
    val idxs = data.levels.keys
    basicBoot = boot.calcBasicBoot(sc, data, 1000)
    dataStatsRDD = new Array[RDD[((Long, Int), StatsDigits)]](idxs.size)
    sampleRDD = new Array[RDD[StatsCIByLevel]](idxs.size)
    benfordRDD = new Array[RDD[StatsCIByLevel]](idxs.size)
    resultsRDD = new Array[RDD[ResultsByLevel]](idxs.size)

    for (groupId <- (0 to idxs.size - 1)) {
      dataStatsRDD(groupId) = boot.calcDataStats(data, groupId)
      sampleRDD(groupId) = boot.calcSampleCIs(basicBoot, dataStatsRDD(groupId), data, groupId)
      benfordRDD(groupId) = benf.calcBenfordCIs(basicBoot, dataStatsRDD(groupId), data, groupId)
      resultsRDD(groupId) = boot.calcResults(sampleRDD(groupId), benfordRDD(groupId))
    }
  }

  test("loadData works") {
    data.dataByLevelsRDD.count() must be(3000)
  }

  test("levelIdx assignment is correct") {
    data.levels(0) must be(("L.1",0))
    data.levels(1) must be(("L.1.A",1))
    data.levels(2) must be(("L.1.A.1",2))
    data.levels(3) must be(("L.1.A.2",2))
    data.levels(4) must be(("L.1.B",1))
    data.levels(5) must be(("L.1.B.3",2))
    data.levels(6) must be(("L.1.B.4",2))
  }

  test("hierarchical pointers are correct") {
    data.hierarchy(0) must be(Array(4,1))
    data.hierarchy(1) must be(Array(2,3))
    data.hierarchy(2) must be(Array(-1))
    data.hierarchy(3) must be(Array(-1))
    data.hierarchy(4) must be(Array(6,5))
    data.hierarchy(5) must be(Array(-1))
    data.hierarchy(6) must be(Array(-1))
  }

  test("sample CIs by Group ID are correct") {
    val CI0 = Json.stringify(boot.getCIs(sampleRDD(0)))
    CI0 must be("[{\"id\":0,\"level\":0,\"CIs\":{\"d1d2\":{\"n\":1000,\"mean\":[{\"alpha\":0.975,\"li\":10.9738230535,\"ui\":986.78931379,\"lower\":36.6479245557,\"upper\":40.4072745052,\"t0\":38.568},{\"alpha\":0.99,\"li\":4.261986591,\"ui\":995.1525628948,\"lower\":36.1669732401,\"upper\":40.746427521,\"t0\":38.568}],\"variance\":[{\"alpha\":0.975,\"li\":13.8834658,\"ui\":989.745486374,\"lower\":569.3595713575,\"upper\":694.8305899688,\"t0\":632.625376},{\"alpha\":0.99,\"li\":5.6496603882,\"ui\":996.5763710515,\"lower\":560.4416282621,\"upper\":706.7282994771,\"t0\":632.625376}],\"skewness\":[{\"alpha\":0.975,\"li\":16.6614270417,\"ui\":991.9218296486,\"lower\":0.7058593656,\"upper\":0.9530464908,\"t0\":0.8168660437},{\"alpha\":0.99,\"li\":7.3835889271,\"ui\":997.7846155049,\"lower\":0.6886530865,\"upper\":0.9828913505,\"t0\":0.8168660437}],\"kurtosis\":[{\"alpha\":0.975,\"li\":27.0938103024,\"ui\":997.013713912,\"lower\":-0.6844125193,\"upper\":-0.0498722779,\"t0\":-0.4630422773},{\"alpha\":0.99,\"li\":14.5363421068,\"ui\":1000,\"lower\":-0.7108766802,\"upper\":0.0699198793,\"t0\":-0.4630422773}]},\"d1\":{\"n\":1000,\"mean\":[{\"alpha\":0.975,\"li\":10.7770602352,\"ui\":986.5187055629,\"lower\":3.2483524008,\"upper\":3.6100451502,\"t0\":3.431},{\"alpha\":0.99,\"li\":4.2289708015,\"ui\":995.096480001,\"lower\":3.1942472352,\"upper\":3.6332563816,\"t0\":3.431}],\"variance\":[{\"alpha\":0.975,\"li\":13.5199672132,\"ui\":989.42929649,\"lower\":5.5151488545,\"upper\":6.7218874492,\"t0\":6.105239},{\"alpha\":0.99,\"li\":5.4574503316,\"ui\":996.4137285196,\"lower\":5.4291220091,\"upper\":6.7886312038,\"t0\":6.105239}],\"skewness\":[{\"alpha\":0.975,\"li\":17.811484761,\"ui\":992.6674603271,\"lower\":0.7272704772,\"upper\":0.9714810966,\"t0\":0.8383566405},{\"alpha\":0.99,\"li\":8.0688698928,\"ui\":998.1425522564,\"lower\":0.7152759442,\"upper\":1.0173548086,\"t0\":0.8383566405}],\"kurtosis\":[{\"alpha\":0.975,\"li\":28.0273930336,\"ui\":997.1395707637,\"lower\":-0.6893381016,\"upper\":-0.0441600122,\"t0\":-0.4674906641},{\"alpha\":0.99,\"li\":14.8916260209,\"ui\":1000,\"lower\":-0.7182566268,\"upper\":0.035476781,\"t0\":-0.4674906641}]},\"d2\":{\"n\":1000,\"mean\":[{\"alpha\":0.975,\"li\":13.2879783901,\"ui\":989.3077935555,\"lower\":4.053,\"upper\":4.4961993165,\"t0\":4.258},{\"alpha\":0.99,\"li\":5.956617215,\"ui\":996.9103540812,\"lower\":4.0378794202,\"upper\":4.5394103847,\"t0\":4.258}],\"variance\":[{\"alpha\":0.975,\"li\":17.232635009,\"ui\":991.904275221,\"lower\":7.7077837948,\"upper\":8.6485852951,\"t0\":8.185436},{\"alpha\":0.99,\"li\":6.8356636814,\"ui\":997.313051541,\"lower\":7.5972117893,\"upper\":8.7177490669,\"t0\":8.185436}],\"skewness\":[{\"alpha\":0.975,\"li\":6.7532409558,\"ui\":980.7027172481,\"lower\":-0.0539671868,\"upper\":0.1608822778,\"t0\":0.0743550775},{\"alpha\":0.99,\"li\":2.0190988125,\"ui\":991.0681805697,\"lower\":-0.0827955316,\"upper\":0.1775769906,\"t0\":0.0743550775}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.270615147,\"ui\":989.2900174707,\"lower\":-1.3018608557,\"upper\":-1.1420048085,\"t0\":-1.2302835043},{\"alpha\":0.99,\"li\":5.945504704,\"ui\":996.9008389046,\"lower\":-1.3166576969,\"upper\":-1.1323353189,\"t0\":-1.2302835043}]},\"r\":{\"n\":1000,\"pearson\":[{\"alpha\":0.975,\"li\":11.4937545338,\"ui\":987.4570515754,\"lower\":0.0259792534,\"upper\":0.1688029591,\"t0\":0.0984268144},{\"alpha\":0.99,\"li\":4.2639612671,\"ui\":995.2016014155,\"lower\":0.0082203944,\"upper\":0.1758098222,\"t0\":0.0984268144}],\"alpha0\":[{\"alpha\":0.975,\"li\":13.1933297351,\"ui\":989.1824462238,\"lower\":2.780472813,\"upper\":3.3902867721,\"t0\":3.0690492235},{\"alpha\":0.99,\"li\":5.6793020974,\"ui\":996.6431458848,\"lower\":2.7456055303,\"upper\":3.4552014761,\"t0\":3.0690492235}],\"alpha1\":[{\"alpha\":0.975,\"li\":11.5143759121,\"ui\":987.478803074,\"lower\":0.0225736724,\"upper\":0.1433938094,\"t0\":0.0850048794},{\"alpha\":0.99,\"li\":4.2754482503,\"ui\":995.215116229,\"lower\":0.0072924258,\"upper\":0.1517427315,\"t0\":0.0850048794}],\"beta0\":[{\"alpha\":0.975,\"li\":6.4992111637,\"ui\":978.8354627357,\"lower\":3.4662322824,\"upper\":4.1742063056,\"t0\":3.8669757236},{\"alpha\":0.99,\"li\":2.2607432218,\"ui\":991.0316367552,\"lower\":3.4106753432,\"upper\":4.2393234875,\"t0\":3.8669757236}],\"beta1\":[{\"alpha\":0.975,\"li\":12.272282015,\"ui\":988.2534258439,\"lower\":0.0304234161,\"upper\":0.1980005833,\"t0\":0.1139680199},{\"alpha\":0.99,\"li\":4.6805669625,\"ui\":995.6674981945,\"lower\":0.01260367,\"upper\":0.2051148082,\"t0\":0.1139680199}]}}}]")
    val CI1 = Json.stringify(boot.getCIs(sampleRDD(1)))
    CI1 must be("[{\"id\":1,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":10.2195529451,\"ui\":985.82998367,\"lower\":35.8893125433,\"upper\":40.6512304766,\"t0\":38.4766666667},{\"alpha\":0.99,\"li\":3.8922092546,\"ui\":994.6478856094,\"lower\":35.7477828454,\"upper\":41.0283673825,\"t0\":38.4766666667}],\"variance\":[{\"alpha\":0.975,\"li\":11.6830482282,\"ui\":987.7030660741,\"lower\":538.715214663,\"upper\":684.1653163741,\"t0\":615.9761222222},{\"alpha\":0.99,\"li\":4.0847462364,\"ui\":995.0376492182,\"lower\":507.2326855139,\"upper\":694.0390885164,\"t0\":615.9761222222}],\"skewness\":[{\"alpha\":0.975,\"li\":16.3909804338,\"ui\":991.7290821168,\"lower\":0.6928494187,\"upper\":1.0023146692,\"t0\":0.8314262616},{\"alpha\":0.99,\"li\":7.2095576267,\"ui\":997.6819950422,\"lower\":0.6694204602,\"upper\":1.0215382459,\"t0\":0.8314262616}],\"kurtosis\":[{\"alpha\":0.975,\"li\":23.6584184812,\"ui\":996.0438328538,\"lower\":-0.7362926431,\"upper\":0.0382520384,\"t0\":-0.444126526},{\"alpha\":0.99,\"li\":12.594947531,\"ui\":999.8016946623,\"lower\":-0.768040445,\"upper\":0.2770139197,\"t0\":-0.444126526}]},\"d1\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":10.930520522,\"ui\":986.7461586723,\"lower\":3.1615552276,\"upper\":3.6295674568,\"t0\":3.4166666667},{\"alpha\":0.99,\"li\":4.2170361456,\"ui\":995.0996390251,\"lower\":3.1444042263,\"upper\":3.6689513457,\"t0\":3.4166666667}],\"variance\":[{\"alpha\":0.975,\"li\":9.2285531774,\"ui\":984.8391255475,\"lower\":5.1565469543,\"upper\":6.5956819538,\"t0\":5.9897222222},{\"alpha\":0.99,\"li\":3.0243819633,\"ui\":993.4599883265,\"lower\":4.9627649121,\"upper\":6.7164965305,\"t0\":5.9897222222}],\"skewness\":[{\"alpha\":0.975,\"li\":14.7236278367,\"ui\":990.4860530175,\"lower\":0.711013244,\"upper\":1.0226994842,\"t0\":0.8552433321},{\"alpha\":0.99,\"li\":6.271174808,\"ui\":997.076827631,\"lower\":0.6763481542,\"upper\":1.0418244318,\"t0\":0.8552433321}],\"kurtosis\":[{\"alpha\":0.975,\"li\":26.0254859312,\"ui\":996.8167153036,\"lower\":-0.7309991822,\"upper\":0.0659568525,\"t0\":-0.4401653371},{\"alpha\":0.99,\"li\":14.0613831739,\"ui\":1000,\"lower\":-0.7599992674,\"upper\":0.3677063471,\"t0\":-0.4401653371}]},\"d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":8.0672523233,\"ui\":982.3656117558,\"lower\":4.0320196748,\"upper\":4.5495343239,\"t0\":4.31},{\"alpha\":0.99,\"li\":2.9260059819,\"ui\":992.8767083975,\"lower\":4.0039544981,\"upper\":4.5920429563,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":17.5497255718,\"ui\":992.38581304,\"lower\":7.5149074265,\"upper\":8.7531854357,\"t0\":8.0872333333},{\"alpha\":0.99,\"li\":7.6662021591,\"ui\":997.886847172,\"lower\":7.3743108004,\"upper\":8.8969912669,\"t0\":8.0872333333}],\"skewness\":[{\"alpha\":0.975,\"li\":11.5223306791,\"ui\":987.4452428965,\"lower\":-0.0505912805,\"upper\":0.208754914,\"t0\":0.0830088931},{\"alpha\":0.99,\"li\":4.4727994673,\"ui\":995.4204646129,\"lower\":-0.0803473502,\"upper\":0.2371593198,\"t0\":0.0830088931}],\"kurtosis\":[{\"alpha\":0.975,\"li\":15.4804969215,\"ui\":991.3338633923,\"lower\":-1.3025007358,\"upper\":-1.0874285735,\"t0\":-1.2128782358},{\"alpha\":0.99,\"li\":7.3432563242,\"ui\":997.9144691234,\"lower\":-1.3112210299,\"upper\":-1.0599102553,\"t0\":-1.2128782358}]},\"r\":{\"n\":600,\"pearson\":[{\"alpha\":0.975,\"li\":14.5969784762,\"ui\":990.3169423063,\"lower\":-0.0261073387,\"upper\":0.1599913672,\"t0\":0.0640573854},{\"alpha\":0.99,\"li\":5.9735312305,\"ui\":996.8251163556,\"lower\":-0.0500052904,\"upper\":0.1756291018,\"t0\":0.0640573854}]}}}]")
    val CI2 = Json.stringify(boot.getCIs(sampleRDD(2)))
    CI2 must be("[{\"id\":2,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":350,\"mean\":[{\"alpha\":0.975,\"li\":12.6711775343,\"ui\":988.6355932527,\"lower\":36.0752184719,\"upper\":42.4693000749,\"t0\":39.38},{\"alpha\":0.99,\"li\":4.7666999641,\"ui\":995.7626348483,\"lower\":35.4225513944,\"upper\":42.8949788047,\"t0\":39.38}],\"variance\":[{\"alpha\":0.975,\"li\":18.7093389612,\"ui\":992.6493765731,\"lower\":574.5553270331,\"upper\":776.2690052456,\"t0\":672.0013142857},{\"alpha\":0.99,\"li\":7.4838835856,\"ui\":997.635973259,\"lower\":558.7247967074,\"upper\":788.2441626655,\"t0\":672.0013142857}],\"skewness\":[{\"alpha\":0.975,\"li\":16.8054595908,\"ui\":992.1843196236,\"lower\":0.6021003441,\"upper\":1.0218893114,\"t0\":0.7842915914},{\"alpha\":0.99,\"li\":7.8188390669,\"ui\":998.100095647,\"lower\":0.5746210144,\"upper\":1.050484152,\"t0\":0.7842915914}],\"kurtosis\":[{\"alpha\":0.975,\"li\":23.8800478994,\"ui\":996.595622264,\"lower\":-0.9563187903,\"upper\":0.012832397,\"t0\":-0.6097881532},{\"alpha\":0.99,\"li\":13.5056581894,\"ui\":1000,\"lower\":-0.9654804841,\"upper\":0.2780492285,\"t0\":-0.6097881532}]},\"d1\":{\"n\":350,\"mean\":[{\"alpha\":0.975,\"li\":11.2076680691,\"ui\":987.1451017329,\"lower\":3.1691828183,\"upper\":3.817546284,\"t0\":3.5142857143},{\"alpha\":0.99,\"li\":4.1263889524,\"ui\":995.03244376,\"lower\":3.1232514013,\"upper\":3.8488288635,\"t0\":3.5142857143}],\"variance\":[{\"alpha\":0.975,\"li\":17.9608051136,\"ui\":992.2168722593,\"lower\":5.5992187936,\"upper\":7.4912866208,\"t0\":6.5412244898},{\"alpha\":0.99,\"li\":6.9968261878,\"ui\":997.3681618368,\"lower\":5.3915370418,\"upper\":7.6101657617,\"t0\":6.5412244898}],\"skewness\":[{\"alpha\":0.975,\"li\":16.5039491777,\"ui\":991.9205993254,\"lower\":0.6021339279,\"upper\":1.0257117305,\"t0\":0.7924531207},{\"alpha\":0.99,\"li\":7.5272977175,\"ui\":997.9169464742,\"lower\":0.577282172,\"upper\":1.070669248,\"t0\":0.7924531207}],\"kurtosis\":[{\"alpha\":0.975,\"li\":21.0618653405,\"ui\":995.3729594601,\"lower\":-0.9666682405,\"upper\":-0.0113056698,\"t0\":-0.624752},{\"alpha\":0.99,\"li\":11.6225485089,\"ui\":999.7743125063,\"lower\":-0.9858311078,\"upper\":0.1245933502,\"t0\":-0.624752}]},\"d2\":{\"n\":350,\"mean\":[{\"alpha\":0.975,\"li\":12.5253932367,\"ui\":988.5006189121,\"lower\":3.9116229783,\"upper\":4.5657142857,\"t0\":4.2371428571},{\"alpha\":0.99,\"li\":5.1055930998,\"ui\":996.0958998066,\"lower\":3.8666880253,\"upper\":4.61218065,\"t0\":4.2371428571}],\"variance\":[{\"alpha\":0.975,\"li\":15.8575235071,\"ui\":991.2671563572,\"lower\":6.9747670728,\"upper\":8.6236289507,\"t0\":7.7466204082},{\"alpha\":0.99,\"li\":6.6906779599,\"ui\":997.3254302088,\"lower\":6.8639412339,\"upper\":8.7609075594,\"t0\":7.7466204082}],\"skewness\":[{\"alpha\":0.975,\"li\":11.76465051,\"ui\":987.6870221373,\"lower\":-0.0888593758,\"upper\":0.2566310102,\"t0\":0.0831427871},{\"alpha\":0.99,\"li\":4.7431948267,\"ui\":995.7156811182,\"lower\":-0.1082366973,\"upper\":0.2785017514,\"t0\":0.0831427871}],\"kurtosis\":[{\"alpha\":0.975,\"li\":14.3773197428,\"ui\":990.4217257831,\"lower\":-1.3010018624,\"upper\":-1.0022122763,\"t0\":-1.1725045208},{\"alpha\":0.99,\"li\":6.8189962776,\"ui\":997.6120653446,\"lower\":-1.3132055368,\"upper\":-0.9568284573,\"t0\":-1.1725045208}]},\"r\":{\"n\":350,\"pearson\":[{\"alpha\":0.975,\"li\":6.443731826,\"ui\":978.4067874826,\"lower\":-0.0639199943,\"upper\":0.1800886064,\"t0\":0.0711688614},{\"alpha\":0.99,\"li\":2.3009685683,\"ui\":991.0078508912,\"lower\":-0.0728274212,\"upper\":0.1946720465,\"t0\":0.0711688614}]}}}]")
    val CI3 = Json.stringify(boot.getCIs(sampleRDD(3)))
    CI3 must be("[{\"id\":3,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":250,\"mean\":[{\"alpha\":0.975,\"li\":7.4776142475,\"ui\":981.0268374758,\"lower\":33.6805536966,\"upper\":40.409997063,\"t0\":37.212},{\"alpha\":0.99,\"li\":2.7227136368,\"ui\":992.3084513639,\"lower\":32.8258995793,\"upper\":40.9615228366,\"t0\":37.212}],\"variance\":[{\"alpha\":0.975,\"li\":11.1545591076,\"ui\":987.0009583485,\"lower\":428.4407331245,\"upper\":640.7076102526,\"t0\":534.799056},{\"alpha\":0.99,\"li\":4.3658818047,\"ui\":995.2806924937,\"lower\":409.7174375702,\"upper\":656.2634144433,\"t0\":534.799056}],\"skewness\":[{\"alpha\":0.975,\"li\":23.7396386398,\"ui\":995.2962683323,\"lower\":0.6669949715,\"upper\":1.1680478195,\"t0\":0.8779799909},{\"alpha\":0.99,\"li\":11.2591610618,\"ui\":999.1861171018,\"lower\":0.6271395758,\"upper\":1.192087295,\"t0\":0.8779799909}],\"kurtosis\":[{\"alpha\":0.975,\"li\":35.0739169205,\"ui\":998.9442679579,\"lower\":-0.6802263909,\"upper\":0.8138359565,\"t0\":-0.2295633073},{\"alpha\":0.99,\"li\":20.4539392055,\"ui\":1000,\"lower\":-0.7185968753,\"upper\":0.8260710183,\"t0\":-0.2295633073}]},\"d1\":{\"n\":250,\"mean\":[{\"alpha\":0.975,\"li\":7.0751160863,\"ui\":980.1095855762,\"lower\":2.9323174132,\"upper\":3.5924303709,\"t0\":3.28},{\"alpha\":0.99,\"li\":2.5481089227,\"ui\":991.8306037429,\"lower\":2.8407414318,\"upper\":3.6444795617,\"t0\":3.28}],\"variance\":[{\"alpha\":0.975,\"li\":12.8126165807,\"ui\":988.7812875644,\"lower\":4.1582851077,\"upper\":6.2392638229,\"t0\":5.1856},{\"alpha\":0.99,\"li\":5.1352409733,\"ui\":996.1221798143,\"lower\":4.0205001497,\"upper\":6.3618005533,\"t0\":5.1856}],\"skewness\":[{\"alpha\":0.975,\"li\":23.4598756013,\"ui\":995.3462514991,\"lower\":0.7139361799,\"upper\":1.2255943104,\"t0\":0.9293346587},{\"alpha\":0.99,\"li\":11.3761658162,\"ui\":999.2791390484,\"lower\":0.6855908642,\"upper\":1.2524471734,\"t0\":0.9293346587}],\"kurtosis\":[{\"alpha\":0.975,\"li\":34.5693957909,\"ui\":998.9859548253,\"lower\":-0.6599929616,\"upper\":0.8886881938,\"t0\":-0.1820659989},{\"alpha\":0.99,\"li\":20.4047176296,\"ui\":1000,\"lower\":-0.7091560295,\"upper\":0.8914998566,\"t0\":-0.1820659989}]},\"d2\":{\"n\":250,\"mean\":[{\"alpha\":0.975,\"li\":14.0121901665,\"ui\":989.9298198104,\"lower\":4.008,\"upper\":4.832,\"t0\":4.412},{\"alpha\":0.99,\"li\":6.0402052139,\"ui\":996.9288222682,\"lower\":3.9561718356,\"upper\":4.8990618001,\"t0\":4.412}],\"variance\":[{\"alpha\":0.975,\"li\":18.4316056468,\"ui\":992.8137700434,\"lower\":7.6095588165,\"upper\":9.6342822279,\"t0\":8.546256},{\"alpha\":0.99,\"li\":7.9929686978,\"ui\":998.0101670291,\"lower\":7.3518855884,\"upper\":9.883330136,\"t0\":8.546256}],\"skewness\":[{\"alpha\":0.975,\"li\":12.1797089127,\"ui\":988.1734979624,\"lower\":-0.1411273808,\"upper\":0.2795478383,\"t0\":0.0731222049},{\"alpha\":0.99,\"li\":4.4448321746,\"ui\":995.4304363866,\"lower\":-0.192025278,\"upper\":0.3045825112,\"t0\":0.0731222049}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.5483213962,\"ui\":989.6447188212,\"lower\":-1.4083574883,\"upper\":-1.0924198199,\"t0\":-1.2736169607},{\"alpha\":0.99,\"li\":6.4884600051,\"ui\":997.4107059857,\"lower\":-1.4219382938,\"upper\":-1.0514794095,\"t0\":-1.2736169607}]},\"r\":{\"n\":250,\"pearson\":[{\"alpha\":0.975,\"li\":13.7911979463,\"ui\":989.6909684072,\"lower\":-0.0771367178,\"upper\":0.1914114067,\"t0\":0.0577785968},{\"alpha\":0.99,\"li\":5.7231269056,\"ui\":996.6493300864,\"lower\":-0.0990256084,\"upper\":0.2244480926,\"t0\":0.0577785968}]}}}]")
    val CI4 = Json.stringify(boot.getCIs(sampleRDD(4)))
    CI4 must be("[{\"id\":4,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":12.0573663916,\"ui\":988.0214712264,\"lower\":35.7144462329,\"upper\":41.7439013353,\"t0\":38.705},{\"alpha\":0.99,\"li\":4.7607600483,\"ui\":995.7421135433,\"lower\":35.140836619,\"upper\":42.0095236193,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":9.8839461124,\"ui\":985.6701037717,\"lower\":549.1065945801,\"upper\":741.1768876478,\"t0\":657.567975},{\"alpha\":0.99,\"li\":3.3403211053,\"ui\":993.9804372437,\"lower\":534.8764794975,\"upper\":756.9048611653,\"t0\":657.567975}],\"skewness\":[{\"alpha\":0.975,\"li\":22.2490644541,\"ui\":994.854947297,\"lower\":0.6258015366,\"upper\":1.0223458005,\"t0\":0.795359968},{\"alpha\":0.99,\"li\":10.6179912217,\"ui\":999.0705312356,\"lower\":0.6082439138,\"upper\":1.0698219193,\"t0\":0.795359968}],\"kurtosis\":[{\"alpha\":0.975,\"li\":33.7536490674,\"ui\":998.7232818082,\"lower\":-0.7884082867,\"upper\":0.1642971816,\"t0\":-0.4949639003},{\"alpha\":0.99,\"li\":19.51087098,\"ui\":1000,\"lower\":-0.8224798716,\"upper\":0.2814815773,\"t0\":-0.4949639003}]},\"d1\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":12.7688956073,\"ui\":988.7434538829,\"lower\":3.17,\"upper\":3.7523676302,\"t0\":3.4525},{\"alpha\":0.99,\"li\":5.2043739723,\"ui\":996.1910531125,\"lower\":3.1275,\"upper\":3.7904408161,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":7.9472463979,\"ui\":982.6648649469,\"lower\":5.2883253035,\"upper\":7.0234625887,\"t0\":6.27774375},{\"alpha\":0.99,\"li\":2.6179052164,\"ui\":992.4824021231,\"lower\":5.1040674729,\"upper\":7.1399148154,\"t0\":6.27774375}],\"skewness\":[{\"alpha\":0.975,\"li\":18.1228427736,\"ui\":992.8662815415,\"lower\":0.632860947,\"upper\":1.0323997409,\"t0\":0.8133183961},{\"alpha\":0.99,\"li\":8.2744233648,\"ui\":998.2444041632,\"lower\":0.6103515393,\"upper\":1.0677949247,\"t0\":0.8133183961}],\"kurtosis\":[{\"alpha\":0.975,\"li\":30.9688664557,\"ui\":998.1677294272,\"lower\":-0.7995680412,\"upper\":0.0890825434,\"t0\":-0.5086785567},{\"alpha\":0.99,\"li\":17.5248048018,\"ui\":1000,\"lower\":-0.8571062812,\"upper\":0.2304303054,\"t0\":-0.5086785567}]},\"d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":20.9445309425,\"ui\":994.1185254832,\"lower\":3.8775,\"upper\":4.5639082487,\"t0\":4.18},{\"alpha\":0.99,\"li\":9.5263286662,\"ui\":998.6517098797,\"lower\":3.8367223459,\"upper\":4.6476067995,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":24.9379106844,\"ui\":995.576746206,\"lower\":7.6168723361,\"upper\":9.2495086162,\"t0\":8.3226},{\"alpha\":0.99,\"li\":11.7161344065,\"ui\":999.2422645287,\"lower\":7.5280777776,\"upper\":9.5139469359,\"t0\":8.3226}],\"skewness\":[{\"alpha\":0.975,\"li\":5.8719941172,\"ui\":977.5504085764,\"lower\":-0.13681027,\"upper\":0.2132354026,\"t0\":0.0643472263},{\"alpha\":0.99,\"li\":1.9150680823,\"ui\":990.030871042,\"lower\":-0.1689474133,\"upper\":0.2410747251,\"t0\":0.0643472263}],\"kurtosis\":[{\"alpha\":0.975,\"li\":10.9770583442,\"ui\":986.4656753453,\"lower\":-1.3683957556,\"upper\":-1.1268956706,\"t0\":-1.2604129665},{\"alpha\":0.99,\"li\":5.019249192,\"ui\":996.0119523901,\"lower\":-1.3837489276,\"upper\":-1.0945762247,\"t0\":-1.2604129665}]},\"r\":{\"n\":400,\"pearson\":[{\"alpha\":0.975,\"li\":11.0744313837,\"ui\":987.0265113285,\"lower\":0.0321136014,\"upper\":0.2444771581,\"t0\":0.148522063},{\"alpha\":0.99,\"li\":3.9703248789,\"ui\":994.8553462818,\"lower\":0.0207627918,\"upper\":0.2633715313,\"t0\":0.148522063}]}}}]")
    val CI5 = Json.stringify(boot.getCIs(sampleRDD(5)))
    CI5 must be("[{\"id\":5,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":180,\"mean\":[{\"alpha\":0.975,\"li\":19.2035953628,\"ui\":993.5237380421,\"lower\":36.3356351303,\"upper\":45.1514073693,\"t0\":40.0166666667},{\"alpha\":0.99,\"li\":8.9978616336,\"ui\":998.5734830146,\"lower\":35.6998983955,\"upper\":45.5920636844,\"t0\":40.0166666667}],\"variance\":[{\"alpha\":0.975,\"li\":14.9970925977,\"ui\":990.5727689301,\"lower\":523.8908517326,\"upper\":813.9365349135,\"t0\":666.9830555556},{\"alpha\":0.99,\"li\":6.0188172286,\"ui\":996.8377403997,\"lower\":501.4802770211,\"upper\":829.3471236743,\"t0\":666.9830555556}],\"skewness\":[{\"alpha\":0.975,\"li\":21.3558769868,\"ui\":994.2127972592,\"lower\":0.5364410105,\"upper\":1.0903599881,\"t0\":0.7907282465},{\"alpha\":0.99,\"li\":9.5980211179,\"ui\":998.6388661154,\"lower\":0.5037545739,\"upper\":1.2019789035,\"t0\":0.7907282465}],\"kurtosis\":[{\"alpha\":0.975,\"li\":29.5097595019,\"ui\":998.2275316615,\"lower\":-0.9000873868,\"upper\":0.661517761,\"t0\":-0.4471283195},{\"alpha\":0.99,\"li\":17.3020895431,\"ui\":1000,\"lower\":-0.951589529,\"upper\":0.9193974307,\"t0\":-0.4471283195}]},\"d1\":{\"n\":180,\"mean\":[{\"alpha\":0.975,\"li\":16.6665485144,\"ui\":992.0683481996,\"lower\":3.2092904367,\"upper\":4.0392508978,\"t0\":3.5722222222},{\"alpha\":0.99,\"li\":7.6957412063,\"ui\":998.0253784232,\"lower\":3.1388888889,\"upper\":4.0948003854,\"t0\":3.5722222222}],\"variance\":[{\"alpha\":0.975,\"li\":15.2263886484,\"ui\":990.6989014355,\"lower\":5.0287591358,\"upper\":7.7361233857,\"t0\":6.378117284},{\"alpha\":0.99,\"li\":6.0116511036,\"ui\":996.8171595722,\"lower\":4.753495797,\"upper\":7.961032546,\"t0\":6.378117284}],\"skewness\":[{\"alpha\":0.975,\"li\":16.3305646227,\"ui\":991.6202541493,\"lower\":0.5499962682,\"upper\":1.0844576909,\"t0\":0.8051385927},{\"alpha\":0.99,\"li\":7.0176418621,\"ui\":997.5378496239,\"lower\":0.4993288962,\"upper\":1.1810758655,\"t0\":0.8051385927}],\"kurtosis\":[{\"alpha\":0.975,\"li\":29.0890542781,\"ui\":998.056553139,\"lower\":-0.9327126445,\"upper\":0.5783518718,\"t0\":-0.4734035738},{\"alpha\":0.99,\"li\":16.8676372919,\"ui\":1000,\"lower\":-0.9968377146,\"upper\":0.888433527,\"t0\":-0.4734035738}]},\"d2\":{\"n\":180,\"mean\":[{\"alpha\":0.975,\"li\":13.5943434426,\"ui\":989.592776839,\"lower\":3.8811223348,\"upper\":4.7921311696,\"t0\":4.2944444444},{\"alpha\":0.99,\"li\":6.0298893854,\"ui\":996.9548815146,\"lower\":3.8335108931,\"upper\":4.9047271845,\"t0\":4.2944444444}],\"variance\":[{\"alpha\":0.975,\"li\":29.331876645,\"ui\":996.7810775203,\"lower\":6.3470397233,\"upper\":8.7595807825,\"t0\":7.3188580247},{\"alpha\":0.99,\"li\":14.2892450211,\"ui\":999.7206772439,\"lower\":6.212545939,\"upper\":9.0945073842,\"t0\":7.3188580247}],\"skewness\":[{\"alpha\":0.975,\"li\":14.2274576874,\"ui\":989.923960384,\"lower\":-0.198647468,\"upper\":0.2820300785,\"t0\":0.0507033364},{\"alpha\":0.99,\"li\":5.3726523227,\"ui\":996.31462107,\"lower\":-0.2469997224,\"upper\":0.2930997965,\"t0\":0.0507033364}],\"kurtosis\":[{\"alpha\":0.975,\"li\":9.4664566473,\"ui\":984.1135072834,\"lower\":-1.3334212496,\"upper\":-0.9068447056,\"t0\":-1.1354640171},{\"alpha\":0.99,\"li\":4.1080234389,\"ui\":994.7678527316,\"lower\":-1.3504325379,\"upper\":-0.8747174053,\"t0\":-1.1354640171}]},\"r\":{\"n\":180,\"pearson\":[{\"alpha\":0.975,\"li\":16.6306697022,\"ui\":991.6962126711,\"lower\":0.004865621,\"upper\":0.323807517,\"t0\":0.1599199363},{\"alpha\":0.99,\"li\":6.8926097889,\"ui\":997.4098689575,\"lower\":-0.0139515149,\"upper\":0.3458008193,\"t0\":0.1599199363}]}}}]")
    val CI6 = Json.stringify(boot.getCIs(sampleRDD(6)))
    CI6 must be("[{\"id\":6,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":220,\"mean\":[{\"alpha\":0.975,\"li\":18.2454601859,\"ui\":992.9609539022,\"lower\":33.9363636364,\"upper\":42.1645164925,\"t0\":37.6318181818},{\"alpha\":0.99,\"li\":8.3897256484,\"ui\":998.3070862407,\"lower\":33.4218854267,\"upper\":42.7905882288,\"t0\":37.6318181818}],\"variance\":[{\"alpha\":0.975,\"li\":21.258275063,\"ui\":993.9556937065,\"lower\":535.528397546,\"upper\":768.9522980491,\"t0\":647.3053512397},{\"alpha\":0.99,\"li\":9.1211661783,\"ui\":998.3802083786,\"lower\":518.4963825573,\"upper\":790.2897505187,\"t0\":647.3053512397}],\"skewness\":[{\"alpha\":0.975,\"li\":19.6516162659,\"ui\":993.7420660715,\"lower\":0.5486936153,\"upper\":1.1258136185,\"t0\":0.8000684753},{\"alpha\":0.99,\"li\":9.2291024674,\"ui\":998.6540074867,\"lower\":0.5226473559,\"upper\":1.1806023788,\"t0\":0.8000684753}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.3597277915,\"ui\":999.4673122344,\"lower\":-0.9440393613,\"upper\":0.4499836334,\"t0\":-0.5461403995},{\"alpha\":0.99,\"li\":23.01329899,\"ui\":1000,\"lower\":-0.9701140356,\"upper\":0.6159854095,\"t0\":-0.5461403995}]},\"d1\":{\"n\":220,\"mean\":[{\"alpha\":0.975,\"li\":17.0406577132,\"ui\":992.2461230652,\"lower\":2.9867420497,\"upper\":3.7930610658,\"t0\":3.3545454545},{\"alpha\":0.99,\"li\":7.7561706111,\"ui\":998.0190927146,\"lower\":2.9545454545,\"upper\":3.8334233472,\"t0\":3.3545454545}],\"variance\":[{\"alpha\":0.975,\"li\":16.7793406683,\"ui\":991.7681260896,\"lower\":5.083867995,\"upper\":7.3156784332,\"t0\":6.1742975207},{\"alpha\":0.99,\"li\":6.9204302707,\"ui\":997.4168739409,\"lower\":4.8811562154,\"upper\":7.479499938,\"t0\":6.1742975207}],\"skewness\":[{\"alpha\":0.975,\"li\":21.3081618545,\"ui\":994.5154939294,\"lower\":0.5700152864,\"upper\":1.1613786147,\"t0\":0.8205086823},{\"alpha\":0.99,\"li\":10.1717615786,\"ui\":998.9654654522,\"lower\":0.5356962579,\"upper\":1.2035508013,\"t0\":0.8205086823}],\"kurtosis\":[{\"alpha\":0.975,\"li\":37.7792552253,\"ui\":999.441467353,\"lower\":-0.9460356937,\"upper\":0.4380642255,\"t0\":-0.5482374624},{\"alpha\":0.99,\"li\":22.7277950881,\"ui\":1000,\"lower\":-0.9809693341,\"upper\":0.5725950528,\"t0\":-0.5482374624}]},\"d2\":{\"n\":220,\"mean\":[{\"alpha\":0.975,\"li\":10.8459955932,\"ui\":986.6460634664,\"lower\":3.5727272727,\"upper\":4.5665419585,\"t0\":4.0863636364},{\"alpha\":0.99,\"li\":4.1689173064,\"ui\":995.0385191285,\"lower\":3.4769871061,\"upper\":4.6045454545,\"t0\":4.0863636364}],\"variance\":[{\"alpha\":0.975,\"li\":21.9271424102,\"ui\":994.1336599394,\"lower\":8.0327198816,\"upper\":10.2732253142,\"t0\":9.1243595041},{\"alpha\":0.99,\"li\":9.2965298759,\"ui\":998.4025971843,\"lower\":7.951063666,\"upper\":10.3888217002,\"t0\":9.1243595041}],\"skewness\":[{\"alpha\":0.975,\"li\":21.6464338791,\"ui\":994.6149741573,\"lower\":-0.1143974562,\"upper\":0.3639185552,\"t0\":0.0905031999},{\"alpha\":0.99,\"li\":10.2843489595,\"ui\":998.9786110455,\"lower\":-0.1502768526,\"upper\":0.4208125735,\"t0\":0.0905031999}],\"kurtosis\":[{\"alpha\":0.975,\"li\":11.7212467636,\"ui\":987.3900670921,\"lower\":-1.4712579806,\"upper\":-1.1712570974,\"t0\":-1.3547827181},{\"alpha\":0.99,\"li\":5.8901831644,\"ui\":997.0033041369,\"lower\":-1.4969460722,\"upper\":-1.1488797399,\"t0\":-1.3547827181}]},\"r\":{\"n\":220,\"pearson\":[{\"alpha\":0.975,\"li\":19.4321717165,\"ui\":993.2354921483,\"lower\":-0.0052991003,\"upper\":0.2989899987,\"t0\":0.1382353384},{\"alpha\":0.99,\"li\":8.3434801872,\"ui\":998.1229941733,\"lower\":-0.0214562186,\"upper\":0.3150904759,\"t0\":0.1382353384}]}}}]")
  }

  /*test("sample CIs by Level are correct") {
    //val CI1 = boot.getCIsByLevel(sampleRDD, 1)
    //Json.stringify(CI1) must be ("[{\"id\":4,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":15.6484978447,\"ui\":991.259801465,\"lower\":36.1330954577,\"upper\":41.8062554336,\"t0\":38.705},{\"alpha\":0.99,\"li\":6.9413770428,\"ui\":997.5537988299,\"lower\":35.9066747157,\"upper\":42.0099908581,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":14.4202841466,\"ui\":990.1442415833,\"lower\":567.7315608856,\"upper\":752.8274641622,\"t0\":657.567975},{\"alpha\":0.99,\"li\":5.7577901905,\"ui\":996.6459593852,\"lower\":548.2048914919,\"upper\":763.1995041253,\"t0\":657.567975}],\"skewness\":[{\"alpha\":0.975,\"li\":16.5738822517,\"ui\":991.7914287015,\"lower\":0.613728507,\"upper\":1.0085163781,\"t0\":0.795359968},{\"alpha\":0.99,\"li\":7.171749893,\"ui\":997.6311316075,\"lower\":0.5913386751,\"upper\":1.0401580743,\"t0\":0.795359968}],\"kurtosis\":[{\"alpha\":0.975,\"li\":33.3383951546,\"ui\":998.3608677517,\"lower\":-0.7981309119,\"upper\":0.0955451142,\"t0\":-0.4949639003},{\"alpha\":0.99,\"li\":18.5292534366,\"ui\":1000,\"lower\":-0.8289020932,\"upper\":0.2814815773,\"t0\":-0.4949639003}]},\"d1\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":14.7817105074,\"ui\":990.6229641092,\"lower\":3.1975,\"upper\":3.7511314022,\"t0\":3.4525},{\"alpha\":0.99,\"li\":6.5811066767,\"ui\":997.3447503413,\"lower\":3.1789938931,\"upper\":3.7825,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":13.322029992,\"ui\":989.2502193225,\"lower\":5.4425760729,\"upper\":7.1768599185,\"t0\":6.27774375},{\"alpha\":0.99,\"li\":5.3395958343,\"ui\":996.3089650131,\"lower\":5.2657429694,\"upper\":7.2562509677,\"t0\":6.27774375}],\"skewness\":[{\"alpha\":0.975,\"li\":16.2208767922,\"ui\":991.5674843119,\"lower\":0.6253289154,\"upper\":1.0261951359,\"t0\":0.8133183961},{\"alpha\":0.99,\"li\":7.0094658908,\"ui\":997.5434503459,\"lower\":0.6027650801,\"upper\":1.0452939021,\"t0\":0.8133183961}],\"kurtosis\":[{\"alpha\":0.975,\"li\":31.6914106538,\"ui\":998.046339394,\"lower\":-0.8216670468,\"upper\":0.053445836,\"t0\":-0.5086785567},{\"alpha\":0.99,\"li\":17.4213645121,\"ui\":1000,\"lower\":-0.8592293975,\"upper\":0.1973911275,\"t0\":-0.5086785567}]},\"d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":17.934247697,\"ui\":992.7127015769,\"lower\":3.875,\"upper\":4.5125,\"t0\":4.18},{\"alpha\":0.99,\"li\":8.0826930469,\"ui\":998.1357424211,\"lower\":3.8279336913,\"upper\":4.6161618309,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":23.505077714,\"ui\":995.2937346128,\"lower\":7.6285131782,\"upper\":9.319984747,\"t0\":8.3226},{\"alpha\":0.99,\"li\":11.275180698,\"ui\":999.2249394873,\"lower\":7.5159969984,\"upper\":9.5622713521,\"t0\":8.3226}],\"skewness\":[{\"alpha\":0.975,\"li\":4.800798052,\"ui\":974.7723596754,\"lower\":-0.1468009791,\"upper\":0.196139743,\"t0\":0.0643472263},{\"alpha\":0.99,\"li\":1.4162474014,\"ui\":988.0834915007,\"lower\":-0.179339258,\"upper\":0.2266598035,\"t0\":0.0643472263}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.0485920892,\"ui\":989.0603810366,\"lower\":-1.3693450483,\"upper\":-1.1277274725,\"t0\":-1.2604129665},{\"alpha\":0.99,\"li\":5.803864494,\"ui\":996.7773413305,\"lower\":-1.3780234679,\"upper\":-1.1018634817,\"t0\":-1.2604129665}]},\"r\":{\"n\":400,\"pearson\":[{\"alpha\":0.975,\"li\":13.0018207204,\"ui\":988.9524080679,\"lower\":0.0314673433,\"upper\":0.2626240338,\"t0\":0.148522063},{\"alpha\":0.99,\"li\":5.1260759456,\"ui\":996.1110974668,\"lower\":0.020785244,\"upper\":0.2783651445,\"t0\":0.148522063}]}}},{\"id\":1,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":7.7016814839,\"ui\":981.6576174125,\"lower\":36.2440163164,\"upper\":40.4785627098,\"t0\":38.4766666667},{\"alpha\":0.99,\"li\":2.7599955886,\"ui\":992.4911549117,\"lower\":35.7393367193,\"upper\":40.7543476212,\"t0\":38.4766666667}],\"variance\":[{\"alpha\":0.975,\"li\":10.7740283311,\"ui\":986.5691440279,\"lower\":545.2834044111,\"upper\":683.9934220048,\"t0\":615.9761222222},{\"alpha\":0.99,\"li\":4.1081888101,\"ui\":994.9644368177,\"lower\":540.2233777227,\"upper\":697.8207063332,\"t0\":615.9761222222}],\"skewness\":[{\"alpha\":0.975,\"li\":27.8357469962,\"ui\":996.7151770056,\"lower\":0.7054089498,\"upper\":1.0323931086,\"t0\":0.8314262616},{\"alpha\":0.99,\"li\":14.0265030987,\"ui\":999.8004352391,\"lower\":0.6845663948,\"upper\":1.0575518873,\"t0\":0.8314262616}],\"kurtosis\":[{\"alpha\":0.975,\"li\":40.2224947005,\"ui\":999.420227664,\"lower\":-0.6940711972,\"upper\":0.1833244677,\"t0\":-0.444126526},{\"alpha\":0.99,\"li\":23.5224328263,\"ui\":1000,\"lower\":-0.7182784007,\"upper\":0.3474653905,\"t0\":-0.444126526}]},\"d1\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":7.6562777227,\"ui\":981.6434909583,\"lower\":3.1916666667,\"upper\":3.6198590181,\"t0\":3.4166666667},{\"alpha\":0.99,\"li\":2.708482268,\"ui\":992.4081604028,\"lower\":3.1316666667,\"upper\":3.6486455055,\"t0\":3.4166666667}],\"variance\":[{\"alpha\":0.975,\"li\":9.7924517001,\"ui\":985.2391524103,\"lower\":5.26403057,\"upper\":6.6396683814,\"t0\":5.9897222222},{\"alpha\":0.99,\"li\":3.6899017669,\"ui\":994.3397144018,\"lower\":5.1961649344,\"upper\":6.7609447251,\"t0\":5.9897222222}],\"skewness\":[{\"alpha\":0.975,\"li\":30.4324437985,\"ui\":997.2748906068,\"lower\":0.7293452697,\"upper\":1.0636955747,\"t0\":0.8552433321},{\"alpha\":0.99,\"li\":15.4916740655,\"ui\":999.981279623,\"lower\":0.7106837335,\"upper\":1.0940042685,\"t0\":0.8552433321}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.0168127316,\"ui\":999.1237031686,\"lower\":-0.7011201645,\"upper\":0.1265778113,\"t0\":-0.4401653371},{\"alpha\":0.99,\"li\":21.8683065515,\"ui\":1000,\"lower\":-0.7322615922,\"upper\":0.3677063471,\"t0\":-0.4401653371}]},\"d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":15.0625274905,\"ui\":990.6044948163,\"lower\":4.0568806019,\"upper\":4.5676575108,\"t0\":4.31},{\"alpha\":0.99,\"li\":6.000788958,\"ui\":996.818271976,\"lower\":4.0050098635,\"upper\":4.6016898182,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":9.4919165523,\"ui\":984.7382792726,\"lower\":7.4348168717,\"upper\":8.6988180045,\"t0\":8.0872333333},{\"alpha\":0.99,\"li\":3.6102987462,\"ui\":994.17945474,\"lower\":7.3981527452,\"upper\":8.8050889692,\"t0\":8.0872333333}],\"skewness\":[{\"alpha\":0.975,\"li\":10.5988320803,\"ui\":986.3389072817,\"lower\":-0.0533412544,\"upper\":0.2151468524,\"t0\":0.0830088931},{\"alpha\":0.99,\"li\":4.0486088058,\"ui\":994.8773868527,\"lower\":-0.0736883412,\"upper\":0.232018197,\"t0\":0.0830088931}],\"kurtosis\":[{\"alpha\":0.975,\"li\":22.9158548613,\"ui\":995.4907973244,\"lower\":-1.3035902718,\"upper\":-1.0710559495,\"t0\":-1.2128782358},{\"alpha\":0.99,\"li\":11.6740705446,\"ui\":999.4982585546,\"lower\":-1.3124248973,\"upper\":-1.0595667129,\"t0\":-1.2128782358}]},\"r\":{\"n\":600,\"pearson\":[{\"alpha\":0.975,\"li\":7.7907619461,\"ui\":981.6504796042,\"lower\":-0.0304393234,\"upper\":0.1456850067,\"t0\":0.0640573854},{\"alpha\":0.99,\"li\":2.8772461135,\"ui\":992.6720670934,\"lower\":-0.0416294193,\"upper\":0.1569730773,\"t0\":0.0640573854}]}}}]")
  }*/

  test("results by Group ID are correct") {
    val r0 = Json.stringify(boot.getResults(resultsRDD(0)))
    r0 must be("[{\"id\":0,\"level\":0,\"results\":{\"n\":1000,\"statsDiag\":1,\"regsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":true,\"contains\":true},\"alpha1\":{\"overlaps\":true,\"contains\":true},\"beta0\":{\"overlaps\":true,\"contains\":true},\"beta1\":{\"overlaps\":true,\"contains\":true}}}}]")
    val r1 = Json.stringify(boot.getResults(resultsRDD(1)))
    r1 must be("[{\"id\":1,\"level\":1,\"results\":{\"n\":600,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}}]")
    val r2 = Json.stringify(boot.getResults(resultsRDD(2)))
    r2 must be("[{\"id\":2,\"level\":2,\"results\":{\"n\":350,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}}]")
    val r3 = Json.stringify(boot.getResults(resultsRDD(3)))
    r3 must be("[{\"id\":3,\"level\":2,\"results\":{\"n\":250,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}}]")
    val r4 = Json.stringify(boot.getResults(resultsRDD(4)))
    r4 must be("[{\"id\":4,\"level\":1,\"results\":{\"n\":400,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}}]")
    val r5 = Json.stringify(boot.getResults(resultsRDD(5)))
    r5 must be("[{\"id\":5,\"level\":2,\"results\":{\"n\":180,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}}]")
    val r6 = Json.stringify(boot.getResults(resultsRDD(6)))
    r6 must be("[{\"id\":6,\"level\":2,\"results\":{\"n\":220,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}}]")
  }

  /*test("results by Level are correct") {
    //val r1 = boot.getResultsByLevel(resultsRDD, 1)
    //Json.stringify(r1) must be("[{\"id\":4,\"level\":1,\"results\":{\"n\":400,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}},{\"id\":1,\"level\":1,\"results\":{\"n\":600,\"statsDiag\":1,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"reg\":{\"pearson\":{\"overlaps\":true,\"contains\":true}}}}]")
  }*/

  test("frequencies by GroupID are correct") {
    val f0 = Json.stringify(boot.getFrequenciesByGroupId(data, 0))
    f0 must be("[{\"count\":1000,\"d1d2\":[0.038,0.038,0.03,0.041,0.023,0.035,0.026,0.025,0.023,0.017,0.025,0.021,0.02,0.018,0.014,0.024,0.022,0.017,0.015,0.01,0.014,0.015,0.017,0.006,0.013,0.011,0.013,0.016,0.011,0.016,0.008,0.006,0.007,0.009,0.012,0.006,0.01,0.006,0.012,0.006,0.012,0.014,0.009,0.01,0.007,0.009,0.003,0.011,0.006,0.011,0.005,0.009,0.003,0.007,0.004,0.006,0.006,0.01,0.004,0.007,0.003,0.002,0.006,0.005,0.004,0.008,0.006,0.003,0.005,0.004,0.005,0.008,0.003,0.006,0.006,0.003,0.004,0.002,0.011,0.006,0.004,0.005,0.003,0.004,0.004,0.006,0.008,0.007,0.008,0.002],\"d1\":[0.296,0.186,0.132,0.082,0.092,0.061,0.046,0.054,0.051],\"d2\":[0.114,0.118,0.098,0.106,0.087,0.108,0.098,0.097,0.095,0.079]}]")
    val f1 = Json.stringify(boot.getFrequenciesByGroupId(data, 1))
    f1 must be("[{\"count\":600,\"d1d2\":[0.0366666667,0.0266666667,0.03,0.04,0.02,0.0383333333,0.0233333333,0.0183333333,0.0316666667,0.0183333333,0.0216666667,0.0283333333,0.0283333333,0.0216666667,0.015,0.025,0.0233333333,0.0166666667,0.0183333333,0.01,0.01,0.015,0.0116666667,0.005,0.015,0.015,0.005,0.0166666667,0.0116666667,0.0183333333,0.0083333333,0.0083333333,0.01,0.0083333333,0.015,0.005,0.0116666667,0.0066666667,0.0133333333,0.0033333333,0.0083333333,0.01,0.0066666667,0.0116666667,0.01,0.0066666667,0.005,0.0116666667,0.005,0.0083333333,0.005,0.0116666667,0.005,0.005,0.0016666667,0.01,0.005,0.0016666667,0.005,0.0116666667,0.0016666667,0.0016666667,0.005,0.0066666667,0.0033333333,0.0083333333,0.0066666667,0.005,0.0033333333,0.005,0.0083333333,0.0066666667,0.005,0.0066666667,0.005,0.0033333333,0.0033333333,0.0033333333,0.01,0.005,0.0033333333,0.005,0.005,0.0033333333,0.0016666667,0.0083333333,0.005,0.0066666667,0.0066666667,0.0016666667],\"d1\":[0.2833333333,0.2083333333,0.1233333333,0.09,0.0833333333,0.0616666667,0.0466666667,0.0566666667,0.0466666667],\"d2\":[0.1033333333,0.1133333333,0.1066666667,0.1083333333,0.0866666667,0.12,0.0883333333,0.0866666667,0.105,0.0816666667]}]")
    val f2 = Json.stringify(boot.getFrequenciesByGroupId(data, 2))
    f2 must be("[{\"count\":350,\"d1d2\":[0.0314285714,0.0342857143,0.0285714286,0.0371428571,0.0285714286,0.04,0.0342857143,0.0142857143,0.0342857143,0.0142857143,0.02,0.02,0.0257142857,0.0171428571,0.0171428571,0.0257142857,0.0171428571,0.0228571429,0.0171428571,0.0028571429,0.0142857143,0.02,0.0142857143,0,0.0171428571,0.02,0.0057142857,0.0142857143,0.0085714286,0.0085714286,0.0057142857,0.0085714286,0.0085714286,0.0028571429,0.02,0.0028571429,0.0114285714,0.0028571429,0.0114285714,0.0028571429,0.0057142857,0.0085714286,0.0085714286,0.0085714286,0.0085714286,0.0114285714,0.0057142857,0.0114285714,0.0028571429,0.0085714286,0.0057142857,0.0171428571,0.0085714286,0.0028571429,0.0028571429,0.0057142857,0.0057142857,0.0028571429,0.0057142857,0.0114285714,0.0028571429,0,0.0085714286,0.0057142857,0.0057142857,0.0085714286,0.0057142857,0.0057142857,0.0057142857,0.0057142857,0.0114285714,0.0028571429,0.0028571429,0.0085714286,0.0028571429,0,0.0028571429,0.0028571429,0.0085714286,0.0085714286,0.0057142857,0.0057142857,0.0057142857,0.0057142857,0.0028571429,0.0114285714,0.0085714286,0.0028571429,0.0114285714,0.0028571429],\"d1\":[0.2971428571,0.1857142857,0.1228571429,0.0771428571,0.08,0.0685714286,0.0542857143,0.0514285714,0.0628571429],\"d2\":[0.1028571429,0.1171428571,0.1114285714,0.0885714286,0.1057142857,0.1257142857,0.0971428571,0.08,0.1057142857,0.0657142857]}]")
    val f3 = Json.stringify(boot.getFrequenciesByGroupId(data, 3))
    f3 must be("[{\"count\":250,\"d1d2\":[0.044,0.016,0.032,0.044,0.008,0.036,0.008,0.024,0.028,0.024,0.024,0.04,0.032,0.028,0.012,0.024,0.032,0.008,0.02,0.02,0.004,0.008,0.008,0.012,0.012,0.008,0.004,0.02,0.016,0.032,0.012,0.008,0.012,0.016,0.008,0.008,0.012,0.012,0.016,0.004,0.012,0.012,0.004,0.016,0.012,0,0.004,0.012,0.008,0.008,0.004,0.004,0,0.008,0,0.016,0.004,0,0.004,0.012,0,0.004,0,0.008,0,0.008,0.008,0.004,0,0.004,0.004,0.012,0.008,0.004,0.008,0.008,0.004,0.004,0.012,0,0,0.004,0.004,0,0,0.004,0,0.012,0,0],\"d1\":[0.264,0.24,0.124,0.108,0.088,0.052,0.036,0.064,0.024],\"d2\":[0.104,0.108,0.1,0.136,0.06,0.112,0.076,0.096,0.104,0.104]}]")
    val f4 = Json.stringify(boot.getFrequenciesByGroupId(data, 4))
    f4 must be("[{\"count\":400,\"d1d2\":[0.04,0.055,0.03,0.0425,0.0275,0.03,0.03,0.035,0.01,0.015,0.03,0.01,0.0075,0.0125,0.0125,0.0225,0.02,0.0175,0.01,0.01,0.02,0.015,0.025,0.0075,0.01,0.005,0.025,0.015,0.01,0.0125,0.0075,0.0025,0.0025,0.01,0.0075,0.0075,0.0075,0.005,0.01,0.01,0.0175,0.02,0.0125,0.0075,0.0025,0.0125,0,0.01,0.0075,0.015,0.005,0.005,0,0.01,0.0075,0,0.0075,0.0225,0.0025,0,0.005,0.0025,0.0075,0.0025,0.005,0.0075,0.005,0,0.0075,0.0025,0,0.01,0,0.005,0.0075,0.0025,0.005,0,0.0125,0.0075,0.005,0.005,0,0.005,0.0075,0.0025,0.0125,0.0075,0.01,0.0025],\"d1\":[0.315,0.1525,0.145,0.07,0.105,0.06,0.045,0.05,0.0575],\"d2\":[0.13,0.125,0.085,0.1025,0.0875,0.09,0.1125,0.1125,0.08,0.075]}]")
    val f5 = Json.stringify(boot.getFrequenciesByGroupId(data, 5))
    f5 must be("[{\"count\":180,\"d1d2\":[0.0166666667,0.0555555556,0.0222222222,0.0555555556,0.0333333333,0.0333333333,0.0277777778,0.0277777778,0,0.0111111111,0.0166666667,0.0166666667,0,0.0166666667,0.0111111111,0.0277777778,0.0222222222,0.0166666667,0.0166666667,0.0055555556,0.0222222222,0.0277777778,0.0277777778,0,0.0166666667,0,0.0222222222,0.0222222222,0.0111111111,0.0166666667,0.0055555556,0,0.0055555556,0,0.0166666667,0.0111111111,0.0111111111,0,0.0111111111,0.0111111111,0.0166666667,0.0166666667,0.0111111111,0.0166666667,0,0.0166666667,0,0.0166666667,0.0111111111,0.0111111111,0,0,0,0.0166666667,0.0111111111,0,0.0111111111,0.0111111111,0,0,0.0055555556,0,0.0111111111,0.0055555556,0.0111111111,0.0055555556,0,0,0.0111111111,0,0,0.0055555556,0,0,0.0111111111,0,0.0055555556,0,0.0111111111,0,0,0.0111111111,0,0.0055555556,0.0111111111,0.0055555556,0.0111111111,0.0111111111,0.0166666667,0.0055555556],\"d1\":[0.2833333333,0.15,0.1666666667,0.0722222222,0.1166666667,0.05,0.05,0.0333333333,0.0777777778],\"d2\":[0.0833333333,0.1333333333,0.0777777778,0.1166666667,0.1222222222,0.1,0.1111111111,0.1055555556,0.0888888889,0.0611111111]}]")
    val f6 = Json.stringify(boot.getFrequenciesByGroupId(data, 6))
    f6 must be("[{\"count\":220,\"d1d2\":[0.0590909091,0.0545454545,0.0363636364,0.0318181818,0.0227272727,0.0272727273,0.0318181818,0.0409090909,0.0181818182,0.0181818182,0.0409090909,0.0045454545,0.0136363636,0.0090909091,0.0136363636,0.0181818182,0.0181818182,0.0181818182,0.0045454545,0.0136363636,0.0181818182,0.0045454545,0.0227272727,0.0136363636,0.0045454545,0.0090909091,0.0272727273,0.0090909091,0.0090909091,0.0090909091,0.0090909091,0.0045454545,0,0.0181818182,0,0.0045454545,0.0045454545,0.0090909091,0.0090909091,0.0090909091,0.0181818182,0.0227272727,0.0136363636,0,0.0045454545,0.0090909091,0,0.0045454545,0.0045454545,0.0181818182,0.0090909091,0.0090909091,0,0.0045454545,0.0045454545,0,0.0045454545,0.0318181818,0.0045454545,0,0.0045454545,0.0045454545,0.0045454545,0,0,0.0090909091,0.0090909091,0,0.0045454545,0.0045454545,0,0.0136363636,0,0.0090909091,0.0045454545,0.0045454545,0.0045454545,0,0.0136363636,0.0136363636,0.0090909091,0,0,0.0045454545,0.0045454545,0,0.0136363636,0.0045454545,0.0045454545,0],\"d1\":[0.3409090909,0.1545454545,0.1272727273,0.0681818182,0.0954545455,0.0681818182,0.0409090909,0.0636363636,0.0409090909],\"d2\":[0.1681818182,0.1181818182,0.0909090909,0.0909090909,0.0590909091,0.0818181818,0.1136363636,0.1181818182,0.0727272727,0.0863636364]}]")
  }

  test("frequencies by Level are correct") {
    val f1 = boot.getFrequenciesByLevel(data, 1)
    Json.stringify(f1) must be("[{\"count\":400,\"d1d2\":[0.04,0.055,0.03,0.0425,0.0275,0.03,0.03,0.035,0.01,0.015,0.03,0.01,0.0075,0.0125,0.0125,0.0225,0.02,0.0175,0.01,0.01,0.02,0.015,0.025,0.0075,0.01,0.005,0.025,0.015,0.01,0.0125,0.0075,0.0025,0.0025,0.01,0.0075,0.0075,0.0075,0.005,0.01,0.01,0.0175,0.02,0.0125,0.0075,0.0025,0.0125,0,0.01,0.0075,0.015,0.005,0.005,0,0.01,0.0075,0,0.0075,0.0225,0.0025,0,0.005,0.0025,0.0075,0.0025,0.005,0.0075,0.005,0,0.0075,0.0025,0,0.01,0,0.005,0.0075,0.0025,0.005,0,0.0125,0.0075,0.005,0.005,0,0.005,0.0075,0.0025,0.0125,0.0075,0.01,0.0025],\"d1\":[0.315,0.1525,0.145,0.07,0.105,0.06,0.045,0.05,0.0575],\"d2\":[0.13,0.125,0.085,0.1025,0.0875,0.09,0.1125,0.1125,0.08,0.075]},{\"count\":600,\"d1d2\":[0.0366666667,0.0266666667,0.03,0.04,0.02,0.0383333333,0.0233333333,0.0183333333,0.0316666667,0.0183333333,0.0216666667,0.0283333333,0.0283333333,0.0216666667,0.015,0.025,0.0233333333,0.0166666667,0.0183333333,0.01,0.01,0.015,0.0116666667,0.005,0.015,0.015,0.005,0.0166666667,0.0116666667,0.0183333333,0.0083333333,0.0083333333,0.01,0.0083333333,0.015,0.005,0.0116666667,0.0066666667,0.0133333333,0.0033333333,0.0083333333,0.01,0.0066666667,0.0116666667,0.01,0.0066666667,0.005,0.0116666667,0.005,0.0083333333,0.005,0.0116666667,0.005,0.005,0.0016666667,0.01,0.005,0.0016666667,0.005,0.0116666667,0.0016666667,0.0016666667,0.005,0.0066666667,0.0033333333,0.0083333333,0.0066666667,0.005,0.0033333333,0.005,0.0083333333,0.0066666667,0.005,0.0066666667,0.005,0.0033333333,0.0033333333,0.0033333333,0.01,0.005,0.0033333333,0.005,0.005,0.0033333333,0.0016666667,0.0083333333,0.005,0.0066666667,0.0066666667,0.0016666667],\"d1\":[0.2833333333,0.2083333333,0.1233333333,0.09,0.0833333333,0.0616666667,0.0466666667,0.0566666667,0.0466666667],\"d2\":[0.1033333333,0.1133333333,0.1066666667,0.1083333333,0.0866666667,0.12,0.0883333333,0.0866666667,0.105,0.0816666667]}]")
  }

  test("Benford CIs by Group ID are correct") {
    val CI0 = Json.stringify(boot.getCIs(benfordRDD(0)))
    CI0 must be("[{\"id\":0,\"level\":0,\"CIs\":{\"d1d2\":{\"n\":1000,\"mean\":[{\"alpha\":0.975,\"li\":8.598075529,\"ui\":983.0942914019,\"lower\":36.5725328543,\"upper\":40.2201214719,\"t0\":38.568},{\"alpha\":0.99,\"li\":3.306858034,\"ui\":993.5484050866,\"lower\":36.2743699219,\"upper\":40.5813515402,\"t0\":38.568}],\"variance\":[{\"alpha\":0.975,\"li\":87.3707208754,\"ui\":1000,\"lower\":587.5851168493,\"upper\":696.638775,\"t0\":632.625376},{\"alpha\":0.99,\"li\":45.0806056342,\"ui\":1000,\"lower\":578.0298817831,\"upper\":696.638775,\"t0\":632.625376}],\"skewness\":[{\"alpha\":0.975,\"li\":312.6946372398,\"ui\":1000,\"lower\":0.7418846057,\"upper\":0.9512303328,\"t0\":0.8168660437},{\"alpha\":0.99,\"li\":211.4404980699,\"ui\":1000,\"lower\":0.7253849116,\"upper\":0.9512303328,\"t0\":0.8168660437}],\"kurtosis\":[{\"alpha\":0.975,\"li\":271.0502711792,\"ui\":1000,\"lower\":-0.6207946055,\"upper\":-0.1123666927,\"t0\":-0.4630422773},{\"alpha\":0.99,\"li\":187.4695054689,\"ui\":1000,\"lower\":-0.6550584872,\"upper\":-0.1123666927,\"t0\":-0.4630422773}]},\"d1\":{\"n\":1000,\"mean\":[{\"alpha\":0.975,\"li\":5.4218226084,\"ui\":974.3077027746,\"lower\":3.2198590762,\"upper\":3.5906087186,\"t0\":3.431},{\"alpha\":0.99,\"li\":1.9944955507,\"ui\":989.3673555855,\"lower\":3.2019344169,\"upper\":3.6204345583,\"t0\":3.431}],\"variance\":[{\"alpha\":0.975,\"li\":30.6986962601,\"ui\":996.4768851743,\"lower\":5.5926115248,\"upper\":6.7139389077,\"t0\":6.105239},{\"alpha\":0.99,\"li\":13.6889863712,\"ui\":999.3779886805,\"lower\":5.5237234195,\"upper\":6.7584876545,\"t0\":6.105239}],\"skewness\":[{\"alpha\":0.975,\"li\":298.1938104921,\"ui\":1000,\"lower\":0.7629290099,\"upper\":0.9803422769,\"t0\":0.8383566405},{\"alpha\":0.99,\"li\":200.797109273,\"ui\":1000,\"lower\":0.7471839609,\"upper\":0.9803422769,\"t0\":0.8383566405}],\"kurtosis\":[{\"alpha\":0.975,\"li\":252.0599792729,\"ui\":1000,\"lower\":-0.6328040744,\"upper\":-0.1076530097,\"t0\":-0.4674906641},{\"alpha\":0.99,\"li\":171.9864473953,\"ui\":1000,\"lower\":-0.6595164283,\"upper\":-0.1076530097,\"t0\":-0.4674906641}]},\"d2\":{\"n\":1000,\"mean\":[{\"alpha\":0.975,\"li\":210.5704011166,\"ui\":1000,\"lower\":4.1175707428,\"upper\":4.524,\"t0\":4.258},{\"alpha\":0.99,\"li\":129.085068265,\"ui\":1000,\"lower\":4.0850852769,\"upper\":4.524,\"t0\":4.258}],\"variance\":[{\"alpha\":0.975,\"li\":3.7789661841,\"ui\":963.6422346199,\"lower\":7.6646545213,\"upper\":8.6771326902,\"t0\":8.185436},{\"alpha\":0.99,\"li\":1.4348131625,\"ui\":984.75857977,\"lower\":7.6411406677,\"upper\":8.7444865005,\"t0\":8.185436}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":394.9530209252,\"lower\":-0.0229818792,\"upper\":0.1174788123,\"t0\":0.0743550775},{\"alpha\":0.99,\"li\":1,\"ui\":526.6787107729,\"lower\":-0.0229818792,\"upper\":0.1336411455,\"t0\":0.0743550775}],\"kurtosis\":[{\"alpha\":0.975,\"li\":1,\"ui\":865.3464137067,\"lower\":-1.3250849828,\"upper\":-1.1605881425,\"t0\":-1.2302835043},{\"alpha\":0.99,\"li\":1,\"ui\":928.4207725682,\"lower\":-1.3250849828,\"upper\":-1.1449136897,\"t0\":-1.2302835043}]},\"r\":{\"n\":1000,\"pearson\":[{\"alpha\":0.975,\"li\":627.7581355236,\"ui\":1000,\"lower\":0.0678488934,\"upper\":0.157522375,\"t0\":0.0984268144},{\"alpha\":0.99,\"li\":497.2777982132,\"ui\":1000,\"lower\":0.0556489204,\"upper\":0.157522375,\"t0\":0.0984268144}],\"alpha0\":[{\"alpha\":0.975,\"li\":1,\"ui\":410.4300153661,\"lower\":2.803135038,\"upper\":3.2083188198,\"t0\":3.0690492235},{\"alpha\":0.99,\"li\":1,\"ui\":544.847737092,\"lower\":2.803135038,\"upper\":3.2569883565,\"t0\":3.0690492235}],\"alpha1\":[{\"alpha\":0.975,\"li\":653.607762122,\"ui\":1000,\"lower\":0.0602504339,\"upper\":0.1380126374,\"t0\":0.0850048794},{\"alpha\":0.99,\"li\":524.5706045961,\"ui\":1000,\"lower\":0.0498190197,\"upper\":0.1380126374,\"t0\":0.0850048794}],\"beta0\":[{\"alpha\":0.975,\"li\":1,\"ui\":841.3144996568,\"lower\":3.4815272268,\"upper\":4.1209951699,\"t0\":3.8669757236},{\"alpha\":0.99,\"li\":1,\"ui\":907.4000046769,\"lower\":3.4815272268,\"upper\":4.1647847309,\"t0\":3.8669757236}],\"beta1\":[{\"alpha\":0.975,\"li\":624.468795218,\"ui\":1000,\"lower\":0.0793472038,\"upper\":0.1898199662,\"t0\":0.1139680199},{\"alpha\":0.99,\"li\":494.6763410149,\"ui\":1000,\"lower\":0.064606129,\"upper\":0.1898199662,\"t0\":0.1139680199}]}}}]")
    val CI1 = Json.stringify(boot.getCIs(benfordRDD(1)))
    CI1 must be("[{\"id\":1,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":6.1878543886,\"ui\":976.6322243927,\"lower\":35.9621625421,\"upper\":40.6498938671,\"t0\":38.4766666667},{\"alpha\":0.99,\"li\":2.3871146448,\"ui\":990.7833190222,\"lower\":35.701510291,\"upper\":40.9719176408,\"t0\":38.4766666667}],\"variance\":[{\"alpha\":0.975,\"li\":5.3941666836,\"ui\":975.3824169612,\"lower\":530.2710623798,\"upper\":682.4585824148,\"t0\":615.9761222222},{\"alpha\":0.99,\"li\":1.8287204391,\"ui\":989.258673298,\"lower\":514.3047968249,\"upper\":688.9971905537,\"t0\":615.9761222222}],\"skewness\":[{\"alpha\":0.975,\"li\":319.8834860462,\"ui\":1000,\"lower\":0.7332439994,\"upper\":0.9737774269,\"t0\":0.8314262616},{\"alpha\":0.99,\"li\":214.8909316777,\"ui\":1000,\"lower\":0.7133907661,\"upper\":0.9737774269,\"t0\":0.8314262616}],\"kurtosis\":[{\"alpha\":0.975,\"li\":249.9007725172,\"ui\":1000,\"lower\":-0.6525485243,\"upper\":0.0206682774,\"t0\":-0.444126526},{\"alpha\":0.99,\"li\":170.2029876561,\"ui\":1000,\"lower\":-0.6906959156,\"upper\":0.0206682774,\"t0\":-0.444126526}]},\"d1\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":3.1746092016,\"ui\":959.9583219511,\"lower\":3.1576384504,\"upper\":3.6216666667,\"t0\":3.4166666667},{\"alpha\":0.99,\"li\":1.1345624509,\"ui\":982.3530297139,\"lower\":3.1084046564,\"upper\":3.6522463308,\"t0\":3.4166666667}],\"variance\":[{\"alpha\":0.975,\"li\":4.1117398249,\"ui\":969.4320120183,\"lower\":5.0861235867,\"upper\":6.6167327658,\"t0\":5.9897222222},{\"alpha\":0.99,\"li\":1.3651436253,\"ui\":986.2651375723,\"lower\":4.9276524256,\"upper\":6.6929856682,\"t0\":5.9897222222}],\"skewness\":[{\"alpha\":0.975,\"li\":327.6490815959,\"ui\":1000,\"lower\":0.7591721966,\"upper\":1.0111752577,\"t0\":0.8552433321},{\"alpha\":0.99,\"li\":221.2025448709,\"ui\":1000,\"lower\":0.7373814075,\"upper\":1.0111752577,\"t0\":0.8552433321}],\"kurtosis\":[{\"alpha\":0.975,\"li\":258.1505009683,\"ui\":1000,\"lower\":-0.6504223928,\"upper\":0.0810984483,\"t0\":-0.4401653371},{\"alpha\":0.99,\"li\":176.8832546312,\"ui\":1000,\"lower\":-0.6912903013,\"upper\":0.0810984483,\"t0\":-0.4401653371}]},\"d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":422.2083282957,\"ui\":1000,\"lower\":4.165,\"upper\":4.6016666667,\"t0\":4.31},{\"alpha\":0.99,\"li\":304.1373907412,\"ui\":1000,\"lower\":4.1318957959,\"upper\":4.6016666667,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":1,\"ui\":885.557598397,\"lower\":7.3599555556,\"upper\":8.6120213584,\"t0\":8.0872333333},{\"alpha\":0.99,\"li\":1,\"ui\":939.2436575499,\"lower\":7.3599555556,\"upper\":8.7058257488,\"t0\":8.0872333333}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":714.3398204912,\"lower\":-0.0902845125,\"upper\":0.1610622457,\"t0\":0.0830088931},{\"alpha\":0.99,\"li\":1,\"ui\":812.2041833045,\"lower\":-0.0902845125,\"upper\":0.1808227639,\"t0\":0.0830088931}],\"kurtosis\":[{\"alpha\":0.975,\"li\":7.2860989574,\"ui\":978.9800435436,\"lower\":-1.3206815603,\"upper\":-1.1083448015,\"t0\":-1.2128782358},{\"alpha\":0.99,\"li\":3.1126101653,\"ui\":992.6176460701,\"lower\":-1.3333997659,\"upper\":-1.082589179,\"t0\":-1.2128782358}]},\"r\":{\"n\":600,\"pearson\":[{\"alpha\":0.975,\"li\":35.695988704,\"ui\":997.4619598966,\"lower\":-0.0183234198,\"upper\":0.1611923192,\"t0\":0.0640573854},{\"alpha\":0.99,\"li\":16.7009512057,\"ui\":999.8189850981,\"lower\":-0.0277449375,\"upper\":0.1771431019,\"t0\":0.0640573854}]}}}]")
    val CI2 = Json.stringify(boot.getCIs(benfordRDD(2)))
    CI2 must be("[{\"id\":2,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":350,\"mean\":[{\"alpha\":0.975,\"li\":169.3691317558,\"ui\":1000,\"lower\":37.2410559226,\"upper\":43.1885714286,\"t0\":39.38},{\"alpha\":0.99,\"li\":100.5370980354,\"ui\":1000,\"lower\":36.9191142922,\"upper\":43.1885714286,\"t0\":39.38}],\"variance\":[{\"alpha\":0.975,\"li\":615.4950562703,\"ui\":1000,\"lower\":630.3300823979,\"upper\":766.570155102,\"t0\":672.0013142857},{\"alpha\":0.99,\"li\":484.9207341933,\"ui\":1000,\"lower\":614.8748551993,\"upper\":766.570155102,\"t0\":672.0013142857}],\"skewness\":[{\"alpha\":0.975,\"li\":27.8161229873,\"ui\":996.0391699495,\"lower\":0.5965656636,\"upper\":0.9968967436,\"t0\":0.7842915914},{\"alpha\":0.99,\"li\":12.6087670621,\"ui\":999.27937203,\"lower\":0.5740691532,\"upper\":1.0245932912,\"t0\":0.7842915914}],\"kurtosis\":[{\"alpha\":0.975,\"li\":5.0837117497,\"ui\":966.1469140544,\"lower\":-1.0082277012,\"upper\":-0.1359872425,\"t0\":-0.6097881532},{\"alpha\":0.99,\"li\":2.4174170529,\"ui\":988.7178879976,\"lower\":-1.0222269151,\"upper\":-0.0520410623,\"t0\":-0.6097881532}]},\"d1\":{\"n\":350,\"mean\":[{\"alpha\":0.975,\"li\":151.173896394,\"ui\":1000,\"lower\":3.3,\"upper\":3.8857142857,\"t0\":3.5142857143},{\"alpha\":0.99,\"li\":87.7832709336,\"ui\":1000,\"lower\":3.2685714286,\"upper\":3.8857142857,\"t0\":3.5142857143}],\"variance\":[{\"alpha\":0.975,\"li\":636.9229503897,\"ui\":1000,\"lower\":6.1555999492,\"upper\":7.4440816327,\"t0\":6.5412244898},{\"alpha\":0.99,\"li\":507.4244487234,\"ui\":1000,\"lower\":6.0139371958,\"upper\":7.4440816327,\"t0\":6.5412244898}],\"skewness\":[{\"alpha\":0.975,\"li\":12.4625694375,\"ui\":988.4356402474,\"lower\":0.5897461808,\"upper\":1.0089688459,\"t0\":0.7924531207},{\"alpha\":0.99,\"li\":5.1601997102,\"ui\":996.152030443,\"lower\":0.5669545615,\"upper\":1.0256682701,\"t0\":0.7924531207}],\"kurtosis\":[{\"alpha\":0.975,\"li\":2.8053531366,\"ui\":942.0979610013,\"lower\":-1.0227128698,\"upper\":-0.2038051564,\"t0\":-0.624752},{\"alpha\":0.99,\"li\":1.2712966134,\"ui\":977.5396967835,\"lower\":-1.04967692,\"upper\":-0.0944285665,\"t0\":-0.624752}]},\"d2\":{\"n\":350,\"mean\":[{\"alpha\":0.975,\"li\":50.891596376,\"ui\":998.8316348045,\"lower\":3.9485714286,\"upper\":4.6047517132,\"t0\":4.2371428571},{\"alpha\":0.99,\"li\":24.5774981019,\"ui\":1000,\"lower\":3.9102333422,\"upper\":4.6685714286,\"t0\":4.2371428571}],\"variance\":[{\"alpha\":0.975,\"li\":1,\"ui\":386.2013046914,\"lower\":7.0310204082,\"upper\":8.1430034411,\"t0\":7.7466204082},{\"alpha\":0.99,\"li\":1,\"ui\":521.0024334573,\"lower\":7.0310204082,\"upper\":8.2673984609,\"t0\":7.7466204082}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":815.6374367509,\"lower\":-0.0738012959,\"upper\":0.2025348376,\"t0\":0.0831427871},{\"alpha\":0.99,\"li\":1,\"ui\":890.7786642725,\"lower\":-0.0738012959,\"upper\":0.2276570654,\"t0\":0.0831427871}],\"kurtosis\":[{\"alpha\":0.975,\"li\":121.2056524124,\"ui\":1000,\"lower\":-1.2777604834,\"upper\":-0.9954642121,\"t0\":-1.1725045208},{\"alpha\":0.99,\"li\":70.6675392812,\"ui\":1000,\"lower\":-1.2980668419,\"upper\":-0.9954642121,\"t0\":-1.1725045208}]},\"r\":{\"n\":350,\"pearson\":[{\"alpha\":0.975,\"li\":32.226688953,\"ui\":996.7596009636,\"lower\":-0.0427131147,\"upper\":0.2029666043,\"t0\":0.0711688614},{\"alpha\":0.99,\"li\":14.4778980403,\"ui\":999.4919060307,\"lower\":-0.0567173226,\"upper\":0.2303334142,\"t0\":0.0711688614}]}}}]")
    val CI3 = Json.stringify(boot.getCIs(benfordRDD(3)))
    CI3 must be ("[{\"id\":3,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":250,\"mean\":[{\"alpha\":0.975,\"li\":1,\"ui\":637.3844404175,\"lower\":33.996,\"upper\":39.2470746414,\"t0\":37.212},{\"alpha\":0.99,\"li\":1,\"ui\":754.0071289757,\"lower\":33.996,\"upper\":39.8040854555,\"t0\":37.212}],\"variance\":[{\"alpha\":0.975,\"li\":1,\"ui\":146.0656681539,\"lower\":464.2944,\"upper\":568.6994749455,\"t0\":534.799056},{\"alpha\":0.99,\"li\":1,\"ui\":233.5695679238,\"lower\":464.2944,\"upper\":584.3149570727,\"t0\":534.799056}],\"skewness\":[{\"alpha\":0.975,\"li\":437.7071041255,\"ui\":1000,\"lower\":0.744777391,\"upper\":1.0782534674,\"t0\":0.8779799909},{\"alpha\":0.99,\"li\":315.7976715103,\"ui\":1000,\"lower\":0.7101573192,\"upper\":1.0782534674,\"t0\":0.8779799909}],\"kurtosis\":[{\"alpha\":0.975,\"li\":646.5607496582,\"ui\":1000,\"lower\":-0.4746062002,\"upper\":0.2796566377,\"t0\":-0.2295633073},{\"alpha\":0.99,\"li\":539.2138365994,\"ui\":1000,\"lower\":-0.5450269854,\"upper\":0.2796566377,\"t0\":-0.2295633073}]},\"d1\":{\"n\":250,\"mean\":[{\"alpha\":0.975,\"li\":1,\"ui\":535.7598936892,\"lower\":3.004,\"upper\":3.464,\"t0\":3.28},{\"alpha\":0.99,\"li\":1,\"ui\":664.1410294441,\"lower\":3.004,\"upper\":3.516,\"t0\":3.28}],\"variance\":[{\"alpha\":0.975,\"li\":1,\"ui\":124.2804552574,\"lower\":4.6596,\"upper\":5.4954831544,\"t0\":5.1856},{\"alpha\":0.99,\"li\":1,\"ui\":204.02170803,\"lower\":4.6596,\"upper\":5.6517986086,\"t0\":5.1856}],\"skewness\":[{\"alpha\":0.975,\"li\":590.5596946918,\"ui\":1000,\"lower\":0.813185634,\"upper\":1.0965880059,\"t0\":0.9293346587},{\"alpha\":0.99,\"li\":462.6342087623,\"ui\":1000,\"lower\":0.7743326531,\"upper\":1.0965880059,\"t0\":0.9293346587}],\"kurtosis\":[{\"alpha\":0.975,\"li\":756.147878809,\"ui\":1000,\"lower\":-0.3921750647,\"upper\":0.4238747838,\"t0\":-0.1820659989},{\"alpha\":0.99,\"li\":659.209549356,\"ui\":1000,\"lower\":-0.4654439038,\"upper\":0.4238747838,\"t0\":-0.1820659989}]},\"d2\":{\"n\":250,\"mean\":[{\"alpha\":0.975,\"li\":531.4918727582,\"ui\":1000,\"lower\":4.2,\"upper\":4.772,\"t0\":4.412},{\"alpha\":0.99,\"li\":401.4499575782,\"ui\":1000,\"lower\":4.148,\"upper\":4.772,\"t0\":4.412}],\"variance\":[{\"alpha\":0.975,\"li\":208.6772548543,\"ui\":1000,\"lower\":7.874816,\"upper\":9.704,\"t0\":8.546256},{\"alpha\":0.99,\"li\":123.0921571614,\"ui\":1000,\"lower\":7.6866010514,\"upper\":9.704,\"t0\":8.546256}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":832.3142011446,\"lower\":-0.1749960757,\"upper\":0.2210085662,\"t0\":0.0731222049},{\"alpha\":0.99,\"li\":1,\"ui\":901.6298025094,\"lower\":-0.1749960757,\"upper\":0.2486580142,\"t0\":0.0731222049}],\"kurtosis\":[{\"alpha\":0.975,\"li\":1,\"ui\":652.4583321764,\"lower\":-1.3955376543,\"upper\":-1.1737643104,\"t0\":-1.2736169607},{\"alpha\":0.99,\"li\":1,\"ui\":786.438578473,\"lower\":-1.3955376543,\"upper\":-1.1411132954,\"t0\":-1.2736169607}]},\"r\":{\"n\":250,\"pearson\":[{\"alpha\":0.975,\"li\":18.1769429944,\"ui\":992.5141957078,\"lower\":-0.0853896118,\"upper\":0.1969745013,\"t0\":0.0577785968},{\"alpha\":0.99,\"li\":7.5157850641,\"ui\":997.7099761899,\"lower\":-0.1093623367,\"upper\":0.2308918357,\"t0\":0.0577785968}]}}}]")
    val CI4 = Json.stringify(boot.getCIs(benfordRDD(4)))
    CI4 must be("[{\"id\":4,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":20.5868915582,\"ui\":993.7753576122,\"lower\":35.9753580644,\"upper\":41.8148726831,\"t0\":38.705},{\"alpha\":0.99,\"li\":8.9717991049,\"ui\":998.3726465525,\"lower\":35.5847987497,\"upper\":42.6890991691,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":324.2538110931,\"ui\":1000,\"lower\":604.2435585461,\"upper\":728.234975,\"t0\":657.567975},{\"alpha\":0.99,\"li\":214.5080801782,\"ui\":1000,\"lower\":591.9025462366,\"upper\":728.234975,\"t0\":657.567975}],\"skewness\":[{\"alpha\":0.975,\"li\":70.3753251536,\"ui\":1000,\"lower\":0.6468451802,\"upper\":1.0441256826,\"t0\":0.795359968},{\"alpha\":0.99,\"li\":38.4329996978,\"ui\":1000,\"lower\":0.6177356324,\"upper\":1.0441256826,\"t0\":0.795359968}],\"kurtosis\":[{\"alpha\":0.975,\"li\":102.3940701861,\"ui\":1000,\"lower\":-0.7648213962,\"upper\":0.1626256694,\"t0\":-0.4949639003},{\"alpha\":0.99,\"li\":65.2782548909,\"ui\":1000,\"lower\":-0.7992689089,\"upper\":0.1626256694,\"t0\":-0.4949639003}]},\"d1\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":22.7936214159,\"ui\":994.6650103712,\"lower\":3.1814833295,\"upper\":3.7682479264,\"t0\":3.4525},{\"alpha\":0.99,\"li\":10.1691331596,\"ui\":998.7667750346,\"lower\":3.1458754326,\"upper\":3.8243294181,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":140.9272180814,\"ui\":1000,\"lower\":5.6557182663,\"upper\":7.13399375,\"t0\":6.27774375},{\"alpha\":0.99,\"li\":79.0987821873,\"ui\":1000,\"lower\":5.5332264893,\"upper\":7.13399375,\"t0\":6.27774375}],\"skewness\":[{\"alpha\":0.975,\"li\":59.5943598202,\"ui\":999.8343906632,\"lower\":0.6612594878,\"upper\":1.1034145855,\"t0\":0.8133183961},{\"alpha\":0.99,\"li\":32.3828210723,\"ui\":1000,\"lower\":0.6410267488,\"upper\":1.1111221598,\"t0\":0.8133183961}],\"kurtosis\":[{\"alpha\":0.975,\"li\":83.6496825069,\"ui\":1000,\"lower\":-0.7844997574,\"upper\":0.1460595275,\"t0\":-0.5086785567},{\"alpha\":0.99,\"li\":52.5810448878,\"ui\":1000,\"lower\":-0.823436454,\"upper\":0.1460595275,\"t0\":-0.5086785567}]},\"d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":7.2486286377,\"ui\":980.5015405185,\"lower\":3.8269488692,\"upper\":4.4912409326,\"t0\":4.18},{\"alpha\":0.99,\"li\":2.6271665051,\"ui\":992.0459293898,\"lower\":3.7741841853,\"upper\":4.5352187001,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":49.7003978678,\"ui\":999.0026833247,\"lower\":7.6277808342,\"upper\":9.3968392997,\"t0\":8.3226},{\"alpha\":0.99,\"li\":24.9720982886,\"ui\":1000,\"lower\":7.4848233395,\"upper\":9.428975,\"t0\":8.3226}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":676.703168143,\"lower\":-0.1278475388,\"upper\":0.1635543367,\"t0\":0.0643472263},{\"alpha\":0.99,\"li\":1,\"ui\":788.9047148934,\"lower\":-0.1278475388,\"upper\":0.1888790772,\"t0\":0.0643472263}],\"kurtosis\":[{\"alpha\":0.975,\"li\":1,\"ui\":618.4248605455,\"lower\":-1.3623393928,\"upper\":-1.1830567508,\"t0\":-1.2604129665},{\"alpha\":0.99,\"li\":1,\"ui\":750.807170047,\"lower\":-1.3623393928,\"upper\":-1.1609113764,\"t0\":-1.2604129665}]},\"r\":{\"n\":400,\"pearson\":[{\"alpha\":0.975,\"li\":943.8932314318,\"ui\":1000,\"lower\":0.1358779418,\"upper\":0.2356556097,\"t0\":0.148522063},{\"alpha\":0.99,\"li\":894.0810260996,\"ui\":1000,\"lower\":0.1170944194,\"upper\":0.2356556097,\"t0\":0.148522063}]}}}]")
    val CI5 = Json.stringify(boot.getCIs(benfordRDD(5)))
    CI5 must be("[{\"id\":5,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":180,\"mean\":[{\"alpha\":0.975,\"li\":279.0015673597,\"ui\":1000,\"lower\":37.488897604,\"upper\":44.3888888889,\"t0\":40.0166666667},{\"alpha\":0.99,\"li\":179.6462941774,\"ui\":1000,\"lower\":36.8666666667,\"upper\":44.3888888889,\"t0\":40.0166666667}],\"variance\":[{\"alpha\":0.975,\"li\":297.3318711784,\"ui\":1000,\"lower\":591.9703806746,\"upper\":814.7739506173,\"t0\":666.9830555556},{\"alpha\":0.99,\"li\":193.6055381958,\"ui\":1000,\"lower\":575.0463919029,\"upper\":814.7739506173,\"t0\":666.9830555556}],\"skewness\":[{\"alpha\":0.975,\"li\":46.7075655561,\"ui\":999.1145179214,\"lower\":0.5664328645,\"upper\":1.1735268834,\"t0\":0.7907282465},{\"alpha\":0.99,\"li\":24.5401673626,\"ui\":1000,\"lower\":0.5396803166,\"upper\":1.1787497442,\"t0\":0.7907282465}],\"kurtosis\":[{\"alpha\":0.975,\"li\":117.2938531468,\"ui\":1000,\"lower\":-0.8348721137,\"upper\":0.6547372404,\"t0\":-0.4471283195},{\"alpha\":0.99,\"li\":78.2850252479,\"ui\":1000,\"lower\":-0.8784409519,\"upper\":0.6547372404,\"t0\":-0.4471283195}]},\"d1\":{\"n\":180,\"mean\":[{\"alpha\":0.975,\"li\":239.8614635984,\"ui\":1000,\"lower\":3.3111111111,\"upper\":4.0333333333,\"t0\":3.5722222222},{\"alpha\":0.99,\"li\":149.9956177342,\"ui\":1000,\"lower\":3.25,\"upper\":4.0333333333,\"t0\":3.5722222222}],\"variance\":[{\"alpha\":0.975,\"li\":174.9615350532,\"ui\":1000,\"lower\":5.5380509175,\"upper\":7.9808333333,\"t0\":6.378117284},{\"alpha\":0.99,\"li\":102.233812461,\"ui\":1000,\"lower\":5.3498765432,\"upper\":7.9808333333,\"t0\":6.378117284}],\"skewness\":[{\"alpha\":0.975,\"li\":30.6225197974,\"ui\":997.195252292,\"lower\":0.5685434663,\"upper\":1.1652272699,\"t0\":0.8051385927},{\"alpha\":0.99,\"li\":15.340244492,\"ui\":999.9161885144,\"lower\":0.5468314995,\"upper\":1.231223787,\"t0\":0.8051385927}],\"kurtosis\":[{\"alpha\":0.975,\"li\":86.7547730332,\"ui\":1000,\"lower\":-0.8663980865,\"upper\":0.6804907083,\"t0\":-0.4734035738},{\"alpha\":0.99,\"li\":56.233176915,\"ui\":1000,\"lower\":-0.9025028864,\"upper\":0.6804907083,\"t0\":-0.4734035738}]},\"d2\":{\"n\":180,\"mean\":[{\"alpha\":0.975,\"li\":94.4783518889,\"ui\":1000,\"lower\":3.8888888889,\"upper\":5.0277777778,\"t0\":4.2944444444},{\"alpha\":0.99,\"li\":47.3723896144,\"ui\":1000,\"lower\":3.8131909115,\"upper\":5.0277777778,\"t0\":4.2944444444}],\"variance\":[{\"alpha\":0.975,\"li\":1,\"ui\":88.0013981708,\"lower\":6.6124691358,\"upper\":7.4944167004,\"t0\":7.3188580247},{\"alpha\":0.99,\"li\":1,\"ui\":155.7474508558,\"lower\":6.6124691358,\"upper\":7.6882984895,\"t0\":7.3188580247}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":769.2819679627,\"lower\":-0.2352136622,\"upper\":0.2085216219,\"t0\":0.0507033364},{\"alpha\":0.99,\"li\":1,\"ui\":858.5672907712,\"lower\":-0.2352136622,\"upper\":0.2444470847,\"t0\":0.0507033364}],\"kurtosis\":[{\"alpha\":0.975,\"li\":255.2797411354,\"ui\":1000,\"lower\":-1.2563272227,\"upper\":-0.8023869546,\"t0\":-1.1354640171},{\"alpha\":0.99,\"li\":176.38887166,\"ui\":1000,\"lower\":-1.2812884504,\"upper\":-0.8023869546,\"t0\":-1.1354640171}]},\"r\":{\"n\":180,\"pearson\":[{\"alpha\":0.975,\"li\":661.7497157696,\"ui\":1000,\"lower\":0.0880482576,\"upper\":0.3703530604,\"t0\":0.1599199363},{\"alpha\":0.99,\"li\":540.7360129004,\"ui\":1000,\"lower\":0.0637793187,\"upper\":0.3703530604,\"t0\":0.1599199363}]}}}]")
    val CI6 = Json.stringify(boot.getCIs(benfordRDD(6)))
    CI6 must be("[{\"id\":6,\"level\":2,\"CIs\":{\"d1d2\":{\"n\":220,\"mean\":[{\"alpha\":0.975,\"li\":1,\"ui\":868.5189558653,\"lower\":33.9863636364,\"upper\":40.5227272727,\"t0\":37.6318181818},{\"alpha\":0.99,\"li\":1,\"ui\":931.7346284847,\"lower\":33.9863636364,\"upper\":41.0896979364,\"t0\":37.6318181818}],\"variance\":[{\"alpha\":0.975,\"li\":115.3551564832,\"ui\":1000,\"lower\":560.0208358253,\"upper\":784.5892561983,\"t0\":647.3053512397},{\"alpha\":0.99,\"li\":64.373718983,\"ui\":1000,\"lower\":546.5153492549,\"upper\":784.5892561983,\"t0\":647.3053512397}],\"skewness\":[{\"alpha\":0.975,\"li\":54.7723533438,\"ui\":999.1907325312,\"lower\":0.5842374232,\"upper\":1.1545770432,\"t0\":0.8000684753},{\"alpha\":0.99,\"li\":27.3168721555,\"ui\":1000,\"lower\":0.5513434496,\"upper\":1.1721273049,\"t0\":0.8000684753}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.8006820139,\"ui\":999.4054316112,\"lower\":-0.9291110347,\"upper\":0.4066047882,\"t0\":-0.5461403995},{\"alpha\":0.99,\"li\":22.9787090878,\"ui\":1000,\"lower\":-0.9856045623,\"upper\":0.4366506651,\"t0\":-0.5461403995}]},\"d1\":{\"n\":220,\"mean\":[{\"alpha\":0.975,\"li\":1,\"ui\":891.2353264412,\"lower\":2.9681818182,\"upper\":3.651066987,\"t0\":3.3545454545},{\"alpha\":0.99,\"li\":1,\"ui\":946.093909826,\"lower\":2.9681818182,\"upper\":3.7181818182,\"t0\":3.3545454545}],\"variance\":[{\"alpha\":0.975,\"li\":50.8229905482,\"ui\":999.0037499315,\"lower\":5.2594315971,\"upper\":7.4947123009,\"t0\":6.1742975207},{\"alpha\":0.99,\"li\":25.2988468128,\"ui\":1000,\"lower\":5.0829942576,\"upper\":7.495268595,\"t0\":6.1742975207}],\"skewness\":[{\"alpha\":0.975,\"li\":51.2987839349,\"ui\":999.1308430262,\"lower\":0.5995912763,\"upper\":1.2031664544,\"t0\":0.8205086823},{\"alpha\":0.99,\"li\":25.993311381,\"ui\":1000,\"lower\":0.570407831,\"upper\":1.22284086,\"t0\":0.8205086823}],\"kurtosis\":[{\"alpha\":0.975,\"li\":39.4429362459,\"ui\":999.5431358489,\"lower\":-0.932549881,\"upper\":0.4698800135,\"t0\":-0.5482374624},{\"alpha\":0.99,\"li\":23.6431927713,\"ui\":1000,\"lower\":-0.9961758837,\"upper\":0.4882538819,\"t0\":-0.5482374624}]},\"d2\":{\"n\":220,\"mean\":[{\"alpha\":0.975,\"li\":1,\"ui\":888.6923195424,\"lower\":3.6136363636,\"upper\":4.4272727273,\"t0\":4.0863636364},{\"alpha\":0.99,\"li\":1,\"ui\":942.0410779906,\"lower\":3.6136363636,\"upper\":4.4956400677,\"t0\":4.0863636364}],\"variance\":[{\"alpha\":0.975,\"li\":933.1692784764,\"ui\":1000,\"lower\":8.9090711451,\"upper\":9.7379338843,\"t0\":9.1243595041},{\"alpha\":0.99,\"li\":878.2620568947,\"ui\":1000,\"lower\":8.7419309947,\"upper\":9.7379338843,\"t0\":9.1243595041}],\"skewness\":[{\"alpha\":0.975,\"li\":1.3885389133,\"ui\":930.1810731183,\"lower\":-0.148721509,\"upper\":0.2734997272,\"t0\":0.0905031999},{\"alpha\":0.99,\"li\":1,\"ui\":966.0553369123,\"lower\":-0.1529226961,\"upper\":0.3058560519,\"t0\":0.0905031999}],\"kurtosis\":[{\"alpha\":0.975,\"li\":1,\"ui\":20.351188483,\"lower\":-1.4114595053,\"upper\":-1.3481382285,\"t0\":-1.3547827181},{\"alpha\":0.99,\"li\":1,\"ui\":44.2504490416,\"lower\":-1.4114595053,\"upper\":-1.3261731998,\"t0\":-1.3547827181}]},\"r\":{\"n\":220,\"pearson\":[{\"alpha\":0.975,\"li\":625.9332319754,\"ui\":1000,\"lower\":0.0753478768,\"upper\":0.2773833722,\"t0\":0.1382353384},{\"alpha\":0.99,\"li\":489.9676881692,\"ui\":1000,\"lower\":0.0550059179,\"upper\":0.2773833722,\"t0\":0.1382353384}]}}}]")
  }

  /*test("Benford CIs by Level are correct") {
    //val CI1 = boot.getCIsByLevel(benfordRDD, 1)
    //Json.stringify(CI1) must be ("[{\"id\":4,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":23.0149256044,\"ui\":994.7820505621,\"lower\":36.1401139422,\"upper\":41.6021263517,\"t0\":38.705},{\"alpha\":0.99,\"li\":10.3612086515,\"ui\":998.8379626371,\"lower\":35.7052815146,\"upper\":42.4777131592,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":339.058885733,\"ui\":1000,\"lower\":606.4803654054,\"upper\":754.6114,\"t0\":657.567975},{\"alpha\":0.99,\"li\":229.682472643,\"ui\":1000,\"lower\":593.8206047973,\"upper\":754.6114,\"t0\":657.567975}],\"skewness\":[{\"alpha\":0.975,\"li\":55.8082032789,\"ui\":999.2900084032,\"lower\":0.6426469256,\"upper\":1.0233172063,\"t0\":0.795359968},{\"alpha\":0.99,\"li\":28.123386381,\"ui\":1000,\"lower\":0.6158664303,\"upper\":1.0378126701,\"t0\":0.795359968}],\"kurtosis\":[{\"alpha\":0.975,\"li\":98.7690547018,\"ui\":1000,\"lower\":-0.7611399178,\"upper\":0.1626256694,\"t0\":-0.4949639003},{\"alpha\":0.99,\"li\":60.2555393933,\"ui\":1000,\"lower\":-0.791685984,\"upper\":0.1626256694,\"t0\":-0.4949639003}]},\"d1\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":22.9010250213,\"ui\":994.802158144,\"lower\":3.195,\"upper\":3.7444775399,\"t0\":3.4525},{\"alpha\":0.99,\"li\":10.4181249868,\"ui\":998.8811125914,\"lower\":3.1603534428,\"upper\":3.8229959006,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":173.0755028262,\"ui\":1000,\"lower\":5.7178506311,\"upper\":7.13399375,\"t0\":6.27774375},{\"alpha\":0.99,\"li\":101.8444965509,\"ui\":1000,\"lower\":5.5964959402,\"upper\":7.13399375,\"t0\":6.27774375}],\"skewness\":[{\"alpha\":0.975,\"li\":46.8122143692,\"ui\":998.7272119181,\"lower\":0.6643005775,\"upper\":1.0348774853,\"t0\":0.8133183961},{\"alpha\":0.99,\"li\":23.0746018632,\"ui\":1000,\"lower\":0.6354248443,\"upper\":1.0399959201,\"t0\":0.8133183961}],\"kurtosis\":[{\"alpha\":0.975,\"li\":73.8879847106,\"ui\":1000,\"lower\":-0.7856901954,\"upper\":0.1108406376,\"t0\":-0.5086785567},{\"alpha\":0.99,\"li\":44.2816684715,\"ui\":1000,\"lower\":-0.8241238841,\"upper\":0.1108406376,\"t0\":-0.5086785567}]},\"d2\":{\"n\":400,\"mean\":[{\"alpha\":0.975,\"li\":10.1750994387,\"ui\":985.4900674237,\"lower\":3.8638591222,\"upper\":4.5112078728,\"t0\":4.18},{\"alpha\":0.99,\"li\":4.2563000936,\"ui\":995.0576449739,\"lower\":3.8270695466,\"upper\":4.545801954,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":58.7335378387,\"ui\":999.5250726162,\"lower\":7.6608585698,\"upper\":9.4408497978,\"t0\":8.3226},{\"alpha\":0.99,\"li\":30.3071689184,\"ui\":1000,\"lower\":7.5550649077,\"upper\":9.47224375,\"t0\":8.3226}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":651.3270885891,\"lower\":-0.1278475388,\"upper\":0.1638533036,\"t0\":0.0643472263},{\"alpha\":0.99,\"li\":1,\"ui\":761.4046568487,\"lower\":-0.1278475388,\"upper\":0.185177447,\"t0\":0.0643472263}],\"kurtosis\":[{\"alpha\":0.975,\"li\":1,\"ui\":589.9497126408,\"lower\":-1.3838953967,\"upper\":-1.1908412209,\"t0\":-1.2604129665},{\"alpha\":0.99,\"li\":1,\"ui\":727.7599517532,\"lower\":-1.3838953967,\"upper\":-1.1654938818,\"t0\":-1.2604129665}]},\"r\":{\"n\":400,\"pearson\":[{\"alpha\":0.975,\"li\":928.9693002026,\"ui\":1000,\"lower\":0.1275337027,\"upper\":0.2356556097,\"t0\":0.148522063},{\"alpha\":0.99,\"li\":870.1463486092,\"ui\":1000,\"lower\":0.1152001107,\"upper\":0.2356556097,\"t0\":0.148522063}]}}},{\"id\":1,\"level\":1,\"CIs\":{\"d1d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":2.7449858386,\"ui\":962.2961310085,\"lower\":35.6896292624,\"upper\":40.4019595458,\"t0\":38.4766666667},{\"alpha\":0.99,\"li\":1,\"ui\":981.4917207356,\"lower\":35.0216666667,\"upper\":40.735,\"t0\":38.4766666667}],\"variance\":[{\"alpha\":0.975,\"li\":3.0724409636,\"ui\":963.2198569971,\"lower\":530.493468463,\"upper\":677.3701445467,\"t0\":615.9761222222},{\"alpha\":0.99,\"li\":1,\"ui\":982.6404468596,\"lower\":490.3311972222,\"upper\":692.1990218957,\"t0\":615.9761222222}],\"skewness\":[{\"alpha\":0.975,\"li\":361.4898862352,\"ui\":1000,\"lower\":0.7405036863,\"upper\":1.0311220714,\"t0\":0.8314262616},{\"alpha\":0.99,\"li\":255.0744186682,\"ui\":1000,\"lower\":0.7201052201,\"upper\":1.0311220714,\"t0\":0.8314262616}],\"kurtosis\":[{\"alpha\":0.975,\"li\":259.7492198658,\"ui\":1000,\"lower\":-0.6501038256,\"upper\":0.0206682774,\"t0\":-0.444126526},{\"alpha\":0.99,\"li\":182.2472090508,\"ui\":1000,\"lower\":-0.683253493,\"upper\":0.0206682774,\"t0\":-0.444126526}]},\"d1\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":1.0220663331,\"ui\":934.4556999945,\"lower\":3.099659082,\"upper\":3.5874237611,\"t0\":3.4166666667},{\"alpha\":0.99,\"li\":1,\"ui\":965.0212590135,\"lower\":3.0983333333,\"upper\":3.6233333333,\"t0\":3.4166666667}],\"variance\":[{\"alpha\":0.975,\"li\":2.4941035922,\"ui\":958.0296410638,\"lower\":5.1190266419,\"upper\":6.583475444,\"t0\":5.9897222222},{\"alpha\":0.99,\"li\":1,\"ui\":979.6958063657,\"lower\":4.8186638889,\"upper\":6.7179749308,\"t0\":5.9897222222}],\"skewness\":[{\"alpha\":0.975,\"li\":390.0164245005,\"ui\":1000,\"lower\":0.7692711402,\"upper\":1.0554384327,\"t0\":0.8552433321},{\"alpha\":0.99,\"li\":281.11096723,\"ui\":1000,\"lower\":0.7469629946,\"upper\":1.0554384327,\"t0\":0.8552433321}],\"kurtosis\":[{\"alpha\":0.975,\"li\":290.9330201538,\"ui\":1000,\"lower\":-0.6447245458,\"upper\":0.0810984483,\"t0\":-0.4401653371},{\"alpha\":0.99,\"li\":208.7689029554,\"ui\":1000,\"lower\":-0.6730043602,\"upper\":0.0810984483,\"t0\":-0.4401653371}]},\"d2\":{\"n\":600,\"mean\":[{\"alpha\":0.975,\"li\":477.4580915111,\"ui\":1000,\"lower\":4.18,\"upper\":4.5183333333,\"t0\":4.31},{\"alpha\":0.99,\"li\":342.158936731,\"ui\":1000,\"lower\":4.145,\"upper\":4.5183333333,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":1,\"ui\":874.5502229873,\"lower\":7.4822666667,\"upper\":8.5957249974,\"t0\":8.0872333333},{\"alpha\":0.99,\"li\":1,\"ui\":933.9098077183,\"lower\":7.4822666667,\"upper\":8.72154912,\"t0\":8.0872333333}],\"skewness\":[{\"alpha\":0.975,\"li\":1,\"ui\":736.2795672908,\"lower\":-0.0501537476,\"upper\":0.1680564246,\"t0\":0.0830088931},{\"alpha\":0.99,\"li\":1,\"ui\":838.1430335791,\"lower\":-0.0501537476,\"upper\":0.190168033,\"t0\":0.0830088931}],\"kurtosis\":[{\"alpha\":0.975,\"li\":7.7718141518,\"ui\":980.4964913981,\"lower\":-1.3219516076,\"upper\":-1.0981054148,\"t0\":-1.2128782358},{\"alpha\":0.99,\"li\":3.2826904473,\"ui\":993.1355577606,\"lower\":-1.3419525892,\"upper\":-1.0738777736,\"t0\":-1.2128782358}]},\"r\":{\"n\":600,\"pearson\":[{\"alpha\":0.975,\"li\":27.4682189029,\"ui\":995.8535155273,\"lower\":-0.0192248871,\"upper\":0.1590227257,\"t0\":0.0640573854},{\"alpha\":0.99,\"li\":12.2063817199,\"ui\":999.1583767121,\"lower\":-0.0302573005,\"upper\":0.1646797703,\"t0\":0.0640573854}]}}}]")
  }*/

}
