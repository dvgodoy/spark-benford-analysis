package com.dvgodoy.spark.benford.distributions

import com.dvgodoy.spark.benford.util.{DataByLevel, ResultsByLevel, StatsCIByLevel}
import org.apache.spark.rdd.RDD

class BootstrapSuite extends SparkSuite {
  protected val boot = Bootstrap()
  protected val benf = Benford()

  protected var data: DataByLevel = _
  protected var sampleRDD: RDD[StatsCIByLevel] = _
  protected var benfordRDD: RDD[StatsCIByLevel] = _
  protected var resultsRDD: RDD[ResultsByLevel] = _

  override def loadAndProcessData(): Unit = {
    val numSamples = 1000
    data =  boot.loadData(sc, "./src/test/resources/datalevels.csv")
    sampleRDD = boot.calcSampleCIs(sc, data, numSamples)
    benfordRDD = benf.calcBenfordCIs(sc, data, numSamples)
    resultsRDD = boot.calcResults(sampleRDD, benfordRDD)
  }

  test("loadData works") {
    data.dataByLevelsRDD.count() must be(3000)
  }

  test("levelIdx assignment is correct") {
    data.levels must be(Array((("L.1",0),0), (("L.1.A",1),1), (("L.1.A.1",2),2), (("L.1.A.2",2),3), (("L.1.B",1),4), (("L.1.B.3",2),5), (("L.1.B.4",2),6)))
  }

  test("hierarchical pointers are correct") {
    data.hierarchy(0) must be(Array(4,1))
    data.hierarchy(1) must be(Array(2,3))
    data.hierarchy(2) must be(Array(-1))
    data.hierarchy(3) must be(Array(-1))
    data.hierarchy(4) must be(Array(6,5))
    data.hierarchy(5) must be(Array(-1))
    data.hierarchy(6) must be(Array(-1))
  }

  test("sample CIs by Group ID are correct") {
    val CI0 = boot.showCIsByGroupId(sampleRDD, 0)
    CI0 must be("{\"group_0\":{\"id\":0,\"level\":0,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":14.4132480208,\"ui\":990.2867752674,\"lower\":36.969261423,\"upper\":40.4787839229,\"t0\":38.568},{\"alpha\":0.99,\"li\":6.2925373461,\"ui\":997.1244903632,\"lower\":36.6742176029,\"upper\":40.7362248519,\"t0\":38.568}],\"variance\":[{\"alpha\":0.975,\"li\":20.9411036941,\"ui\":994.5710088844,\"lower\":583.5460349472,\"upper\":708.7116935144,\"t0\":632.625376},{\"alpha\":0.99,\"li\":10.3454310009,\"ui\":999.1168446586,\"lower\":575.1564526836,\"upper\":717.8026922609,\"t0\":632.625376}],\"skewness\":[{\"alpha\":0.975,\"li\":19.6723637771,\"ui\":993.4595448131,\"lower\":0.7079945559,\"upper\":0.9463749095,\"t0\":0.8168660437},{\"alpha\":0.99,\"li\":8.6863874261,\"ui\":998.3113392204,\"lower\":0.6961341567,\"upper\":0.9615797289,\"t0\":0.8168660437}],\"kurtosis\":[{\"alpha\":0.975,\"li\":19.1163995935,\"ui\":993.5496686103,\"lower\":-0.7040212196,\"upper\":-0.1768217546,\"t0\":-0.4630422773},{\"alpha\":0.99,\"li\":9.0805605343,\"ui\":998.639789617,\"lower\":-0.7245839744,\"upper\":-0.1239063165,\"t0\":-0.4630422773}],\"n\":1000.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":15.0619178829,\"ui\":990.8209416951,\"lower\":3.276,\"upper\":3.6228147181,\"t0\":3.431},{\"alpha\":0.99,\"li\":6.6505685929,\"ui\":997.3744382716,\"lower\":3.252324116,\"upper\":3.6340697008,\"t0\":3.431}],\"variance\":[{\"alpha\":0.975,\"li\":22.3029059024,\"ui\":995.0416080761,\"lower\":5.6128601234,\"upper\":6.8428525679,\"t0\":6.105239},{\"alpha\":0.99,\"li\":10.9463745805,\"ui\":999.2315415843,\"lower\":5.5430754051,\"upper\":6.9047571138,\"t0\":6.105239}],\"skewness\":[{\"alpha\":0.975,\"li\":17.6904250728,\"ui\":992.4438146307,\"lower\":0.724528246,\"upper\":0.9657394637,\"t0\":0.8383566405},{\"alpha\":0.99,\"li\":7.689711214,\"ui\":997.8868327225,\"lower\":0.7127339452,\"upper\":0.9754373259,\"t0\":0.8383566405}],\"kurtosis\":[{\"alpha\":0.975,\"li\":20.6704288774,\"ui\":994.2121646101,\"lower\":-0.7184871102,\"upper\":-0.1718710033,\"t0\":-0.4674906641},{\"alpha\":0.99,\"li\":9.7728572862,\"ui\":998.8320954608,\"lower\":-0.74298615,\"upper\":-0.1172944659,\"t0\":-0.4674906641}],\"n\":1000.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":10.4639961567,\"ui\":986.0736863131,\"lower\":4.046,\"upper\":4.4720716968,\"t0\":4.258},{\"alpha\":0.99,\"li\":4.14543266,\"ui\":994.9669375492,\"lower\":4.0213169068,\"upper\":4.4998586181,\"t0\":4.258}],\"variance\":[{\"alpha\":0.975,\"li\":13.8601367454,\"ui\":989.6724369647,\"lower\":7.6370196248,\"upper\":8.6539987006,\"t0\":8.185436},{\"alpha\":0.99,\"li\":5.3743579252,\"ui\":996.3260000207,\"lower\":7.5790848823,\"upper\":8.7573460988,\"t0\":8.185436}],\"skewness\":[{\"alpha\":0.975,\"li\":9.6472961107,\"ui\":985.1697305193,\"lower\":-0.0435878912,\"upper\":0.1707515722,\"t0\":0.0743550775},{\"alpha\":0.99,\"li\":3.4678282352,\"ui\":994.0591362451,\"lower\":-0.0545993618,\"upper\":0.1820663513,\"t0\":0.0743550775}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.813643002,\"ui\":989.8221340424,\"lower\":-1.3037206754,\"upper\":-1.1407286741,\"t0\":-1.2302835043},{\"alpha\":0.99,\"li\":6.245329656,\"ui\":997.1408749301,\"lower\":-1.3139968358,\"upper\":-1.1315712882,\"t0\":-1.2302835043}],\"n\":1000.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":9.194238571,\"ui\":984.4444568895,\"lower\":0.0247770256,\"upper\":0.1676065718,\"t0\":0.0984268144},{\"alpha\":0.99,\"li\":3.3275057887,\"ui\":993.7776683034,\"lower\":0.0103310364,\"upper\":0.1760702287,\"t0\":0.0984268144}],\"alpha0\":[{\"alpha\":0.975,\"li\":21.0125202367,\"ui\":994.4102185527,\"lower\":2.7996973589,\"upper\":3.4318446629,\"t0\":3.0690492235},{\"alpha\":0.99,\"li\":10.046724758,\"ui\":998.9387182757,\"lower\":2.7760207681,\"upper\":3.4649785094,\"t0\":3.0690492235}],\"alpha1\":[{\"alpha\":0.975,\"li\":9.5104011716,\"ui\":984.8867844825,\"lower\":0.0217953699,\"upper\":0.142397561,\"t0\":0.0850048794},{\"alpha\":0.99,\"li\":3.4990239338,\"ui\":994.0586577554,\"lower\":0.0090477486,\"upper\":0.1532612329,\"t0\":0.0850048794}],\"beta0\":[{\"alpha\":0.975,\"li\":12.3743489211,\"ui\":988.3428232836,\"lower\":3.5293689135,\"upper\":4.2258631669,\"t0\":3.8669757236},{\"alpha\":0.99,\"li\":5.1297892942,\"ui\":996.1222294297,\"lower\":3.467194849,\"upper\":4.3165967789,\"t0\":3.8669757236}],\"beta1\":[{\"alpha\":0.975,\"li\":10.1277602718,\"ui\":985.7632096568,\"lower\":0.0290548763,\"upper\":0.1940377386,\"t0\":0.1139680199},{\"alpha\":0.99,\"li\":3.7662279141,\"ui\":994.4923221175,\"lower\":0.0130553982,\"upper\":0.2065329715,\"t0\":0.1139680199}],\"n\":1000.0}}}}")
    val CI1 = boot.showCIsByGroupId(sampleRDD, 1)
    CI1 must be("{\"group_1\":{\"id\":1,\"level\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":7.7016814839,\"ui\":981.6576174125,\"lower\":36.2440163164,\"upper\":40.4785627098,\"t0\":38.4766666667},{\"alpha\":0.99,\"li\":2.7599955886,\"ui\":992.4911549117,\"lower\":35.7393367193,\"upper\":40.7543476212,\"t0\":38.4766666667}],\"variance\":[{\"alpha\":0.975,\"li\":10.7740283311,\"ui\":986.5691440279,\"lower\":545.2834044111,\"upper\":683.9934220048,\"t0\":615.9761222222},{\"alpha\":0.99,\"li\":4.1081888101,\"ui\":994.9644368177,\"lower\":540.2233777227,\"upper\":697.8207063332,\"t0\":615.9761222222}],\"skewness\":[{\"alpha\":0.975,\"li\":27.8357469962,\"ui\":996.7151770056,\"lower\":0.7054089498,\"upper\":1.0323931086,\"t0\":0.8314262616},{\"alpha\":0.99,\"li\":14.0265030987,\"ui\":999.8004352391,\"lower\":0.6845663948,\"upper\":1.0575518873,\"t0\":0.8314262616}],\"kurtosis\":[{\"alpha\":0.975,\"li\":40.2224947005,\"ui\":999.420227664,\"lower\":-0.6940711972,\"upper\":0.1833244677,\"t0\":-0.444126526},{\"alpha\":0.99,\"li\":23.5224328263,\"ui\":1000.0,\"lower\":-0.7182784007,\"upper\":0.3474653905,\"t0\":-0.444126526}],\"n\":600.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":7.6562777227,\"ui\":981.6434909583,\"lower\":3.1916666667,\"upper\":3.6198590181,\"t0\":3.4166666667},{\"alpha\":0.99,\"li\":2.708482268,\"ui\":992.4081604028,\"lower\":3.1316666667,\"upper\":3.6486455055,\"t0\":3.4166666667}],\"variance\":[{\"alpha\":0.975,\"li\":9.7924517001,\"ui\":985.2391524103,\"lower\":5.26403057,\"upper\":6.6396683814,\"t0\":5.9897222222},{\"alpha\":0.99,\"li\":3.6899017669,\"ui\":994.3397144018,\"lower\":5.1961649344,\"upper\":6.7609447251,\"t0\":5.9897222222}],\"skewness\":[{\"alpha\":0.975,\"li\":30.4324437985,\"ui\":997.2748906068,\"lower\":0.7293452697,\"upper\":1.0636955747,\"t0\":0.8552433321},{\"alpha\":0.99,\"li\":15.4916740655,\"ui\":999.981279623,\"lower\":0.7106837335,\"upper\":1.0940042685,\"t0\":0.8552433321}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.0168127316,\"ui\":999.1237031686,\"lower\":-0.7011201645,\"upper\":0.1265778113,\"t0\":-0.4401653371},{\"alpha\":0.99,\"li\":21.8683065515,\"ui\":1000.0,\"lower\":-0.7322615922,\"upper\":0.3677063471,\"t0\":-0.4401653371}],\"n\":600.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.0625274905,\"ui\":990.6044948163,\"lower\":4.0568806019,\"upper\":4.5676575108,\"t0\":4.31},{\"alpha\":0.99,\"li\":6.000788958,\"ui\":996.818271976,\"lower\":4.0050098635,\"upper\":4.6016898182,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":9.4919165523,\"ui\":984.7382792726,\"lower\":7.4348168717,\"upper\":8.6988180045,\"t0\":8.0872333333},{\"alpha\":0.99,\"li\":3.6102987462,\"ui\":994.17945474,\"lower\":7.3981527452,\"upper\":8.8050889692,\"t0\":8.0872333333}],\"skewness\":[{\"alpha\":0.975,\"li\":10.5988320803,\"ui\":986.3389072817,\"lower\":-0.0533412544,\"upper\":0.2151468524,\"t0\":0.0830088931},{\"alpha\":0.99,\"li\":4.0486088058,\"ui\":994.8773868527,\"lower\":-0.0736883412,\"upper\":0.232018197,\"t0\":0.0830088931}],\"kurtosis\":[{\"alpha\":0.975,\"li\":22.9158548613,\"ui\":995.4907973244,\"lower\":-1.3035902718,\"upper\":-1.0710559495,\"t0\":-1.2128782358},{\"alpha\":0.99,\"li\":11.6740705446,\"ui\":999.4982585546,\"lower\":-1.3124248973,\"upper\":-1.0595667129,\"t0\":-1.2128782358}],\"n\":600.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":7.7907619461,\"ui\":981.6504796042,\"lower\":-0.0304393234,\"upper\":0.1456850067,\"t0\":0.0640573854},{\"alpha\":0.99,\"li\":2.8772461135,\"ui\":992.6720670934,\"lower\":-0.0416294193,\"upper\":0.1569730773,\"t0\":0.0640573854}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":600.0}}}}")
    val CI2 = boot.showCIsByGroupId(sampleRDD, 2)
    CI2 must be("{\"group_2\":{\"id\":2,\"level\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":11.1486082149,\"ui\":986.9592489772,\"lower\":36.4463653236,\"upper\":42.2452350235,\"t0\":39.38},{\"alpha\":0.99,\"li\":4.4650417221,\"ui\":995.3874931661,\"lower\":36.1313862215,\"upper\":42.8288731944,\"t0\":39.38}],\"variance\":[{\"alpha\":0.975,\"li\":15.9784417013,\"ui\":991.3552187277,\"lower\":583.1640065704,\"upper\":780.3738265616,\"t0\":672.0013142857},{\"alpha\":0.99,\"li\":6.7660667685,\"ui\":997.374406237,\"lower\":560.1005097616,\"upper\":790.4625664052,\"t0\":672.0013142857}],\"skewness\":[{\"alpha\":0.975,\"li\":17.8545632875,\"ui\":992.418528101,\"lower\":0.6060028166,\"upper\":0.9848277574,\"t0\":0.7842915914},{\"alpha\":0.99,\"li\":7.5227114178,\"ui\":997.7489170028,\"lower\":0.5743194671,\"upper\":1.0111001293,\"t0\":0.7842915914}],\"kurtosis\":[{\"alpha\":0.975,\"li\":18.5716134678,\"ui\":993.3862413569,\"lower\":-0.9647250106,\"upper\":-0.1558761947,\"t0\":-0.6097881532},{\"alpha\":0.99,\"li\":9.0175256588,\"ui\":998.6839650388,\"lower\":-1.0016229111,\"upper\":-0.0394309364,\"t0\":-0.6097881532}],\"n\":350.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":11.7929107796,\"ui\":987.7076621094,\"lower\":3.2365686157,\"upper\":3.8111624669,\"t0\":3.5142857143},{\"alpha\":0.99,\"li\":4.8250466607,\"ui\":995.8027799091,\"lower\":3.2057142857,\"upper\":3.861654298,\"t0\":3.5142857143}],\"variance\":[{\"alpha\":0.975,\"li\":14.7376493928,\"ui\":990.4053818058,\"lower\":5.6245305073,\"upper\":7.5110112969,\"t0\":6.5412244898},{\"alpha\":0.99,\"li\":5.975538173,\"ui\":996.8175346415,\"lower\":5.4725835444,\"upper\":7.6728411618,\"t0\":6.5412244898}],\"skewness\":[{\"alpha\":0.975,\"li\":17.1085829837,\"ui\":992.0398754108,\"lower\":0.606113695,\"upper\":1.0035861096,\"t0\":0.7924531207},{\"alpha\":0.99,\"li\":7.2545851567,\"ui\":997.6348366965,\"lower\":0.58028854,\"upper\":1.022577515,\"t0\":0.7924531207}],\"kurtosis\":[{\"alpha\":0.975,\"li\":20.1049794241,\"ui\":994.2675057989,\"lower\":-0.9752279294,\"upper\":-0.1534760933,\"t0\":-0.624752},{\"alpha\":0.99,\"li\":10.0176827857,\"ui\":999.0620676726,\"lower\":-1.0155524516,\"upper\":0.0158972826,\"t0\":-0.624752}],\"n\":350.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":9.6774279693,\"ui\":985.1148683665,\"lower\":3.8857142857,\"upper\":4.532709669,\"t0\":4.2371428571},{\"alpha\":0.99,\"li\":3.5905916162,\"ui\":994.202401892,\"lower\":3.8603031738,\"upper\":4.5868098062,\"t0\":4.2371428571}],\"variance\":[{\"alpha\":0.975,\"li\":19.7585211202,\"ui\":993.2585387734,\"lower\":6.9598682294,\"upper\":8.6622331982,\"t0\":7.7466204082},{\"alpha\":0.99,\"li\":8.2463120321,\"ui\":998.0244766662,\"lower\":6.8083702957,\"upper\":8.8458441638,\"t0\":7.7466204082}],\"skewness\":[{\"alpha\":0.975,\"li\":14.3917292937,\"ui\":990.1639698326,\"lower\":-0.0766467367,\"upper\":0.248837885,\"t0\":0.0831427871},{\"alpha\":0.99,\"li\":5.9036192845,\"ui\":996.7768529767,\"lower\":-0.1042651401,\"upper\":0.2794058599,\"t0\":0.0831427871}],\"kurtosis\":[{\"alpha\":0.975,\"li\":16.0777238782,\"ui\":991.9815043032,\"lower\":-1.3045952134,\"upper\":-0.9758183919,\"t0\":-1.1725045208},{\"alpha\":0.99,\"li\":8.0618950822,\"ui\":998.4115248923,\"lower\":-1.3188992026,\"upper\":-0.9489851786,\"t0\":-1.1725045208}],\"n\":350.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":8.9781369453,\"ui\":983.8298105471,\"lower\":-0.0543036963,\"upper\":0.1940672451,\"t0\":0.0711688614},{\"alpha\":0.99,\"li\":3.4402518917,\"ui\":993.837724089,\"lower\":-0.0755363384,\"upper\":0.211597461,\"t0\":0.0711688614}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":350.0}}}}")
    val CI3 = boot.showCIsByGroupId(sampleRDD, 3)
    CI3 must be("{\"group_3\":{\"id\":3,\"level\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":13.2002890058,\"ui\":989.1050640823,\"lower\":33.8817535802,\"upper\":40.4624381021,\"t0\":37.212},{\"alpha\":0.99,\"li\":4.9691311019,\"ui\":995.9614145628,\"lower\":33.0474384338,\"upper\":41.0976527951,\"t0\":37.212}],\"variance\":[{\"alpha\":0.975,\"li\":18.2891543892,\"ui\":992.57934707,\"lower\":429.4412349472,\"upper\":642.4563228815,\"t0\":534.799056},{\"alpha\":0.99,\"li\":7.5855420984,\"ui\":997.7465800536,\"lower\":413.7009735133,\"upper\":667.3645939179,\"t0\":534.799056}],\"skewness\":[{\"alpha\":0.975,\"li\":17.1658013944,\"ui\":992.3328761588,\"lower\":0.6614877124,\"upper\":1.1486810642,\"t0\":0.8779799909},{\"alpha\":0.99,\"li\":7.8386178059,\"ui\":998.0635943235,\"lower\":0.6187213969,\"upper\":1.1896832546,\"t0\":0.8779799909}],\"kurtosis\":[{\"alpha\":0.975,\"li\":30.0452184165,\"ui\":998.3002397443,\"lower\":-0.6792115463,\"upper\":0.7476277511,\"t0\":-0.2295633073},{\"alpha\":0.99,\"li\":17.5796248769,\"ui\":1000.0,\"lower\":-0.7216662321,\"upper\":1.0237338594,\"t0\":-0.2295633073}],\"n\":250.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":10.6955602425,\"ui\":986.5486764711,\"lower\":2.9496339865,\"upper\":3.5901652352,\"t0\":3.28},{\"alpha\":0.99,\"li\":3.9056048562,\"ui\":994.7367850677,\"lower\":2.8476634359,\"upper\":3.648679113,\"t0\":3.28}],\"variance\":[{\"alpha\":0.975,\"li\":17.3141297257,\"ui\":992.0841919004,\"lower\":4.1627957623,\"upper\":6.2041449749,\"t0\":5.1856},{\"alpha\":0.99,\"li\":7.1855609666,\"ui\":997.5623256308,\"lower\":3.9724358149,\"upper\":6.556115088,\"t0\":5.1856}],\"skewness\":[{\"alpha\":0.975,\"li\":17.4213043858,\"ui\":992.5886123739,\"lower\":0.7029784141,\"upper\":1.2223797368,\"t0\":0.9293346587},{\"alpha\":0.99,\"li\":8.1682184901,\"ui\":998.270197868,\"lower\":0.6602024319,\"upper\":1.2632093937,\"t0\":0.9293346587}],\"kurtosis\":[{\"alpha\":0.975,\"li\":30.2287959699,\"ui\":998.3744861551,\"lower\":-0.6545020883,\"upper\":0.8220999786,\"t0\":-0.1820659989},{\"alpha\":0.99,\"li\":17.777616083,\"ui\":1000.0,\"lower\":-0.6771975745,\"upper\":1.0596685483,\"t0\":-0.1820659989}],\"n\":250.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":18.8279522742,\"ui\":993.4327718643,\"lower\":4.0273247798,\"upper\":4.897673701,\"t0\":4.412},{\"alpha\":0.99,\"li\":8.9884246409,\"ui\":998.6240581144,\"lower\":3.9679559795,\"upper\":5.0646392126,\"t0\":4.412}],\"variance\":[{\"alpha\":0.975,\"li\":11.3384272749,\"ui\":987.3243531771,\"lower\":7.5019078777,\"upper\":9.4639753135,\"t0\":8.546256},{\"alpha\":0.99,\"li\":4.0505605964,\"ui\":994.9682699741,\"lower\":7.3425753086,\"upper\":9.5793946172,\"t0\":8.546256}],\"skewness\":[{\"alpha\":0.975,\"li\":5.1153732117,\"ui\":976.6591381117,\"lower\":-0.2165558492,\"upper\":0.2572774064,\"t0\":0.0731222049},{\"alpha\":0.99,\"li\":1.4168526721,\"ui\":988.6852808502,\"lower\":-0.2851199093,\"upper\":0.2726916675,\"t0\":0.0731222049}],\"kurtosis\":[{\"alpha\":0.975,\"li\":17.1699647039,\"ui\":993.0349169966,\"lower\":-1.3906971017,\"upper\":-1.0781024107,\"t0\":-1.2736169607},{\"alpha\":0.99,\"li\":9.1300008412,\"ui\":999.0192052915,\"lower\":-1.3995485007,\"upper\":-0.9957375116,\"t0\":-1.2736169607}],\"n\":250.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":9.9563550089,\"ui\":985.4733049156,\"lower\":-0.0785936001,\"upper\":0.1888972492,\"t0\":0.0577785968},{\"alpha\":0.99,\"li\":3.7631995072,\"ui\":994.4558962573,\"lower\":-0.101028498,\"upper\":0.2064960591,\"t0\":0.0577785968}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":250.0}}}}")
    val CI4 = boot.showCIsByGroupId(sampleRDD, 4)
    CI4 must be("{\"group_4\":{\"id\":4,\"level\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.6484978447,\"ui\":991.259801465,\"lower\":36.1330954577,\"upper\":41.8062554336,\"t0\":38.705},{\"alpha\":0.99,\"li\":6.9413770428,\"ui\":997.5537988299,\"lower\":35.9066747157,\"upper\":42.0099908581,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":14.4202841466,\"ui\":990.1442415833,\"lower\":567.7315608856,\"upper\":752.8274641622,\"t0\":657.567975},{\"alpha\":0.99,\"li\":5.7577901905,\"ui\":996.6459593852,\"lower\":548.2048914919,\"upper\":763.1995041253,\"t0\":657.567975}],\"skewness\":[{\"alpha\":0.975,\"li\":16.5738822517,\"ui\":991.7914287015,\"lower\":0.613728507,\"upper\":1.0085163781,\"t0\":0.795359968},{\"alpha\":0.99,\"li\":7.171749893,\"ui\":997.6311316075,\"lower\":0.5913386751,\"upper\":1.0401580743,\"t0\":0.795359968}],\"kurtosis\":[{\"alpha\":0.975,\"li\":33.3383951546,\"ui\":998.3608677517,\"lower\":-0.7981309119,\"upper\":0.0955451142,\"t0\":-0.4949639003},{\"alpha\":0.99,\"li\":18.5292534366,\"ui\":1000.0,\"lower\":-0.8289020932,\"upper\":0.2814815773,\"t0\":-0.4949639003}],\"n\":400.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":14.7817105074,\"ui\":990.6229641092,\"lower\":3.1975,\"upper\":3.7511314022,\"t0\":3.4525},{\"alpha\":0.99,\"li\":6.5811066767,\"ui\":997.3447503413,\"lower\":3.1789938931,\"upper\":3.7825,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":13.322029992,\"ui\":989.2502193225,\"lower\":5.4425760729,\"upper\":7.1768599185,\"t0\":6.27774375},{\"alpha\":0.99,\"li\":5.3395958343,\"ui\":996.3089650131,\"lower\":5.2657429694,\"upper\":7.2562509677,\"t0\":6.27774375}],\"skewness\":[{\"alpha\":0.975,\"li\":16.2208767922,\"ui\":991.5674843119,\"lower\":0.6253289154,\"upper\":1.0261951359,\"t0\":0.8133183961},{\"alpha\":0.99,\"li\":7.0094658908,\"ui\":997.5434503459,\"lower\":0.6027650801,\"upper\":1.0452939021,\"t0\":0.8133183961}],\"kurtosis\":[{\"alpha\":0.975,\"li\":31.6914106538,\"ui\":998.046339394,\"lower\":-0.8216670468,\"upper\":0.053445836,\"t0\":-0.5086785567},{\"alpha\":0.99,\"li\":17.4213645121,\"ui\":1000.0,\"lower\":-0.8592293975,\"upper\":0.1973911275,\"t0\":-0.5086785567}],\"n\":400.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":17.934247697,\"ui\":992.7127015769,\"lower\":3.875,\"upper\":4.5125,\"t0\":4.18},{\"alpha\":0.99,\"li\":8.0826930469,\"ui\":998.1357424211,\"lower\":3.8279336913,\"upper\":4.6161618309,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":23.505077714,\"ui\":995.2937346128,\"lower\":7.6285131782,\"upper\":9.319984747,\"t0\":8.3226},{\"alpha\":0.99,\"li\":11.275180698,\"ui\":999.2249394873,\"lower\":7.5159969984,\"upper\":9.5622713521,\"t0\":8.3226}],\"skewness\":[{\"alpha\":0.975,\"li\":4.800798052,\"ui\":974.7723596754,\"lower\":-0.1468009791,\"upper\":0.196139743,\"t0\":0.0643472263},{\"alpha\":0.99,\"li\":1.4162474014,\"ui\":988.0834915007,\"lower\":-0.179339258,\"upper\":0.2266598035,\"t0\":0.0643472263}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.0485920892,\"ui\":989.0603810366,\"lower\":-1.3693450483,\"upper\":-1.1277274725,\"t0\":-1.2604129665},{\"alpha\":0.99,\"li\":5.803864494,\"ui\":996.7773413305,\"lower\":-1.3780234679,\"upper\":-1.1018634817,\"t0\":-1.2604129665}],\"n\":400.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":13.0018207204,\"ui\":988.9524080679,\"lower\":0.0314673433,\"upper\":0.2626240338,\"t0\":0.148522063},{\"alpha\":0.99,\"li\":5.1260759456,\"ui\":996.1110974668,\"lower\":0.020785244,\"upper\":0.2783651445,\"t0\":0.148522063}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":400.0}}}}")
    val CI5 = boot.showCIsByGroupId(sampleRDD, 5)
    CI5 must be("{\"group_5\":{\"id\":5,\"level\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":5.8073716523,\"ui\":976.6231606458,\"lower\":34.7469920315,\"upper\":43.9478840266,\"t0\":40.0166666667},{\"alpha\":0.99,\"li\":2.0166460421,\"ui\":990.0019842986,\"lower\":34.2033435767,\"upper\":44.5389312107,\"t0\":40.0166666667}],\"variance\":[{\"alpha\":0.975,\"li\":9.5988582479,\"ui\":985.0734899103,\"lower\":520.3916244577,\"upper\":801.0418208596,\"t0\":666.9830555556},{\"alpha\":0.99,\"li\":3.477049421,\"ui\":994.0570315754,\"lower\":491.519849178,\"upper\":817.8309535805,\"t0\":666.9830555556}],\"skewness\":[{\"alpha\":0.975,\"li\":41.3862946181,\"ui\":999.0673356735,\"lower\":0.5757923393,\"upper\":1.2172584705,\"t0\":0.7907282465},{\"alpha\":0.99,\"li\":22.7470782823,\"ui\":1000.0,\"lower\":0.5564177485,\"upper\":1.2675371042,\"t0\":0.7907282465}],\"kurtosis\":[{\"alpha\":0.975,\"li\":55.1677585604,\"ui\":1000.0,\"lower\":-0.837918163,\"upper\":0.8265520373,\"t0\":-0.4471283195},{\"alpha\":0.99,\"li\":35.8988059566,\"ui\":1000.0,\"lower\":-0.8636094096,\"upper\":0.8265520373,\"t0\":-0.4471283195}],\"n\":180.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":5.7923357986,\"ui\":976.7074524825,\"lower\":3.0790047113,\"upper\":3.9444444444,\"t0\":3.5722222222},{\"alpha\":0.99,\"li\":1.9886215368,\"ui\":989.9637487671,\"lower\":2.9773535561,\"upper\":4.0273599343,\"t0\":3.5722222222}],\"variance\":[{\"alpha\":0.975,\"li\":7.6317279854,\"ui\":981.8008098378,\"lower\":4.9971026423,\"upper\":7.5789293496,\"t0\":6.378117284},{\"alpha\":0.99,\"li\":2.6132298776,\"ui\":992.292580799,\"lower\":4.5322019139,\"upper\":7.7598987573,\"t0\":6.378117284}],\"skewness\":[{\"alpha\":0.975,\"li\":38.5231419046,\"ui\":998.8782391695,\"lower\":0.5841853874,\"upper\":1.2352178797,\"t0\":0.8051385927},{\"alpha\":0.99,\"li\":21.3004677619,\"ui\":1000.0,\"lower\":0.5605223575,\"upper\":1.3009484491,\"t0\":0.8051385927}],\"kurtosis\":[{\"alpha\":0.975,\"li\":60.5281861861,\"ui\":1000.0,\"lower\":-0.8562465996,\"upper\":0.8812661781,\"t0\":-0.4734035738},{\"alpha\":0.99,\"li\":40.3282467353,\"ui\":1000.0,\"lower\":-0.8821434194,\"upper\":0.8812661781,\"t0\":-0.4734035738}],\"n\":180.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":7.5588555196,\"ui\":980.7677557257,\"lower\":3.8254070779,\"upper\":4.7264668863,\"t0\":4.2944444444},{\"alpha\":0.99,\"li\":2.9149560946,\"ui\":992.5729951221,\"lower\":3.8087037663,\"upper\":4.8253349298,\"t0\":4.2944444444}],\"variance\":[{\"alpha\":0.975,\"li\":24.3188821042,\"ui\":994.9808271754,\"lower\":6.2906712675,\"upper\":8.5681026307,\"t0\":7.3188580247},{\"alpha\":0.99,\"li\":10.5751067572,\"ui\":998.7900677747,\"lower\":6.0792705997,\"upper\":8.8000811069,\"t0\":7.3188580247}],\"skewness\":[{\"alpha\":0.975,\"li\":13.9182638535,\"ui\":989.6681535679,\"lower\":-0.2184477589,\"upper\":0.2830315861,\"t0\":0.0507033364},{\"alpha\":0.99,\"li\":5.143148943,\"ui\":996.1173579855,\"lower\":-0.2787852081,\"upper\":0.3211403321,\"t0\":0.0507033364}],\"kurtosis\":[{\"alpha\":0.975,\"li\":11.6466109036,\"ui\":987.253534391,\"lower\":-1.3029308939,\"upper\":-0.8804309576,\"t0\":-1.1354640171},{\"alpha\":0.99,\"li\":5.9390650986,\"ui\":997.0717748386,\"lower\":-1.3313714608,\"upper\":-0.8172480116,\"t0\":-1.1354640171}],\"n\":180.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":17.7728378564,\"ui\":992.463664576,\"lower\":0.0159832748,\"upper\":0.3279569417,\"t0\":0.1599199363},{\"alpha\":0.99,\"li\":7.6750660173,\"ui\":997.8665628691,\"lower\":-0.004359526,\"upper\":0.3628075546,\"t0\":0.1599199363}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":180.0}}}}")
    val CI6 = boot.showCIsByGroupId(sampleRDD, 6)
    CI6 must be("{\"group_6\":{\"id\":6,\"level\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":16.6394477962,\"ui\":991.7689838875,\"lower\":33.9620245355,\"upper\":41.6334872337,\"t0\":37.6318181818},{\"alpha\":0.99,\"li\":7.0562899266,\"ui\":997.5347789375,\"lower\":33.396701995,\"upper\":42.2187578131,\"t0\":37.6318181818}],\"variance\":[{\"alpha\":0.975,\"li\":21.4319697673,\"ui\":994.142221247,\"lower\":536.7521813648,\"upper\":773.2633186764,\"t0\":647.3053512397},{\"alpha\":0.99,\"li\":9.4418613597,\"ui\":998.5414515378,\"lower\":525.509818053,\"upper\":805.6394233689,\"t0\":647.3053512397}],\"skewness\":[{\"alpha\":0.975,\"li\":21.3732258864,\"ui\":994.77173031,\"lower\":0.5760330655,\"upper\":1.1528422171,\"t0\":0.8000684753},{\"alpha\":0.99,\"li\":10.6116343799,\"ui\":999.1957592868,\"lower\":0.5436895811,\"upper\":1.2579071919,\"t0\":0.8000684753}],\"kurtosis\":[{\"alpha\":0.975,\"li\":41.2708370693,\"ui\":999.9746603826,\"lower\":-0.9218156043,\"upper\":0.6132300636,\"t0\":-0.5461403995},{\"alpha\":0.99,\"li\":25.8538905928,\"ui\":1000.0,\"lower\":-0.9623633261,\"upper\":0.6159854095,\"t0\":-0.5461403995}],\"n\":220.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":14.1831849746,\"ui\":990.0226246574,\"lower\":2.9963076812,\"upper\":3.7319169653,\"t0\":3.3545454545},{\"alpha\":0.99,\"li\":5.9103685259,\"ui\":996.7967686892,\"lower\":2.931060649,\"upper\":3.7949988974,\"t0\":3.3545454545}],\"variance\":[{\"alpha\":0.975,\"li\":20.0829712284,\"ui\":993.5794304548,\"lower\":5.1302092745,\"upper\":7.3699636042,\"t0\":6.1742975207},{\"alpha\":0.99,\"li\":8.7626604132,\"ui\":998.3076894068,\"lower\":5.0272599065,\"upper\":7.5891705727,\"t0\":6.1742975207}],\"skewness\":[{\"alpha\":0.975,\"li\":21.2063022576,\"ui\":994.6864377946,\"lower\":0.5958430878,\"upper\":1.1487462574,\"t0\":0.8205086823},{\"alpha\":0.99,\"li\":10.4937366,\"ui\":999.1575662356,\"lower\":0.5670744105,\"upper\":1.2689932602,\"t0\":0.8205086823}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.9394641045,\"ui\":999.6967311091,\"lower\":-0.9370268092,\"upper\":0.5630366347,\"t0\":-0.5482374624},{\"alpha\":0.99,\"li\":23.9513561535,\"ui\":1000.0,\"lower\":-0.9577295528,\"upper\":0.5725950528,\"t0\":-0.5482374624}],\"n\":220.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":18.1551871245,\"ui\":992.800609846,\"lower\":3.677992005,\"upper\":4.5844743053,\"t0\":4.0863636364},{\"alpha\":0.99,\"li\":8.1258126384,\"ui\":998.1365679697,\"lower\":3.5848104143,\"upper\":4.6376060579,\"t0\":4.0863636364}],\"variance\":[{\"alpha\":0.975,\"li\":17.1440477777,\"ui\":991.7947229588,\"lower\":7.980915859,\"upper\":10.2154286707,\"t0\":9.1243595041},{\"alpha\":0.99,\"li\":6.6489344915,\"ui\":997.1828989953,\"lower\":7.7837573877,\"upper\":10.4192063158,\"t0\":9.1243595041}],\"skewness\":[{\"alpha\":0.975,\"li\":11.1619466681,\"ui\":987.0364864796,\"lower\":-0.1566231354,\"upper\":0.3208682898,\"t0\":0.0905031999},{\"alpha\":0.99,\"li\":4.2876568498,\"ui\":995.1976590015,\"lower\":-0.1870047976,\"upper\":0.361528334,\"t0\":0.0905031999}],\"kurtosis\":[{\"alpha\":0.975,\"li\":15.98061042,\"ui\":992.2508190477,\"lower\":-1.4615463339,\"upper\":-1.1623852835,\"t0\":-1.3547827181},{\"alpha\":0.99,\"li\":8.6571312226,\"ui\":998.9138431323,\"lower\":-1.4827396504,\"upper\":-1.1456582627,\"t0\":-1.3547827181}],\"n\":220.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":11.2711547181,\"ui\":987.1480325591,\"lower\":-0.0137464975,\"upper\":0.283614278,\"t0\":0.1382353384},{\"alpha\":0.99,\"li\":4.391641576,\"ui\":995.3174029525,\"lower\":-0.0305695917,\"upper\":0.296468908,\"t0\":0.1382353384}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":220.0}}}}")
  }

  test("sample CIs by Level are correct") {
    val CI1 = boot.showCIsByLevel(sampleRDD, 1)
    CI1 must be (Array("{\"group_4\":{\"id\":4,\"level\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.6484978447,\"ui\":991.259801465,\"lower\":36.1330954577,\"upper\":41.8062554336,\"t0\":38.705},{\"alpha\":0.99,\"li\":6.9413770428,\"ui\":997.5537988299,\"lower\":35.9066747157,\"upper\":42.0099908581,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":14.4202841466,\"ui\":990.1442415833,\"lower\":567.7315608856,\"upper\":752.8274641622,\"t0\":657.567975},{\"alpha\":0.99,\"li\":5.7577901905,\"ui\":996.6459593852,\"lower\":548.2048914919,\"upper\":763.1995041253,\"t0\":657.567975}],\"skewness\":[{\"alpha\":0.975,\"li\":16.5738822517,\"ui\":991.7914287015,\"lower\":0.613728507,\"upper\":1.0085163781,\"t0\":0.795359968},{\"alpha\":0.99,\"li\":7.171749893,\"ui\":997.6311316075,\"lower\":0.5913386751,\"upper\":1.0401580743,\"t0\":0.795359968}],\"kurtosis\":[{\"alpha\":0.975,\"li\":33.3383951546,\"ui\":998.3608677517,\"lower\":-0.7981309119,\"upper\":0.0955451142,\"t0\":-0.4949639003},{\"alpha\":0.99,\"li\":18.5292534366,\"ui\":1000.0,\"lower\":-0.8289020932,\"upper\":0.2814815773,\"t0\":-0.4949639003}],\"n\":400.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":14.7817105074,\"ui\":990.6229641092,\"lower\":3.1975,\"upper\":3.7511314022,\"t0\":3.4525},{\"alpha\":0.99,\"li\":6.5811066767,\"ui\":997.3447503413,\"lower\":3.1789938931,\"upper\":3.7825,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":13.322029992,\"ui\":989.2502193225,\"lower\":5.4425760729,\"upper\":7.1768599185,\"t0\":6.27774375},{\"alpha\":0.99,\"li\":5.3395958343,\"ui\":996.3089650131,\"lower\":5.2657429694,\"upper\":7.2562509677,\"t0\":6.27774375}],\"skewness\":[{\"alpha\":0.975,\"li\":16.2208767922,\"ui\":991.5674843119,\"lower\":0.6253289154,\"upper\":1.0261951359,\"t0\":0.8133183961},{\"alpha\":0.99,\"li\":7.0094658908,\"ui\":997.5434503459,\"lower\":0.6027650801,\"upper\":1.0452939021,\"t0\":0.8133183961}],\"kurtosis\":[{\"alpha\":0.975,\"li\":31.6914106538,\"ui\":998.046339394,\"lower\":-0.8216670468,\"upper\":0.053445836,\"t0\":-0.5086785567},{\"alpha\":0.99,\"li\":17.4213645121,\"ui\":1000.0,\"lower\":-0.8592293975,\"upper\":0.1973911275,\"t0\":-0.5086785567}],\"n\":400.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":17.934247697,\"ui\":992.7127015769,\"lower\":3.875,\"upper\":4.5125,\"t0\":4.18},{\"alpha\":0.99,\"li\":8.0826930469,\"ui\":998.1357424211,\"lower\":3.8279336913,\"upper\":4.6161618309,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":23.505077714,\"ui\":995.2937346128,\"lower\":7.6285131782,\"upper\":9.319984747,\"t0\":8.3226},{\"alpha\":0.99,\"li\":11.275180698,\"ui\":999.2249394873,\"lower\":7.5159969984,\"upper\":9.5622713521,\"t0\":8.3226}],\"skewness\":[{\"alpha\":0.975,\"li\":4.800798052,\"ui\":974.7723596754,\"lower\":-0.1468009791,\"upper\":0.196139743,\"t0\":0.0643472263},{\"alpha\":0.99,\"li\":1.4162474014,\"ui\":988.0834915007,\"lower\":-0.179339258,\"upper\":0.2266598035,\"t0\":0.0643472263}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.0485920892,\"ui\":989.0603810366,\"lower\":-1.3693450483,\"upper\":-1.1277274725,\"t0\":-1.2604129665},{\"alpha\":0.99,\"li\":5.803864494,\"ui\":996.7773413305,\"lower\":-1.3780234679,\"upper\":-1.1018634817,\"t0\":-1.2604129665}],\"n\":400.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":13.0018207204,\"ui\":988.9524080679,\"lower\":0.0314673433,\"upper\":0.2626240338,\"t0\":0.148522063},{\"alpha\":0.99,\"li\":5.1260759456,\"ui\":996.1110974668,\"lower\":0.020785244,\"upper\":0.2783651445,\"t0\":0.148522063}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":400.0}}}}",
      "{\"group_1\":{\"id\":1,\"level\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":7.7016814839,\"ui\":981.6576174125,\"lower\":36.2440163164,\"upper\":40.4785627098,\"t0\":38.4766666667},{\"alpha\":0.99,\"li\":2.7599955886,\"ui\":992.4911549117,\"lower\":35.7393367193,\"upper\":40.7543476212,\"t0\":38.4766666667}],\"variance\":[{\"alpha\":0.975,\"li\":10.7740283311,\"ui\":986.5691440279,\"lower\":545.2834044111,\"upper\":683.9934220048,\"t0\":615.9761222222},{\"alpha\":0.99,\"li\":4.1081888101,\"ui\":994.9644368177,\"lower\":540.2233777227,\"upper\":697.8207063332,\"t0\":615.9761222222}],\"skewness\":[{\"alpha\":0.975,\"li\":27.8357469962,\"ui\":996.7151770056,\"lower\":0.7054089498,\"upper\":1.0323931086,\"t0\":0.8314262616},{\"alpha\":0.99,\"li\":14.0265030987,\"ui\":999.8004352391,\"lower\":0.6845663948,\"upper\":1.0575518873,\"t0\":0.8314262616}],\"kurtosis\":[{\"alpha\":0.975,\"li\":40.2224947005,\"ui\":999.420227664,\"lower\":-0.6940711972,\"upper\":0.1833244677,\"t0\":-0.444126526},{\"alpha\":0.99,\"li\":23.5224328263,\"ui\":1000.0,\"lower\":-0.7182784007,\"upper\":0.3474653905,\"t0\":-0.444126526}],\"n\":600.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":7.6562777227,\"ui\":981.6434909583,\"lower\":3.1916666667,\"upper\":3.6198590181,\"t0\":3.4166666667},{\"alpha\":0.99,\"li\":2.708482268,\"ui\":992.4081604028,\"lower\":3.1316666667,\"upper\":3.6486455055,\"t0\":3.4166666667}],\"variance\":[{\"alpha\":0.975,\"li\":9.7924517001,\"ui\":985.2391524103,\"lower\":5.26403057,\"upper\":6.6396683814,\"t0\":5.9897222222},{\"alpha\":0.99,\"li\":3.6899017669,\"ui\":994.3397144018,\"lower\":5.1961649344,\"upper\":6.7609447251,\"t0\":5.9897222222}],\"skewness\":[{\"alpha\":0.975,\"li\":30.4324437985,\"ui\":997.2748906068,\"lower\":0.7293452697,\"upper\":1.0636955747,\"t0\":0.8552433321},{\"alpha\":0.99,\"li\":15.4916740655,\"ui\":999.981279623,\"lower\":0.7106837335,\"upper\":1.0940042685,\"t0\":0.8552433321}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.0168127316,\"ui\":999.1237031686,\"lower\":-0.7011201645,\"upper\":0.1265778113,\"t0\":-0.4401653371},{\"alpha\":0.99,\"li\":21.8683065515,\"ui\":1000.0,\"lower\":-0.7322615922,\"upper\":0.3677063471,\"t0\":-0.4401653371}],\"n\":600.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.0625274905,\"ui\":990.6044948163,\"lower\":4.0568806019,\"upper\":4.5676575108,\"t0\":4.31},{\"alpha\":0.99,\"li\":6.000788958,\"ui\":996.818271976,\"lower\":4.0050098635,\"upper\":4.6016898182,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":9.4919165523,\"ui\":984.7382792726,\"lower\":7.4348168717,\"upper\":8.6988180045,\"t0\":8.0872333333},{\"alpha\":0.99,\"li\":3.6102987462,\"ui\":994.17945474,\"lower\":7.3981527452,\"upper\":8.8050889692,\"t0\":8.0872333333}],\"skewness\":[{\"alpha\":0.975,\"li\":10.5988320803,\"ui\":986.3389072817,\"lower\":-0.0533412544,\"upper\":0.2151468524,\"t0\":0.0830088931},{\"alpha\":0.99,\"li\":4.0486088058,\"ui\":994.8773868527,\"lower\":-0.0736883412,\"upper\":0.232018197,\"t0\":0.0830088931}],\"kurtosis\":[{\"alpha\":0.975,\"li\":22.9158548613,\"ui\":995.4907973244,\"lower\":-1.3035902718,\"upper\":-1.0710559495,\"t0\":-1.2128782358},{\"alpha\":0.99,\"li\":11.6740705446,\"ui\":999.4982585546,\"lower\":-1.3124248973,\"upper\":-1.0595667129,\"t0\":-1.2128782358}],\"n\":600.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":7.7907619461,\"ui\":981.6504796042,\"lower\":-0.0304393234,\"upper\":0.1456850067,\"t0\":0.0640573854},{\"alpha\":0.99,\"li\":2.8772461135,\"ui\":992.6720670934,\"lower\":-0.0416294193,\"upper\":0.1569730773,\"t0\":0.0640573854}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":600.0}}}}"))
  }

  test("results by Group ID are correct") {
    val r0 = boot.showResultsByGroupId(resultsRDD, 0)
    r0 must be("{\"group_0\":{\"id\":0,\"level\":0,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":true},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":true,\"contains\":true},\"alpha1\":{\"overlaps\":true,\"contains\":true},\"beta0\":{\"overlaps\":true,\"contains\":true},\"beta1\":{\"overlaps\":true,\"contains\":true}}}}}}")
    val r1 = boot.showResultsByGroupId(resultsRDD, 1)
    r1 must be("{\"group_1\":{\"id\":1,\"level\":1,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}")
    val r2 = boot.showResultsByGroupId(resultsRDD, 2)
    r2 must be("{\"group_2\":{\"id\":2,\"level\":2,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}")
    val r3 = boot.showResultsByGroupId(resultsRDD, 3)
    r3 must be("{\"group_3\":{\"id\":3,\"level\":2,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}")
    val r4 = boot.showResultsByGroupId(resultsRDD, 4)
    r4 must be("{\"group_4\":{\"id\":4,\"level\":1,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}")
    val r5 = boot.showResultsByGroupId(resultsRDD, 5)
    r5 must be("{\"group_5\":{\"id\":5,\"level\":2,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}")
    val r6 = boot.showResultsByGroupId(resultsRDD, 6)
    r6 must be("{\"group_6\":{\"id\":6,\"level\":2,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}")
  }

  test("results by Level are correct") {
    val r1 = boot.showResultsByLevel(resultsRDD, 1)
    r1 must be(Array("{\"group_4\":{\"id\":4,\"level\":1,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}",
      "{\"group_1\":{\"id\":1,\"level\":1,\"results\":{\"diagnostics\":{\"stats\":true,\"regs\":false},\"details\":{\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}}"))
  }

  test("frequencies by GroupID are correct") {
    val f0 = boot.showFrequenciesByGroupId(data, 0)
    f0 must be("{\"group_0\":{\"count\":1000,\"d1d2\":[{\"10\":0.038},{\"11\":0.038},{\"12\":0.03},{\"13\":0.041},{\"14\":0.023},{\"15\":0.035},{\"16\":0.026},{\"17\":0.025},{\"18\":0.023},{\"19\":0.017},{\"20\":0.025},{\"21\":0.021},{\"22\":0.02},{\"23\":0.018},{\"24\":0.014},{\"25\":0.024},{\"26\":0.022},{\"27\":0.017},{\"28\":0.015},{\"29\":0.01},{\"30\":0.014},{\"31\":0.015},{\"32\":0.017},{\"33\":0.006},{\"34\":0.013},{\"35\":0.011},{\"36\":0.013},{\"37\":0.016},{\"38\":0.011},{\"39\":0.016},{\"40\":0.008},{\"41\":0.006},{\"42\":0.007},{\"43\":0.009},{\"44\":0.012},{\"45\":0.006},{\"46\":0.01},{\"47\":0.006},{\"48\":0.012},{\"49\":0.006},{\"50\":0.012},{\"51\":0.014},{\"52\":0.009},{\"53\":0.01},{\"54\":0.007},{\"55\":0.009},{\"56\":0.003},{\"57\":0.011},{\"58\":0.006},{\"59\":0.011},{\"60\":0.005},{\"61\":0.009},{\"62\":0.003},{\"63\":0.007},{\"64\":0.004},{\"65\":0.006},{\"66\":0.006},{\"67\":0.01},{\"68\":0.004},{\"69\":0.007},{\"70\":0.003},{\"71\":0.002},{\"72\":0.006},{\"73\":0.005},{\"74\":0.004},{\"75\":0.008},{\"76\":0.006},{\"77\":0.003},{\"78\":0.005},{\"79\":0.004},{\"80\":0.005},{\"81\":0.008},{\"82\":0.003},{\"83\":0.006},{\"84\":0.006},{\"85\":0.003},{\"86\":0.004},{\"87\":0.002},{\"88\":0.011},{\"89\":0.006},{\"90\":0.004},{\"91\":0.005},{\"92\":0.003},{\"93\":0.004},{\"94\":0.004},{\"95\":0.006},{\"96\":0.008},{\"97\":0.007},{\"98\":0.008},{\"99\":0.002}],\"d1\":[{\"1\":0.296},{\"2\":0.186},{\"3\":0.132},{\"4\":0.082},{\"5\":0.092},{\"6\":0.061},{\"7\":0.046},{\"8\":0.054},{\"9\":0.051}],\"d2\":[{\"1\":0.114},{\"2\":0.118},{\"3\":0.098},{\"4\":0.106},{\"5\":0.087},{\"6\":0.108},{\"7\":0.098},{\"8\":0.097},{\"9\":0.095},{\"10\":0.079}]}}")
    val f1 = boot.showFrequenciesByGroupId(data, 1)
    f1 must be("{\"group_1\":{\"count\":600,\"d1d2\":[{\"10\":0.0366666667},{\"11\":0.0266666667},{\"12\":0.03},{\"13\":0.04},{\"14\":0.02},{\"15\":0.0383333333},{\"16\":0.0233333333},{\"17\":0.0183333333},{\"18\":0.0316666667},{\"19\":0.0183333333},{\"20\":0.0216666667},{\"21\":0.0283333333},{\"22\":0.0283333333},{\"23\":0.0216666667},{\"24\":0.015},{\"25\":0.025},{\"26\":0.0233333333},{\"27\":0.0166666667},{\"28\":0.0183333333},{\"29\":0.01},{\"30\":0.01},{\"31\":0.015},{\"32\":0.0116666667},{\"33\":0.005},{\"34\":0.015},{\"35\":0.015},{\"36\":0.005},{\"37\":0.0166666667},{\"38\":0.0116666667},{\"39\":0.0183333333},{\"40\":0.0083333333},{\"41\":0.0083333333},{\"42\":0.01},{\"43\":0.0083333333},{\"44\":0.015},{\"45\":0.005},{\"46\":0.0116666667},{\"47\":0.0066666667},{\"48\":0.0133333333},{\"49\":0.0033333333},{\"50\":0.0083333333},{\"51\":0.01},{\"52\":0.0066666667},{\"53\":0.0116666667},{\"54\":0.01},{\"55\":0.0066666667},{\"56\":0.005},{\"57\":0.0116666667},{\"58\":0.005},{\"59\":0.0083333333},{\"60\":0.005},{\"61\":0.0116666667},{\"62\":0.005},{\"63\":0.005},{\"64\":0.0016666667},{\"65\":0.01},{\"66\":0.005},{\"67\":0.0016666667},{\"68\":0.005},{\"69\":0.0116666667},{\"70\":0.0016666667},{\"71\":0.0016666667},{\"72\":0.005},{\"73\":0.0066666667},{\"74\":0.0033333333},{\"75\":0.0083333333},{\"76\":0.0066666667},{\"77\":0.005},{\"78\":0.0033333333},{\"79\":0.005},{\"80\":0.0083333333},{\"81\":0.0066666667},{\"82\":0.005},{\"83\":0.0066666667},{\"84\":0.005},{\"85\":0.0033333333},{\"86\":0.0033333333},{\"87\":0.0033333333},{\"88\":0.01},{\"89\":0.005},{\"90\":0.0033333333},{\"91\":0.005},{\"92\":0.005},{\"93\":0.0033333333},{\"94\":0.0016666667},{\"95\":0.0083333333},{\"96\":0.005},{\"97\":0.0066666667},{\"98\":0.0066666667},{\"99\":0.0016666667}],\"d1\":[{\"1\":0.2833333333},{\"2\":0.2083333333},{\"3\":0.1233333333},{\"4\":0.09},{\"5\":0.0833333333},{\"6\":0.0616666667},{\"7\":0.0466666667},{\"8\":0.0566666667},{\"9\":0.0466666667}],\"d2\":[{\"1\":0.1033333333},{\"2\":0.1133333333},{\"3\":0.1066666667},{\"4\":0.1083333333},{\"5\":0.0866666667},{\"6\":0.12},{\"7\":0.0883333333},{\"8\":0.0866666667},{\"9\":0.105},{\"10\":0.0816666667}]}}")
    val f2 = boot.showFrequenciesByGroupId(data, 2)
    f2 must be("{\"group_2\":{\"count\":350,\"d1d2\":[{\"10\":0.0314285714},{\"11\":0.0342857143},{\"12\":0.0285714286},{\"13\":0.0371428571},{\"14\":0.0285714286},{\"15\":0.04},{\"16\":0.0342857143},{\"17\":0.0142857143},{\"18\":0.0342857143},{\"19\":0.0142857143},{\"20\":0.02},{\"21\":0.02},{\"22\":0.0257142857},{\"23\":0.0171428571},{\"24\":0.0171428571},{\"25\":0.0257142857},{\"26\":0.0171428571},{\"27\":0.0228571429},{\"28\":0.0171428571},{\"29\":0.0028571429},{\"30\":0.0142857143},{\"31\":0.02},{\"32\":0.0142857143},{\"33\":0.0},{\"34\":0.0171428571},{\"35\":0.02},{\"36\":0.0057142857},{\"37\":0.0142857143},{\"38\":0.0085714286},{\"39\":0.0085714286},{\"40\":0.0057142857},{\"41\":0.0085714286},{\"42\":0.0085714286},{\"43\":0.0028571429},{\"44\":0.02},{\"45\":0.0028571429},{\"46\":0.0114285714},{\"47\":0.0028571429},{\"48\":0.0114285714},{\"49\":0.0028571429},{\"50\":0.0057142857},{\"51\":0.0085714286},{\"52\":0.0085714286},{\"53\":0.0085714286},{\"54\":0.0085714286},{\"55\":0.0114285714},{\"56\":0.0057142857},{\"57\":0.0114285714},{\"58\":0.0028571429},{\"59\":0.0085714286},{\"60\":0.0057142857},{\"61\":0.0171428571},{\"62\":0.0085714286},{\"63\":0.0028571429},{\"64\":0.0028571429},{\"65\":0.0057142857},{\"66\":0.0057142857},{\"67\":0.0028571429},{\"68\":0.0057142857},{\"69\":0.0114285714},{\"70\":0.0028571429},{\"71\":0.0},{\"72\":0.0085714286},{\"73\":0.0057142857},{\"74\":0.0057142857},{\"75\":0.0085714286},{\"76\":0.0057142857},{\"77\":0.0057142857},{\"78\":0.0057142857},{\"79\":0.0057142857},{\"80\":0.0114285714},{\"81\":0.0028571429},{\"82\":0.0028571429},{\"83\":0.0085714286},{\"84\":0.0028571429},{\"85\":0.0},{\"86\":0.0028571429},{\"87\":0.0028571429},{\"88\":0.0085714286},{\"89\":0.0085714286},{\"90\":0.0057142857},{\"91\":0.0057142857},{\"92\":0.0057142857},{\"93\":0.0057142857},{\"94\":0.0028571429},{\"95\":0.0114285714},{\"96\":0.0085714286},{\"97\":0.0028571429},{\"98\":0.0114285714},{\"99\":0.0028571429}],\"d1\":[{\"1\":0.2971428571},{\"2\":0.1857142857},{\"3\":0.1228571429},{\"4\":0.0771428571},{\"5\":0.08},{\"6\":0.0685714286},{\"7\":0.0542857143},{\"8\":0.0514285714},{\"9\":0.0628571429}],\"d2\":[{\"1\":0.1028571429},{\"2\":0.1171428571},{\"3\":0.1114285714},{\"4\":0.0885714286},{\"5\":0.1057142857},{\"6\":0.1257142857},{\"7\":0.0971428571},{\"8\":0.08},{\"9\":0.1057142857},{\"10\":0.0657142857}]}}")
    val f3 = boot.showFrequenciesByGroupId(data, 3)
    f3 must be("{\"group_3\":{\"count\":250,\"d1d2\":[{\"10\":0.044},{\"11\":0.016},{\"12\":0.032},{\"13\":0.044},{\"14\":0.008},{\"15\":0.036},{\"16\":0.008},{\"17\":0.024},{\"18\":0.028},{\"19\":0.024},{\"20\":0.024},{\"21\":0.04},{\"22\":0.032},{\"23\":0.028},{\"24\":0.012},{\"25\":0.024},{\"26\":0.032},{\"27\":0.008},{\"28\":0.02},{\"29\":0.02},{\"30\":0.004},{\"31\":0.008},{\"32\":0.008},{\"33\":0.012},{\"34\":0.012},{\"35\":0.008},{\"36\":0.004},{\"37\":0.02},{\"38\":0.016},{\"39\":0.032},{\"40\":0.012},{\"41\":0.008},{\"42\":0.012},{\"43\":0.016},{\"44\":0.008},{\"45\":0.008},{\"46\":0.012},{\"47\":0.012},{\"48\":0.016},{\"49\":0.004},{\"50\":0.012},{\"51\":0.012},{\"52\":0.004},{\"53\":0.016},{\"54\":0.012},{\"55\":0.0},{\"56\":0.004},{\"57\":0.012},{\"58\":0.008},{\"59\":0.008},{\"60\":0.004},{\"61\":0.004},{\"62\":0.0},{\"63\":0.008},{\"64\":0.0},{\"65\":0.016},{\"66\":0.004},{\"67\":0.0},{\"68\":0.004},{\"69\":0.012},{\"70\":0.0},{\"71\":0.004},{\"72\":0.0},{\"73\":0.008},{\"74\":0.0},{\"75\":0.008},{\"76\":0.008},{\"77\":0.004},{\"78\":0.0},{\"79\":0.004},{\"80\":0.004},{\"81\":0.012},{\"82\":0.008},{\"83\":0.004},{\"84\":0.008},{\"85\":0.008},{\"86\":0.004},{\"87\":0.004},{\"88\":0.012},{\"89\":0.0},{\"90\":0.0},{\"91\":0.004},{\"92\":0.004},{\"93\":0.0},{\"94\":0.0},{\"95\":0.004},{\"96\":0.0},{\"97\":0.012},{\"98\":0.0},{\"99\":0.0}],\"d1\":[{\"1\":0.264},{\"2\":0.24},{\"3\":0.124},{\"4\":0.108},{\"5\":0.088},{\"6\":0.052},{\"7\":0.036},{\"8\":0.064},{\"9\":0.024}],\"d2\":[{\"1\":0.104},{\"2\":0.108},{\"3\":0.1},{\"4\":0.136},{\"5\":0.06},{\"6\":0.112},{\"7\":0.076},{\"8\":0.096},{\"9\":0.104},{\"10\":0.104}]}}")
    val f4 = boot.showFrequenciesByGroupId(data, 4)
    f4 must be("{\"group_4\":{\"count\":400,\"d1d2\":[{\"10\":0.04},{\"11\":0.055},{\"12\":0.03},{\"13\":0.0425},{\"14\":0.0275},{\"15\":0.03},{\"16\":0.03},{\"17\":0.035},{\"18\":0.01},{\"19\":0.015},{\"20\":0.03},{\"21\":0.01},{\"22\":0.0075},{\"23\":0.0125},{\"24\":0.0125},{\"25\":0.0225},{\"26\":0.02},{\"27\":0.0175},{\"28\":0.01},{\"29\":0.01},{\"30\":0.02},{\"31\":0.015},{\"32\":0.025},{\"33\":0.0075},{\"34\":0.01},{\"35\":0.005},{\"36\":0.025},{\"37\":0.015},{\"38\":0.01},{\"39\":0.0125},{\"40\":0.0075},{\"41\":0.0025},{\"42\":0.0025},{\"43\":0.01},{\"44\":0.0075},{\"45\":0.0075},{\"46\":0.0075},{\"47\":0.005},{\"48\":0.01},{\"49\":0.01},{\"50\":0.0175},{\"51\":0.02},{\"52\":0.0125},{\"53\":0.0075},{\"54\":0.0025},{\"55\":0.0125},{\"56\":0.0},{\"57\":0.01},{\"58\":0.0075},{\"59\":0.015},{\"60\":0.005},{\"61\":0.005},{\"62\":0.0},{\"63\":0.01},{\"64\":0.0075},{\"65\":0.0},{\"66\":0.0075},{\"67\":0.0225},{\"68\":0.0025},{\"69\":0.0},{\"70\":0.005},{\"71\":0.0025},{\"72\":0.0075},{\"73\":0.0025},{\"74\":0.005},{\"75\":0.0075},{\"76\":0.005},{\"77\":0.0},{\"78\":0.0075},{\"79\":0.0025},{\"80\":0.0},{\"81\":0.01},{\"82\":0.0},{\"83\":0.005},{\"84\":0.0075},{\"85\":0.0025},{\"86\":0.005},{\"87\":0.0},{\"88\":0.0125},{\"89\":0.0075},{\"90\":0.005},{\"91\":0.005},{\"92\":0.0},{\"93\":0.005},{\"94\":0.0075},{\"95\":0.0025},{\"96\":0.0125},{\"97\":0.0075},{\"98\":0.01},{\"99\":0.0025}],\"d1\":[{\"1\":0.315},{\"2\":0.1525},{\"3\":0.145},{\"4\":0.07},{\"5\":0.105},{\"6\":0.06},{\"7\":0.045},{\"8\":0.05},{\"9\":0.0575}],\"d2\":[{\"1\":0.13},{\"2\":0.125},{\"3\":0.085},{\"4\":0.1025},{\"5\":0.0875},{\"6\":0.09},{\"7\":0.1125},{\"8\":0.1125},{\"9\":0.08},{\"10\":0.075}]}}")
    val f5 = boot.showFrequenciesByGroupId(data, 5)
    f5 must be("{\"group_5\":{\"count\":180,\"d1d2\":[{\"10\":0.0166666667},{\"11\":0.0555555556},{\"12\":0.0222222222},{\"13\":0.0555555556},{\"14\":0.0333333333},{\"15\":0.0333333333},{\"16\":0.0277777778},{\"17\":0.0277777778},{\"18\":0.0},{\"19\":0.0111111111},{\"20\":0.0166666667},{\"21\":0.0166666667},{\"22\":0.0},{\"23\":0.0166666667},{\"24\":0.0111111111},{\"25\":0.0277777778},{\"26\":0.0222222222},{\"27\":0.0166666667},{\"28\":0.0166666667},{\"29\":0.0055555556},{\"30\":0.0222222222},{\"31\":0.0277777778},{\"32\":0.0277777778},{\"33\":0.0},{\"34\":0.0166666667},{\"35\":0.0},{\"36\":0.0222222222},{\"37\":0.0222222222},{\"38\":0.0111111111},{\"39\":0.0166666667},{\"40\":0.0055555556},{\"41\":0.0},{\"42\":0.0055555556},{\"43\":0.0},{\"44\":0.0166666667},{\"45\":0.0111111111},{\"46\":0.0111111111},{\"47\":0.0},{\"48\":0.0111111111},{\"49\":0.0111111111},{\"50\":0.0166666667},{\"51\":0.0166666667},{\"52\":0.0111111111},{\"53\":0.0166666667},{\"54\":0.0},{\"55\":0.0166666667},{\"56\":0.0},{\"57\":0.0166666667},{\"58\":0.0111111111},{\"59\":0.0111111111},{\"60\":0.0},{\"61\":0.0},{\"62\":0.0},{\"63\":0.0166666667},{\"64\":0.0111111111},{\"65\":0.0},{\"66\":0.0111111111},{\"67\":0.0111111111},{\"68\":0.0},{\"69\":0.0},{\"70\":0.0055555556},{\"71\":0.0},{\"72\":0.0111111111},{\"73\":0.0055555556},{\"74\":0.0111111111},{\"75\":0.0055555556},{\"76\":0.0},{\"77\":0.0},{\"78\":0.0111111111},{\"79\":0.0},{\"80\":0.0},{\"81\":0.0055555556},{\"82\":0.0},{\"83\":0.0},{\"84\":0.0111111111},{\"85\":0.0},{\"86\":0.0055555556},{\"87\":0.0},{\"88\":0.0111111111},{\"89\":0.0},{\"90\":0.0},{\"91\":0.0111111111},{\"92\":0.0},{\"93\":0.0055555556},{\"94\":0.0111111111},{\"95\":0.0055555556},{\"96\":0.0111111111},{\"97\":0.0111111111},{\"98\":0.0166666667},{\"99\":0.0055555556}],\"d1\":[{\"1\":0.2833333333},{\"2\":0.15},{\"3\":0.1666666667},{\"4\":0.0722222222},{\"5\":0.1166666667},{\"6\":0.05},{\"7\":0.05},{\"8\":0.0333333333},{\"9\":0.0777777778}],\"d2\":[{\"1\":0.0833333333},{\"2\":0.1333333333},{\"3\":0.0777777778},{\"4\":0.1166666667},{\"5\":0.1222222222},{\"6\":0.1},{\"7\":0.1111111111},{\"8\":0.1055555556},{\"9\":0.0888888889},{\"10\":0.0611111111}]}}")
    val f6 = boot.showFrequenciesByGroupId(data, 6)
    f6 must be("{\"group_6\":{\"count\":220,\"d1d2\":[{\"10\":0.0590909091},{\"11\":0.0545454545},{\"12\":0.0363636364},{\"13\":0.0318181818},{\"14\":0.0227272727},{\"15\":0.0272727273},{\"16\":0.0318181818},{\"17\":0.0409090909},{\"18\":0.0181818182},{\"19\":0.0181818182},{\"20\":0.0409090909},{\"21\":0.0045454545},{\"22\":0.0136363636},{\"23\":0.0090909091},{\"24\":0.0136363636},{\"25\":0.0181818182},{\"26\":0.0181818182},{\"27\":0.0181818182},{\"28\":0.0045454545},{\"29\":0.0136363636},{\"30\":0.0181818182},{\"31\":0.0045454545},{\"32\":0.0227272727},{\"33\":0.0136363636},{\"34\":0.0045454545},{\"35\":0.0090909091},{\"36\":0.0272727273},{\"37\":0.0090909091},{\"38\":0.0090909091},{\"39\":0.0090909091},{\"40\":0.0090909091},{\"41\":0.0045454545},{\"42\":0.0},{\"43\":0.0181818182},{\"44\":0.0},{\"45\":0.0045454545},{\"46\":0.0045454545},{\"47\":0.0090909091},{\"48\":0.0090909091},{\"49\":0.0090909091},{\"50\":0.0181818182},{\"51\":0.0227272727},{\"52\":0.0136363636},{\"53\":0.0},{\"54\":0.0045454545},{\"55\":0.0090909091},{\"56\":0.0},{\"57\":0.0045454545},{\"58\":0.0045454545},{\"59\":0.0181818182},{\"60\":0.0090909091},{\"61\":0.0090909091},{\"62\":0.0},{\"63\":0.0045454545},{\"64\":0.0045454545},{\"65\":0.0},{\"66\":0.0045454545},{\"67\":0.0318181818},{\"68\":0.0045454545},{\"69\":0.0},{\"70\":0.0045454545},{\"71\":0.0045454545},{\"72\":0.0045454545},{\"73\":0.0},{\"74\":0.0},{\"75\":0.0090909091},{\"76\":0.0090909091},{\"77\":0.0},{\"78\":0.0045454545},{\"79\":0.0045454545},{\"80\":0.0},{\"81\":0.0136363636},{\"82\":0.0},{\"83\":0.0090909091},{\"84\":0.0045454545},{\"85\":0.0045454545},{\"86\":0.0045454545},{\"87\":0.0},{\"88\":0.0136363636},{\"89\":0.0136363636},{\"90\":0.0090909091},{\"91\":0.0},{\"92\":0.0},{\"93\":0.0045454545},{\"94\":0.0045454545},{\"95\":0.0},{\"96\":0.0136363636},{\"97\":0.0045454545},{\"98\":0.0045454545},{\"99\":0.0}],\"d1\":[{\"1\":0.3409090909},{\"2\":0.1545454545},{\"3\":0.1272727273},{\"4\":0.0681818182},{\"5\":0.0954545455},{\"6\":0.0681818182},{\"7\":0.0409090909},{\"8\":0.0636363636},{\"9\":0.0409090909}],\"d2\":[{\"1\":0.1681818182},{\"2\":0.1181818182},{\"3\":0.0909090909},{\"4\":0.0909090909},{\"5\":0.0590909091},{\"6\":0.0818181818},{\"7\":0.1136363636},{\"8\":0.1181818182},{\"9\":0.0727272727},{\"10\":0.0863636364}]}}")
  }

  test("frequencies by Level are correct") {
    val f1 = boot.showFrequenciesByLevel(data, 1)
    f1 must be(Array("{\"group_4\":{\"count\":400,\"d1d2\":[{\"10\":0.04},{\"11\":0.055},{\"12\":0.03},{\"13\":0.0425},{\"14\":0.0275},{\"15\":0.03},{\"16\":0.03},{\"17\":0.035},{\"18\":0.01},{\"19\":0.015},{\"20\":0.03},{\"21\":0.01},{\"22\":0.0075},{\"23\":0.0125},{\"24\":0.0125},{\"25\":0.0225},{\"26\":0.02},{\"27\":0.0175},{\"28\":0.01},{\"29\":0.01},{\"30\":0.02},{\"31\":0.015},{\"32\":0.025},{\"33\":0.0075},{\"34\":0.01},{\"35\":0.005},{\"36\":0.025},{\"37\":0.015},{\"38\":0.01},{\"39\":0.0125},{\"40\":0.0075},{\"41\":0.0025},{\"42\":0.0025},{\"43\":0.01},{\"44\":0.0075},{\"45\":0.0075},{\"46\":0.0075},{\"47\":0.005},{\"48\":0.01},{\"49\":0.01},{\"50\":0.0175},{\"51\":0.02},{\"52\":0.0125},{\"53\":0.0075},{\"54\":0.0025},{\"55\":0.0125},{\"56\":0.0},{\"57\":0.01},{\"58\":0.0075},{\"59\":0.015},{\"60\":0.005},{\"61\":0.005},{\"62\":0.0},{\"63\":0.01},{\"64\":0.0075},{\"65\":0.0},{\"66\":0.0075},{\"67\":0.0225},{\"68\":0.0025},{\"69\":0.0},{\"70\":0.005},{\"71\":0.0025},{\"72\":0.0075},{\"73\":0.0025},{\"74\":0.005},{\"75\":0.0075},{\"76\":0.005},{\"77\":0.0},{\"78\":0.0075},{\"79\":0.0025},{\"80\":0.0},{\"81\":0.01},{\"82\":0.0},{\"83\":0.005},{\"84\":0.0075},{\"85\":0.0025},{\"86\":0.005},{\"87\":0.0},{\"88\":0.0125},{\"89\":0.0075},{\"90\":0.005},{\"91\":0.005},{\"92\":0.0},{\"93\":0.005},{\"94\":0.0075},{\"95\":0.0025},{\"96\":0.0125},{\"97\":0.0075},{\"98\":0.01},{\"99\":0.0025}],\"d1\":[{\"1\":0.315},{\"2\":0.1525},{\"3\":0.145},{\"4\":0.07},{\"5\":0.105},{\"6\":0.06},{\"7\":0.045},{\"8\":0.05},{\"9\":0.0575}],\"d2\":[{\"1\":0.13},{\"2\":0.125},{\"3\":0.085},{\"4\":0.1025},{\"5\":0.0875},{\"6\":0.09},{\"7\":0.1125},{\"8\":0.1125},{\"9\":0.08},{\"10\":0.075}]}}",
      "{\"group_1\":{\"count\":600,\"d1d2\":[{\"10\":0.0366666667},{\"11\":0.0266666667},{\"12\":0.03},{\"13\":0.04},{\"14\":0.02},{\"15\":0.0383333333},{\"16\":0.0233333333},{\"17\":0.0183333333},{\"18\":0.0316666667},{\"19\":0.0183333333},{\"20\":0.0216666667},{\"21\":0.0283333333},{\"22\":0.0283333333},{\"23\":0.0216666667},{\"24\":0.015},{\"25\":0.025},{\"26\":0.0233333333},{\"27\":0.0166666667},{\"28\":0.0183333333},{\"29\":0.01},{\"30\":0.01},{\"31\":0.015},{\"32\":0.0116666667},{\"33\":0.005},{\"34\":0.015},{\"35\":0.015},{\"36\":0.005},{\"37\":0.0166666667},{\"38\":0.0116666667},{\"39\":0.0183333333},{\"40\":0.0083333333},{\"41\":0.0083333333},{\"42\":0.01},{\"43\":0.0083333333},{\"44\":0.015},{\"45\":0.005},{\"46\":0.0116666667},{\"47\":0.0066666667},{\"48\":0.0133333333},{\"49\":0.0033333333},{\"50\":0.0083333333},{\"51\":0.01},{\"52\":0.0066666667},{\"53\":0.0116666667},{\"54\":0.01},{\"55\":0.0066666667},{\"56\":0.005},{\"57\":0.0116666667},{\"58\":0.005},{\"59\":0.0083333333},{\"60\":0.005},{\"61\":0.0116666667},{\"62\":0.005},{\"63\":0.005},{\"64\":0.0016666667},{\"65\":0.01},{\"66\":0.005},{\"67\":0.0016666667},{\"68\":0.005},{\"69\":0.0116666667},{\"70\":0.0016666667},{\"71\":0.0016666667},{\"72\":0.005},{\"73\":0.0066666667},{\"74\":0.0033333333},{\"75\":0.0083333333},{\"76\":0.0066666667},{\"77\":0.005},{\"78\":0.0033333333},{\"79\":0.005},{\"80\":0.0083333333},{\"81\":0.0066666667},{\"82\":0.005},{\"83\":0.0066666667},{\"84\":0.005},{\"85\":0.0033333333},{\"86\":0.0033333333},{\"87\":0.0033333333},{\"88\":0.01},{\"89\":0.005},{\"90\":0.0033333333},{\"91\":0.005},{\"92\":0.005},{\"93\":0.0033333333},{\"94\":0.0016666667},{\"95\":0.0083333333},{\"96\":0.005},{\"97\":0.0066666667},{\"98\":0.0066666667},{\"99\":0.0016666667}],\"d1\":[{\"1\":0.2833333333},{\"2\":0.2083333333},{\"3\":0.1233333333},{\"4\":0.09},{\"5\":0.0833333333},{\"6\":0.0616666667},{\"7\":0.0466666667},{\"8\":0.0566666667},{\"9\":0.0466666667}],\"d2\":[{\"1\":0.1033333333},{\"2\":0.1133333333},{\"3\":0.1066666667},{\"4\":0.1083333333},{\"5\":0.0866666667},{\"6\":0.12},{\"7\":0.0883333333},{\"8\":0.0866666667},{\"9\":0.105},{\"10\":0.0816666667}]}}"))
  }
}
