package com.dvgodoy.spark.benford.distributions

import com.dvgodoy.spark.benford.util.{ResultsByLevel, StatsCIByLevel}
import org.apache.spark.rdd.RDD

class BootstrapSuite extends SparkSuite {
  protected val boot = Bootstrap()
  protected val benf = Benford()

  protected var dataRDD: RDD[((Long, Double, Int), Array[String])] = _
  protected var uniqLevels: Array[((String, Int), Long)] = _
  protected var uniqLevelsBenf: Array[((String, Int), Long)] = _
  protected var pointers: Map[Long,Array[Long]] = _
  protected var pointersBenf: Map[Long,Array[Long]] = _
  protected var sampleRDD: RDD[StatsCIByLevel] = _
  protected var benfordRDD: RDD[StatsCIByLevel] = _
  protected var resultsRDD: RDD[ResultsByLevel] = _

  override def loadAndProcessData(): Unit = {
    val numSamples = 1000
    dataRDD =  boot.loadData(sc, "./src/test/resources/datalevels.csv")
    // workaround -> cannot use multiple assignment to variables
    val (u1, p1, cRDD1) = boot.calcSampleCIs(sc, dataRDD, numSamples)
    uniqLevels = u1
    pointers = p1
    sampleRDD = cRDD1
    // workaround -> cannot use multiple assignment to variables
    val (u2, p2, cRDD2) = benf.calcBenfordCIs(sc, dataRDD, numSamples)
    uniqLevelsBenf = u2
    pointersBenf = p2
    benfordRDD = cRDD2
    resultsRDD = boot.calcResults(sampleRDD, benfordRDD)
  }

  test("loadData works") {
    dataRDD.count() must be(1000)
  }

  test("levelIdx assignment is correct") {
    uniqLevels must be(Array((("L.1",0),0), (("L.1.A",1),1), (("L.1.A.1",2),2), (("L.1.A.2",2),3), (("L.1.B",1),4), (("L.1.B.3",2),5), (("L.1.B.4",2),6)))
  }

  test("hierarchical pointers are correct") {
    pointers(0) must be(Array(4,1))
    pointers(1) must be(Array(2,3))
    pointers(2) must be(Array(-1))
    pointers(3) must be(Array(-1))
    pointers(4) must be(Array(6,5))
    pointers(5) must be(Array(-1))
    pointers(6) must be(Array(-1))
  }

  test("sample CIs by Group ID are correct") {
    val CI0 = boot.showCIsByGroupId(sampleRDD, 0)
    CI0 must be("{\"groupId_0\":{\"idxLevel\":0,\"depth\":0,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":14.413248020799386,\"ui\":990.2867752673773,\"lower\":36.96926142300076,\"upper\":40.4787839229235,\"t0\":38.568},{\"alpha\":0.99,\"li\":6.29253734608586,\"ui\":997.1244903632438,\"lower\":36.67421760293682,\"upper\":40.73622485194196,\"t0\":38.568}],\"variance\":[{\"alpha\":0.975,\"li\":20.941103694050742,\"ui\":994.5710088844222,\"lower\":583.5460349472434,\"upper\":708.7116935144013,\"t0\":632.6253760000002},{\"alpha\":0.99,\"li\":10.34543100094171,\"ui\":999.1168446585558,\"lower\":575.1564526836421,\"upper\":717.8026922608694,\"t0\":632.6253760000002}],\"skewness\":[{\"alpha\":0.975,\"li\":19.672363777110093,\"ui\":993.4595448130968,\"lower\":0.7079945559211179,\"upper\":0.9463749094681381,\"t0\":0.8168660436522553},{\"alpha\":0.99,\"li\":8.686387426089812,\"ui\":998.3113392203617,\"lower\":0.6961341567408244,\"upper\":0.9615797289036275,\"t0\":0.8168660436522553}],\"kurtosis\":[{\"alpha\":0.975,\"li\":19.116399593530033,\"ui\":993.5496686103427,\"lower\":-0.7040212196479286,\"upper\":-0.17682175460454247,\"t0\":-0.4630422773064769},{\"alpha\":0.99,\"li\":9.08056053429982,\"ui\":998.6397896169794,\"lower\":-0.7245839743785841,\"upper\":-0.12390631651612005,\"t0\":-0.4630422773064769}],\"n\":1000.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":15.061917882877392,\"ui\":990.8209416951485,\"lower\":3.276,\"upper\":3.6228147180954022,\"t0\":3.431},{\"alpha\":0.99,\"li\":6.650568592929009,\"ui\":997.3744382716337,\"lower\":3.2523241160148624,\"upper\":3.6340697008286305,\"t0\":3.431}],\"variance\":[{\"alpha\":0.975,\"li\":22.302905902351938,\"ui\":995.0416080760799,\"lower\":5.6128601233719015,\"upper\":6.842852567922903,\"t0\":6.105238999999999},{\"alpha\":0.99,\"li\":10.94637458048944,\"ui\":999.231541584344,\"lower\":5.54307540511251,\"upper\":6.90475711381255,\"t0\":6.105238999999999}],\"skewness\":[{\"alpha\":0.975,\"li\":17.69042507281175,\"ui\":992.443814630672,\"lower\":0.7245282460456324,\"upper\":0.9657394636641456,\"t0\":0.8383566404728828},{\"alpha\":0.99,\"li\":7.689711214036854,\"ui\":997.8868327225435,\"lower\":0.7127339451537371,\"upper\":0.9754373258562236,\"t0\":0.8383566404728828}],\"kurtosis\":[{\"alpha\":0.975,\"li\":20.67042887736964,\"ui\":994.2121646100825,\"lower\":-0.7184871101503751,\"upper\":-0.17187100330537178,\"t0\":-0.4674906641135162},{\"alpha\":0.99,\"li\":9.772857286154991,\"ui\":998.832095460841,\"lower\":-0.7429861500397358,\"upper\":-0.11729446590751098,\"t0\":-0.4674906641135162}],\"n\":1000.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":10.463996156673955,\"ui\":986.0736863131094,\"lower\":4.046,\"upper\":4.472071696813175,\"t0\":4.258},{\"alpha\":0.99,\"li\":4.145432659991802,\"ui\":994.9669375492077,\"lower\":4.021316906774342,\"upper\":4.499858618126566,\"t0\":4.258}],\"variance\":[{\"alpha\":0.975,\"li\":13.860136745433072,\"ui\":989.6724369647312,\"lower\":7.6370196247679,\"upper\":8.653998700634931,\"t0\":8.185436},{\"alpha\":0.99,\"li\":5.374357925232578,\"ui\":996.326000020711,\"lower\":7.579084882311246,\"upper\":8.757346098837052,\"t0\":8.185436}],\"skewness\":[{\"alpha\":0.975,\"li\":9.647296110735988,\"ui\":985.1697305192633,\"lower\":-0.04358789121788347,\"upper\":0.17075157221343942,\"t0\":0.07435507752828449},{\"alpha\":0.99,\"li\":3.4678282352060315,\"ui\":994.0591362451238,\"lower\":-0.05459936175061245,\"upper\":0.18206635132979337,\"t0\":0.07435507752828449}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.813643002029933,\"ui\":989.8221340424445,\"lower\":-1.303720675440294,\"upper\":-1.1407286740833995,\"t0\":-1.230283504281806},{\"alpha\":0.99,\"li\":6.245329656000692,\"ui\":997.1408749301154,\"lower\":-1.313996835765989,\"upper\":-1.1315712881592395,\"t0\":-1.230283504281806}],\"n\":1000.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":9.194238570964865,\"ui\":984.4444568895466,\"lower\":0.024777025580551584,\"upper\":0.167606571837844,\"t0\":0.09842681437986442},{\"alpha\":0.99,\"li\":3.327505788684114,\"ui\":993.7776683034199,\"lower\":0.01033103640429664,\"upper\":0.17607022872001557,\"t0\":0.09842681437986442}],\"alpha0\":[{\"alpha\":0.975,\"li\":21.01252023668647,\"ui\":994.4102185527481,\"lower\":2.799697358918901,\"upper\":3.431844662895193,\"t0\":3.0690492235233413},{\"alpha\":0.99,\"li\":10.046724758043739,\"ui\":998.9387182757412,\"lower\":2.7760207680573834,\"upper\":3.464978509412614,\"t0\":3.0690492235233413}],\"alpha1\":[{\"alpha\":0.975,\"li\":9.510401171609214,\"ui\":984.8867844825442,\"lower\":0.021795369947970232,\"upper\":0.14239756100688422,\"t0\":0.08500487939799405},{\"alpha\":0.99,\"li\":3.499023933822087,\"ui\":994.058657755398,\"lower\":0.009047748603315043,\"upper\":0.1532612328754969,\"t0\":0.08500487939799405}],\"beta0\":[{\"alpha\":0.975,\"li\":12.374348921100625,\"ui\":988.3428232835947,\"lower\":3.5293689134738457,\"upper\":4.225863166862269,\"t0\":3.8669757236367004},{\"alpha\":0.99,\"li\":5.129789294210525,\"ui\":996.1222294297156,\"lower\":3.4671948489933775,\"upper\":4.3165967788990365,\"t0\":3.8669757236367004}],\"beta1\":[{\"alpha\":0.975,\"li\":10.12776027181226,\"ui\":985.7632096568268,\"lower\":0.029054876317688695,\"upper\":0.19403773855112358,\"t0\":0.11396801992518209},{\"alpha\":0.99,\"li\":3.7662279141200417,\"ui\":994.4923221175286,\"lower\":0.013055398232875107,\"upper\":0.20653297147883815,\"t0\":0.11396801992518209}],\"n\":1000.0}}}}")
    val CI1 = boot.showCIsByGroupId(sampleRDD, 1)
    CI1 must be("{\"groupId_1\":{\"idxLevel\":1,\"depth\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":7.701681483921061,\"ui\":981.6576174125446,\"lower\":36.24401631641499,\"upper\":40.47856270976209,\"t0\":38.47666666666667},{\"alpha\":0.99,\"li\":2.759995588578292,\"ui\":992.4911549117165,\"lower\":35.73933671928579,\"upper\":40.75434762115576,\"t0\":38.47666666666667}],\"variance\":[{\"alpha\":0.975,\"li\":10.774028331068894,\"ui\":986.569144027905,\"lower\":545.2834044110515,\"upper\":683.993422004782,\"t0\":615.9761222222221},{\"alpha\":0.99,\"li\":4.108188810082528,\"ui\":994.9644368176669,\"lower\":540.2233777227452,\"upper\":697.8207063331744,\"t0\":615.9761222222221}],\"skewness\":[{\"alpha\":0.975,\"li\":27.835746996160374,\"ui\":996.7151770055613,\"lower\":0.7054089498108999,\"upper\":1.0323931085686044,\"t0\":0.8314262615548288},{\"alpha\":0.99,\"li\":14.026503098741388,\"ui\":999.8004352390903,\"lower\":0.6845663948357598,\"upper\":1.0575518873186498,\"t0\":0.8314262615548288}],\"kurtosis\":[{\"alpha\":0.975,\"li\":40.222494700488596,\"ui\":999.4202276639612,\"lower\":-0.6940711972386032,\"upper\":0.1833244676633252,\"t0\":-0.4441265259643384},{\"alpha\":0.99,\"li\":23.522432826258047,\"ui\":1000.0,\"lower\":-0.7182784006670586,\"upper\":0.3474653904997046,\"t0\":-0.4441265259643384}],\"n\":600.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":7.656277722671019,\"ui\":981.6434909582745,\"lower\":3.191666666666667,\"upper\":3.6198590181183548,\"t0\":3.4166666666666665},{\"alpha\":0.99,\"li\":2.708482268002058,\"ui\":992.4081604028345,\"lower\":3.131666666666667,\"upper\":3.6486455055364306,\"t0\":3.4166666666666665}],\"variance\":[{\"alpha\":0.975,\"li\":9.792451700147137,\"ui\":985.2391524103057,\"lower\":5.264030570038333,\"upper\":6.639668381420138,\"t0\":5.989722222222223},{\"alpha\":0.99,\"li\":3.6899017669141996,\"ui\":994.3397144017969,\"lower\":5.196164934392337,\"upper\":6.760944725065862,\"t0\":5.989722222222223}],\"skewness\":[{\"alpha\":0.975,\"li\":30.432443798519852,\"ui\":997.2748906067527,\"lower\":0.7293452697038588,\"upper\":1.0636955746702363,\"t0\":0.8552433320675884},{\"alpha\":0.99,\"li\":15.49167406546206,\"ui\":999.9812796230228,\"lower\":0.7106837334911889,\"upper\":1.0940042685496782,\"t0\":0.8552433320675884}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.016812731591216,\"ui\":999.1237031685939,\"lower\":-0.7011201644677231,\"upper\":0.12657781128176815,\"t0\":-0.44016533712385203},{\"alpha\":0.99,\"li\":21.868306551526416,\"ui\":1000.0,\"lower\":-0.7322615921897895,\"upper\":0.3677063471106695,\"t0\":-0.44016533712385203}],\"n\":600.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.062527490511325,\"ui\":990.6044948163249,\"lower\":4.056880601935006,\"upper\":4.567657510816443,\"t0\":4.31},{\"alpha\":0.99,\"li\":6.0007889579710785,\"ui\":996.8182719760445,\"lower\":4.0050098635305655,\"upper\":4.601689818191923,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":9.491916552346751,\"ui\":984.7382792726111,\"lower\":7.434816871708476,\"upper\":8.698818004472793,\"t0\":8.087233333333337},{\"alpha\":0.99,\"li\":3.610298746226806,\"ui\":994.1794547399652,\"lower\":7.398152745167515,\"upper\":8.805088969237126,\"t0\":8.087233333333337}],\"skewness\":[{\"alpha\":0.975,\"li\":10.598832080283746,\"ui\":986.3389072816548,\"lower\":-0.05334125437905046,\"upper\":0.21514685244521595,\"t0\":0.08300889305900883},{\"alpha\":0.99,\"li\":4.048608805793303,\"ui\":994.8773868527499,\"lower\":-0.07368834122172291,\"upper\":0.2320181970449949,\"t0\":0.08300889305900883}],\"kurtosis\":[{\"alpha\":0.975,\"li\":22.915854861305334,\"ui\":995.4907973244096,\"lower\":-1.3035902717684495,\"upper\":-1.0710559494885825,\"t0\":-1.2128782358238617},{\"alpha\":0.99,\"li\":11.674070544614652,\"ui\":999.4982585545698,\"lower\":-1.3124248972764776,\"upper\":-1.0595667129248596,\"t0\":-1.2128782358238617}],\"n\":600.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":7.790761946131509,\"ui\":981.6504796042149,\"lower\":-0.030439323413083665,\"upper\":0.14568500671818368,\"t0\":0.06405738537356781},{\"alpha\":0.99,\"li\":2.8772461134871192,\"ui\":992.6720670934233,\"lower\":-0.041629419338242386,\"upper\":0.15697307730955684,\"t0\":0.06405738537356781}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":600.0}}}}")
    /*val CI2 = boot.showCIsByGroupId(sampleRDD, 2)
    CI2 must be("{\"groupId_2\":{\"idxLevel\":2,\"depth\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":11.148608214920213,\"ui\":986.9592489771636,\"lower\":36.44636532358952,\"upper\":42.24523502346083,\"t0\":39.38},{\"alpha\":0.99,\"li\":4.465041722083941,\"ui\":995.3874931660794,\"lower\":36.131386221472255,\"upper\":42.828873194448455,\"t0\":39.38}],\"variance\":[{\"alpha\":0.975,\"li\":15.978441701311187,\"ui\":991.3552187277409,\"lower\":583.1640065703799,\"upper\":780.3738265616266,\"t0\":672.001314285714},{\"alpha\":0.99,\"li\":6.766066768504461,\"ui\":997.3744062370014,\"lower\":560.1005097615829,\"upper\":790.4625664051655,\"t0\":672.001314285714}],\"skewness\":[{\"alpha\":0.975,\"li\":17.854563287464753,\"ui\":992.4185281010315,\"lower\":0.6060028166362041,\"upper\":0.9848277573545013,\"t0\":0.7842915913813273},{\"alpha\":0.99,\"li\":7.522711417829231,\"ui\":997.7489170027914,\"lower\":0.5743194671200595,\"upper\":1.0111001293271689,\"t0\":0.7842915913813273}],\"kurtosis\":[{\"alpha\":0.975,\"li\":18.57161346779369,\"ui\":993.3862413568728,\"lower\":-0.9647250105807361,\"upper\":-0.1558761947444417,\"t0\":-0.609788153151991},{\"alpha\":0.99,\"li\":9.017525658776943,\"ui\":998.6839650388379,\"lower\":-1.001622911063495,\"upper\":-0.03943093640582584,\"t0\":-0.609788153151991}],\"n\":350.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":11.792910779639108,\"ui\":987.7076621093968,\"lower\":3.236568615728979,\"upper\":3.811162466851416,\"t0\":3.5142857142857142},{\"alpha\":0.99,\"li\":4.825046660664865,\"ui\":995.8027799091352,\"lower\":3.2057142857142855,\"upper\":3.8616542979525303,\"t0\":3.5142857142857142}],\"variance\":[{\"alpha\":0.975,\"li\":14.737649392786828,\"ui\":990.4053818058428,\"lower\":5.624530507312671,\"upper\":7.51101129685604,\"t0\":6.541224489795917},{\"alpha\":0.99,\"li\":5.975538173030583,\"ui\":996.8175346415109,\"lower\":5.472583544429729,\"upper\":7.672841161762505,\"t0\":6.541224489795917}],\"skewness\":[{\"alpha\":0.975,\"li\":17.108582983709777,\"ui\":992.039875410758,\"lower\":0.6061136950291782,\"upper\":1.0035861096133627,\"t0\":0.7924531207029399},{\"alpha\":0.99,\"li\":7.254585156664413,\"ui\":997.6348366964553,\"lower\":0.5802885399551185,\"upper\":1.0225775149529455,\"t0\":0.7924531207029399}],\"kurtosis\":[{\"alpha\":0.975,\"li\":20.10497942412737,\"ui\":994.2675057989014,\"lower\":-0.9752279294355229,\"upper\":-0.15347609328183476,\"t0\":-0.6247520000142094},{\"alpha\":0.99,\"li\":10.017682785737462,\"ui\":999.0620676725853,\"lower\":-1.0155524515567715,\"upper\":0.01589728261387679,\"t0\":-0.6247520000142094}],\"n\":350.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":9.67742796925663,\"ui\":985.1148683665186,\"lower\":3.8857142857142857,\"upper\":4.532709669033154,\"t0\":4.2371428571428575},{\"alpha\":0.99,\"li\":3.5905916162236555,\"ui\":994.2024018920234,\"lower\":3.8603031737701032,\"upper\":4.586809806150488,\"t0\":4.2371428571428575}],\"variance\":[{\"alpha\":0.975,\"li\":19.75852112018494,\"ui\":993.2585387733584,\"lower\":6.959868229421927,\"upper\":8.662233198186232,\"t0\":7.74662040816326},{\"alpha\":0.99,\"li\":8.246312032057324,\"ui\":998.0244766662294,\"lower\":6.808370295672105,\"upper\":8.845844163787994,\"t0\":7.74662040816326}],\"skewness\":[{\"alpha\":0.975,\"li\":14.391729293690133,\"ui\":990.1639698326499,\"lower\":-0.07664673674935994,\"upper\":0.24883788496702153,\"t0\":0.08314278713227193},{\"alpha\":0.99,\"li\":5.903619284487099,\"ui\":996.7768529766646,\"lower\":-0.10426514007660292,\"upper\":0.27940585989939276,\"t0\":0.08314278713227193}],\"kurtosis\":[{\"alpha\":0.975,\"li\":16.07772387823764,\"ui\":991.9815043032296,\"lower\":-1.3045952133562249,\"upper\":-0.9758183919093739,\"t0\":-1.1725045208391622},{\"alpha\":0.99,\"li\":8.06189508220344,\"ui\":998.4115248922615,\"lower\":-1.318899202587233,\"upper\":-0.9489851786256348,\"t0\":-1.1725045208391622}],\"n\":350.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":8.978136945256171,\"ui\":983.8298105470752,\"lower\":-0.054303696337917054,\"upper\":0.1940672451067937,\"t0\":0.07116886138601672},{\"alpha\":0.99,\"li\":3.440251891667751,\"ui\":993.8377240889832,\"lower\":-0.07553633840401867,\"upper\":0.21159746103026156,\"t0\":0.07116886138601672}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":350.0}}}}")
    val CI3 = boot.showCIsByGroupId(sampleRDD, 3)
    CI3 must be("{\"groupId_3\":{\"idxLevel\":3,\"depth\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":13.200289005846953,\"ui\":989.1050640823057,\"lower\":33.88175358022773,\"upper\":40.46243810207218,\"t0\":37.212},{\"alpha\":0.99,\"li\":4.969131101922456,\"ui\":995.9614145627754,\"lower\":33.04743843384011,\"upper\":41.09765279510661,\"t0\":37.212}],\"variance\":[{\"alpha\":0.975,\"li\":18.289154389225814,\"ui\":992.5793470700314,\"lower\":429.4412349472269,\"upper\":642.456322881465,\"t0\":534.7990559999996},{\"alpha\":0.99,\"li\":7.585542098355348,\"ui\":997.7465800536435,\"lower\":413.70097351325296,\"upper\":667.3645939178882,\"t0\":534.7990559999996}],\"skewness\":[{\"alpha\":0.975,\"li\":17.165801394427607,\"ui\":992.332876158766,\"lower\":0.6614877124301319,\"upper\":1.1486810641730008,\"t0\":0.8779799909477362},{\"alpha\":0.99,\"li\":7.8386178059404585,\"ui\":998.0635943234904,\"lower\":0.6187213969175432,\"upper\":1.1896832545556528,\"t0\":0.8779799909477362}],\"kurtosis\":[{\"alpha\":0.975,\"li\":30.045218416528282,\"ui\":998.3002397442795,\"lower\":-0.6792115462822169,\"upper\":0.7476277510757694,\"t0\":-0.2295633072533451},{\"alpha\":0.99,\"li\":17.579624876912767,\"ui\":1000.0,\"lower\":-0.7216662321468362,\"upper\":1.0237338593945808,\"t0\":-0.2295633072533451}],\"n\":250.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":10.695560242500829,\"ui\":986.5486764711001,\"lower\":2.949633986498069,\"upper\":3.590165235229543,\"t0\":3.28},{\"alpha\":0.99,\"li\":3.9056048562131034,\"ui\":994.7367850676937,\"lower\":2.84766343593857,\"upper\":3.6486791129549543,\"t0\":3.28}],\"variance\":[{\"alpha\":0.975,\"li\":17.31412972572318,\"ui\":992.0841919004198,\"lower\":4.162795762265065,\"upper\":6.204144974886932,\"t0\":5.185600000000003},{\"alpha\":0.99,\"li\":7.185560966638231,\"ui\":997.5623256307504,\"lower\":3.9724358148783003,\"upper\":6.556115087951829,\"t0\":5.185600000000003}],\"skewness\":[{\"alpha\":0.975,\"li\":17.421304385754677,\"ui\":992.588612373943,\"lower\":0.7029784141420882,\"upper\":1.222379736775658,\"t0\":0.9293346586912574},{\"alpha\":0.99,\"li\":8.168218490130679,\"ui\":998.2701978680174,\"lower\":0.6602024318814529,\"upper\":1.2632093936769917,\"t0\":0.9293346586912574}],\"kurtosis\":[{\"alpha\":0.975,\"li\":30.228795969860467,\"ui\":998.3744861551182,\"lower\":-0.6545020883083807,\"upper\":0.8220999786125154,\"t0\":-0.1820659989198541},{\"alpha\":0.99,\"li\":17.7776160830349,\"ui\":1000.0,\"lower\":-0.6771975745303053,\"upper\":1.0596685483296282,\"t0\":-0.1820659989198541}],\"n\":250.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":18.827952274207533,\"ui\":993.4327718643303,\"lower\":4.027324779751518,\"upper\":4.897673700950734,\"t0\":4.412},{\"alpha\":0.99,\"li\":8.988424640861346,\"ui\":998.624058114449,\"lower\":3.9679559795181523,\"upper\":5.064639212560087,\"t0\":4.412}],\"variance\":[{\"alpha\":0.975,\"li\":11.338427274859987,\"ui\":987.3243531770601,\"lower\":7.501907877721779,\"upper\":9.463975313489097,\"t0\":8.546256},{\"alpha\":0.99,\"li\":4.0505605964315885,\"ui\":994.9682699741387,\"lower\":7.342575308639095,\"upper\":9.579394617210523,\"t0\":8.546256}],\"skewness\":[{\"alpha\":0.975,\"li\":5.115373211737146,\"ui\":976.6591381116675,\"lower\":-0.21655584916217427,\"upper\":0.25727740642445585,\"t0\":0.0731222048756738},{\"alpha\":0.99,\"li\":1.416852672076007,\"ui\":988.6852808502251,\"lower\":-0.2851199092513849,\"upper\":0.2726916674548767,\"t0\":0.0731222048756738}],\"kurtosis\":[{\"alpha\":0.975,\"li\":17.169964703936362,\"ui\":993.0349169965763,\"lower\":-1.390697101745714,\"upper\":-1.0781024106554713,\"t0\":-1.27361696066135},{\"alpha\":0.99,\"li\":9.130000841227249,\"ui\":999.0192052915237,\"lower\":-1.3995485007284318,\"upper\":-0.9957375115798431,\"t0\":-1.27361696066135}],\"n\":250.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":9.95635500885084,\"ui\":985.4733049156135,\"lower\":-0.07859360005496964,\"upper\":0.18889724921083698,\"t0\":0.0577785967726623},{\"alpha\":0.99,\"li\":3.763199507202991,\"ui\":994.4558962573404,\"lower\":-0.10102849804726462,\"upper\":0.20649605910268815,\"t0\":0.0577785967726623}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":250.0}}}}")
    val CI4 = boot.showCIsByGroupId(sampleRDD, 4)
    CI4 must be("{\"groupId_4\":{\"idxLevel\":4,\"depth\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.648497844707329,\"ui\":991.2598014650314,\"lower\":36.13309545766261,\"upper\":41.806255433639485,\"t0\":38.705},{\"alpha\":0.99,\"li\":6.9413770428370825,\"ui\":997.5537988299462,\"lower\":35.90667471565007,\"upper\":42.009990858124894,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":14.42028414658128,\"ui\":990.1442415833104,\"lower\":567.7315608856235,\"upper\":752.8274641622212,\"t0\":657.5679750000002},{\"alpha\":0.99,\"li\":5.757790190490939,\"ui\":996.6459593851806,\"lower\":548.2048914918718,\"upper\":763.1995041252566,\"t0\":657.5679750000002}],\"skewness\":[{\"alpha\":0.975,\"li\":16.573882251684914,\"ui\":991.791428701478,\"lower\":0.6137285069723721,\"upper\":1.0085163781060416,\"t0\":0.7953599680436109},{\"alpha\":0.99,\"li\":7.171749893009289,\"ui\":997.6311316074713,\"lower\":0.5913386750542904,\"upper\":1.0401580743081007,\"t0\":0.7953599680436109}],\"kurtosis\":[{\"alpha\":0.975,\"li\":33.33839515461467,\"ui\":998.3608677517046,\"lower\":-0.7981309118645531,\"upper\":0.09554511422400304,\"t0\":-0.49496390027104353},{\"alpha\":0.99,\"li\":18.529253436574415,\"ui\":1000.0,\"lower\":-0.828902093172043,\"upper\":0.2814815772598688,\"t0\":-0.49496390027104353}],\"n\":400.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":14.781710507419128,\"ui\":990.6229641092168,\"lower\":3.1975,\"upper\":3.75113140216696,\"t0\":3.4525},{\"alpha\":0.99,\"li\":6.581106676686053,\"ui\":997.3447503412865,\"lower\":3.1789938930762296,\"upper\":3.7825,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":13.322029992028309,\"ui\":989.2502193225301,\"lower\":5.442576072911556,\"upper\":7.176859918451924,\"t0\":6.277743750000001},{\"alpha\":0.99,\"li\":5.339595834286819,\"ui\":996.3089650130781,\"lower\":5.265742969443667,\"upper\":7.2562509676677225,\"t0\":6.277743750000001}],\"skewness\":[{\"alpha\":0.975,\"li\":16.220876792213726,\"ui\":991.5674843119109,\"lower\":0.625328915373168,\"upper\":1.0261951359147174,\"t0\":0.8133183960691303},{\"alpha\":0.99,\"li\":7.009465890753459,\"ui\":997.5434503459402,\"lower\":0.6027650800966973,\"upper\":1.0452939020970133,\"t0\":0.8133183960691303}],\"kurtosis\":[{\"alpha\":0.975,\"li\":31.691410653788473,\"ui\":998.0463393939915,\"lower\":-0.821667046807825,\"upper\":0.05344583595793991,\"t0\":-0.5086785567303166},{\"alpha\":0.99,\"li\":17.42136451213197,\"ui\":1000.0,\"lower\":-0.8592293975352642,\"upper\":0.19739112747032186,\"t0\":-0.5086785567303166}],\"n\":400.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":17.934247696983494,\"ui\":992.7127015768666,\"lower\":3.875,\"upper\":4.5125,\"t0\":4.18},{\"alpha\":0.99,\"li\":8.082693046939715,\"ui\":998.1357424210653,\"lower\":3.8279336913202546,\"upper\":4.616161830853282,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":23.50507771395785,\"ui\":995.2937346128323,\"lower\":7.628513178189983,\"upper\":9.319984747002348,\"t0\":8.322600000000005},{\"alpha\":0.99,\"li\":11.275180698016742,\"ui\":999.2249394872628,\"lower\":7.515996998360224,\"upper\":9.562271352084549,\"t0\":8.322600000000005}],\"skewness\":[{\"alpha\":0.975,\"li\":4.800798052046192,\"ui\":974.7723596754158,\"lower\":-0.14680097912043247,\"upper\":0.19613974298109926,\"t0\":0.06434722625461556},{\"alpha\":0.99,\"li\":1.416247401358393,\"ui\":988.0834915007305,\"lower\":-0.1793392580117366,\"upper\":0.22665980345721032,\"t0\":0.06434722625461556}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.048592089193747,\"ui\":989.0603810366453,\"lower\":-1.3693450482928553,\"upper\":-1.1277274724890543,\"t0\":-1.2604129665112098},{\"alpha\":0.99,\"li\":5.803864494004486,\"ui\":996.7773413304948,\"lower\":-1.3780234678769976,\"upper\":-1.1018634816615733,\"t0\":-1.2604129665112098}],\"n\":400.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":13.001820720442986,\"ui\":988.952408067859,\"lower\":0.031467343336621,\"upper\":0.26262403381819843,\"t0\":0.148522063003541},{\"alpha\":0.99,\"li\":5.126075945592325,\"ui\":996.1110974667636,\"lower\":0.02078524404195243,\"upper\":0.2783651445051017,\"t0\":0.148522063003541}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":400.0}}}}")
    val CI5 = boot.showCIsByGroupId(sampleRDD, 5)
    CI5 must be("{\"groupId_5\":{\"idxLevel\":5,\"depth\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":5.807371652340048,\"ui\":976.6231606457545,\"lower\":34.746992031539094,\"upper\":43.947884026620926,\"t0\":40.016666666666666},{\"alpha\":0.99,\"li\":2.0166460421257213,\"ui\":990.0019842985636,\"lower\":34.203343576693776,\"upper\":44.53893121072645,\"t0\":40.016666666666666}],\"variance\":[{\"alpha\":0.975,\"li\":9.598858247906461,\"ui\":985.0734899103174,\"lower\":520.3916244576932,\"upper\":801.0418208596449,\"t0\":666.9830555555557},{\"alpha\":0.99,\"li\":3.4770494209823264,\"ui\":994.0570315754167,\"lower\":491.5198491779526,\"upper\":817.830953580542,\"t0\":666.9830555555557}],\"skewness\":[{\"alpha\":0.975,\"li\":41.386294618120154,\"ui\":999.0673356735291,\"lower\":0.5757923392879207,\"upper\":1.2172584705079528,\"t0\":0.7907282464546516},{\"alpha\":0.99,\"li\":22.7470782823444,\"ui\":1000.0,\"lower\":0.5564177485487616,\"upper\":1.26753710420678,\"t0\":0.7907282464546516}],\"kurtosis\":[{\"alpha\":0.975,\"li\":55.16775856044511,\"ui\":1000.0,\"lower\":-0.8379181629563937,\"upper\":0.8265520373090027,\"t0\":-0.44712831949803},{\"alpha\":0.99,\"li\":35.89880595656125,\"ui\":1000.0,\"lower\":-0.8636094095728459,\"upper\":0.8265520373090027,\"t0\":-0.44712831949803}],\"n\":180.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":5.792335798630982,\"ui\":976.7074524825348,\"lower\":3.0790047112610712,\"upper\":3.9444444444444446,\"t0\":3.5722222222222224},{\"alpha\":0.99,\"li\":1.988621536812666,\"ui\":989.9637487670982,\"lower\":2.977353556125908,\"upper\":4.0273599342669675,\"t0\":3.5722222222222224}],\"variance\":[{\"alpha\":0.975,\"li\":7.631727985424431,\"ui\":981.8008098378372,\"lower\":4.9971026423289615,\"upper\":7.5789293496157555,\"t0\":6.3781172839506155},{\"alpha\":0.99,\"li\":2.6132298775559395,\"ui\":992.2925807990047,\"lower\":4.532201913895472,\"upper\":7.759898757342279,\"t0\":6.3781172839506155}],\"skewness\":[{\"alpha\":0.975,\"li\":38.523141904599136,\"ui\":998.8782391695405,\"lower\":0.5841853873612951,\"upper\":1.2352178796516633,\"t0\":0.8051385927026496},{\"alpha\":0.99,\"li\":21.300467761929223,\"ui\":1000.0,\"lower\":0.5605223574615389,\"upper\":1.3009484491163577,\"t0\":0.8051385927026496}],\"kurtosis\":[{\"alpha\":0.975,\"li\":60.528186186094125,\"ui\":1000.0,\"lower\":-0.856246599646125,\"upper\":0.8812661781386029,\"t0\":-0.47340357379950065},{\"alpha\":0.99,\"li\":40.3282467352911,\"ui\":1000.0,\"lower\":-0.8821434194378056,\"upper\":0.8812661781386029,\"t0\":-0.47340357379950065}],\"n\":180.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":7.558855519619802,\"ui\":980.7677557256964,\"lower\":3.8254070779127054,\"upper\":4.726466886316727,\"t0\":4.294444444444444},{\"alpha\":0.99,\"li\":2.9149560945605533,\"ui\":992.5729951221427,\"lower\":3.8087037663226604,\"upper\":4.82533492977968,\"t0\":4.294444444444444}],\"variance\":[{\"alpha\":0.975,\"li\":24.318882104166907,\"ui\":994.9808271754026,\"lower\":6.2906712675164025,\"upper\":8.56810263068377,\"t0\":7.318858024691362},{\"alpha\":0.99,\"li\":10.575106757225086,\"ui\":998.7900677746751,\"lower\":6.079270599694481,\"upper\":8.800081106947212,\"t0\":7.318858024691362}],\"skewness\":[{\"alpha\":0.975,\"li\":13.918263853465646,\"ui\":989.6681535678663,\"lower\":-0.21844775887454632,\"upper\":0.28303158605727086,\"t0\":0.050703336373058475},{\"alpha\":0.99,\"li\":5.143148942975179,\"ui\":996.1173579854973,\"lower\":-0.2787852081261529,\"upper\":0.32114033206129916,\"t0\":0.050703336373058475}],\"kurtosis\":[{\"alpha\":0.975,\"li\":11.646610903550092,\"ui\":987.2535343910431,\"lower\":-1.302930893874222,\"upper\":-0.88043095764607,\"t0\":-1.1354640171201889},{\"alpha\":0.99,\"li\":5.939065098625893,\"ui\":997.0717748386104,\"lower\":-1.3313714607821339,\"upper\":-0.8172480115929748,\"t0\":-1.1354640171201889}],\"n\":180.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":17.772837856420104,\"ui\":992.4636645759985,\"lower\":0.015983274801511516,\"upper\":0.3279569417234035,\"t0\":0.1599199362835206},{\"alpha\":0.99,\"li\":7.675066017321283,\"ui\":997.866562869104,\"lower\":-0.004359526039213309,\"upper\":0.3628075545636874,\"t0\":0.1599199362835206}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":180.0}}}}")
    val CI6 = boot.showCIsByGroupId(sampleRDD, 6)
    CI6 must be("{\"groupId_6\":{\"idxLevel\":6,\"depth\":2,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":16.639447796213144,\"ui\":991.7689838874701,\"lower\":33.96202453551927,\"upper\":41.63348723371986,\"t0\":37.63181818181818},{\"alpha\":0.99,\"li\":7.05628992659814,\"ui\":997.534778937473,\"lower\":33.396701995013224,\"upper\":42.21875781312885,\"t0\":37.63181818181818}],\"variance\":[{\"alpha\":0.975,\"li\":21.43196976728785,\"ui\":994.1422212470201,\"lower\":536.7521813647647,\"upper\":773.2633186764253,\"t0\":647.3053512396691},{\"alpha\":0.99,\"li\":9.441861359693945,\"ui\":998.5414515378159,\"lower\":525.5098180529981,\"upper\":805.6394233689148,\"t0\":647.3053512396691}],\"skewness\":[{\"alpha\":0.975,\"li\":21.373225886376968,\"ui\":994.7717303100184,\"lower\":0.5760330654984899,\"upper\":1.1528422170969501,\"t0\":0.800068475347844},{\"alpha\":0.99,\"li\":10.611634379930662,\"ui\":999.1957592868407,\"lower\":0.543689581106803,\"upper\":1.257907191939997,\"t0\":0.800068475347844}],\"kurtosis\":[{\"alpha\":0.975,\"li\":41.27083706932741,\"ui\":999.974660382575,\"lower\":-0.9218156042769152,\"upper\":0.6132300636060773,\"t0\":-0.5461403994791622},{\"alpha\":0.99,\"li\":25.85389059275096,\"ui\":1000.0,\"lower\":-0.9623633260615481,\"upper\":0.6159854094634508,\"t0\":-0.5461403994791622}],\"n\":220.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":14.183184974592368,\"ui\":990.0226246574185,\"lower\":2.9963076812412752,\"upper\":3.7319169652598405,\"t0\":3.3545454545454545},{\"alpha\":0.99,\"li\":5.910368525869476,\"ui\":996.7967686892192,\"lower\":2.931060648959104,\"upper\":3.7949988974002378,\"t0\":3.3545454545454545}],\"variance\":[{\"alpha\":0.975,\"li\":20.082971228362137,\"ui\":993.5794304548264,\"lower\":5.130209274454053,\"upper\":7.369963604159969,\"t0\":6.174297520661156},{\"alpha\":0.99,\"li\":8.762660413221473,\"ui\":998.307689406828,\"lower\":5.027259906512026,\"upper\":7.589170572672267,\"t0\":6.174297520661156}],\"skewness\":[{\"alpha\":0.975,\"li\":21.206302257642864,\"ui\":994.6864377946137,\"lower\":0.5958430877706441,\"upper\":1.1487462573751936,\"t0\":0.8205086823182445},{\"alpha\":0.99,\"li\":10.493736600019167,\"ui\":999.1575662356245,\"lower\":0.5670744105006791,\"upper\":1.2689932601798886,\"t0\":0.8205086823182445}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.939464104492124,\"ui\":999.6967311090518,\"lower\":-0.9370268091916304,\"upper\":0.563036634742097,\"t0\":-0.548237462388742},{\"alpha\":0.99,\"li\":23.951356153468094,\"ui\":1000.0,\"lower\":-0.9577295527602914,\"upper\":0.5725950527820659,\"t0\":-0.548237462388742}],\"n\":220.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":18.155187124489487,\"ui\":992.80060984601,\"lower\":3.677992005001181,\"upper\":4.584474305292876,\"t0\":4.086363636363636},{\"alpha\":0.99,\"li\":8.125812638374272,\"ui\":998.1365679697077,\"lower\":3.5848104143109003,\"upper\":4.637606057893662,\"t0\":4.086363636363636}],\"variance\":[{\"alpha\":0.975,\"li\":17.144047777725103,\"ui\":991.7947229588281,\"lower\":7.98091585904539,\"upper\":10.215428670746048,\"t0\":9.124359504132237},{\"alpha\":0.99,\"li\":6.64893449151304,\"ui\":997.1828989952876,\"lower\":7.783757387732329,\"upper\":10.419206315784608,\"t0\":9.124359504132237}],\"skewness\":[{\"alpha\":0.975,\"li\":11.161946668082505,\"ui\":987.0364864795931,\"lower\":-0.15662313537261024,\"upper\":0.3208682898300351,\"t0\":0.09050319987442054},{\"alpha\":0.99,\"li\":4.2876568498252885,\"ui\":995.19765900154,\"lower\":-0.18700479755616625,\"upper\":0.3615283340137374,\"t0\":0.09050319987442054}],\"kurtosis\":[{\"alpha\":0.975,\"li\":15.98061042004264,\"ui\":992.2508190477072,\"lower\":-1.4615463339334582,\"upper\":-1.1623852834648232,\"t0\":-1.3547827181209577},{\"alpha\":0.99,\"li\":8.657131222648777,\"ui\":998.913843132345,\"lower\":-1.4827396504312425,\"upper\":-1.1456582626648923,\"t0\":-1.3547827181209577}],\"n\":220.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":11.271154718122887,\"ui\":987.1480325591325,\"lower\":-0.013746497461662809,\"upper\":0.2836142780394877,\"t0\":0.13823533840841254},{\"alpha\":0.99,\"li\":4.391641576034432,\"ui\":995.3174029524696,\"lower\":-0.030569591742587596,\"upper\":0.2964689080465983,\"t0\":0.13823533840841254}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":220.0}}}}")*/
  }

  test("sample CIs by Level are correct") {
    /*val CI1 = boot.showCIsByLevel(sampleRDD, 1)
    CI1 must be (Array("{\"groupId_4\":{\"idxLevel\":4,\"depth\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.648497844707329,\"ui\":991.2598014650314,\"lower\":36.13309545766261,\"upper\":41.806255433639485,\"t0\":38.705},{\"alpha\":0.99,\"li\":6.9413770428370825,\"ui\":997.5537988299462,\"lower\":35.90667471565007,\"upper\":42.009990858124894,\"t0\":38.705}],\"variance\":[{\"alpha\":0.975,\"li\":14.42028414658128,\"ui\":990.1442415833104,\"lower\":567.7315608856235,\"upper\":752.8274641622212,\"t0\":657.5679750000002},{\"alpha\":0.99,\"li\":5.757790190490939,\"ui\":996.6459593851806,\"lower\":548.2048914918718,\"upper\":763.1995041252566,\"t0\":657.5679750000002}],\"skewness\":[{\"alpha\":0.975,\"li\":16.573882251684914,\"ui\":991.791428701478,\"lower\":0.6137285069723721,\"upper\":1.0085163781060416,\"t0\":0.7953599680436109},{\"alpha\":0.99,\"li\":7.171749893009289,\"ui\":997.6311316074713,\"lower\":0.5913386750542904,\"upper\":1.0401580743081007,\"t0\":0.7953599680436109}],\"kurtosis\":[{\"alpha\":0.975,\"li\":33.33839515461467,\"ui\":998.3608677517046,\"lower\":-0.7981309118645531,\"upper\":0.09554511422400304,\"t0\":-0.49496390027104353},{\"alpha\":0.99,\"li\":18.529253436574415,\"ui\":1000.0,\"lower\":-0.828902093172043,\"upper\":0.2814815772598688,\"t0\":-0.49496390027104353}],\"n\":400.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":14.781710507419128,\"ui\":990.6229641092168,\"lower\":3.1975,\"upper\":3.75113140216696,\"t0\":3.4525},{\"alpha\":0.99,\"li\":6.581106676686053,\"ui\":997.3447503412865,\"lower\":3.1789938930762296,\"upper\":3.7825,\"t0\":3.4525}],\"variance\":[{\"alpha\":0.975,\"li\":13.322029992028309,\"ui\":989.2502193225301,\"lower\":5.442576072911556,\"upper\":7.176859918451924,\"t0\":6.277743750000001},{\"alpha\":0.99,\"li\":5.339595834286819,\"ui\":996.3089650130781,\"lower\":5.265742969443667,\"upper\":7.2562509676677225,\"t0\":6.277743750000001}],\"skewness\":[{\"alpha\":0.975,\"li\":16.220876792213726,\"ui\":991.5674843119109,\"lower\":0.625328915373168,\"upper\":1.0261951359147174,\"t0\":0.8133183960691303},{\"alpha\":0.99,\"li\":7.009465890753459,\"ui\":997.5434503459402,\"lower\":0.6027650800966973,\"upper\":1.0452939020970133,\"t0\":0.8133183960691303}],\"kurtosis\":[{\"alpha\":0.975,\"li\":31.691410653788473,\"ui\":998.0463393939915,\"lower\":-0.821667046807825,\"upper\":0.05344583595793991,\"t0\":-0.5086785567303166},{\"alpha\":0.99,\"li\":17.42136451213197,\"ui\":1000.0,\"lower\":-0.8592293975352642,\"upper\":0.19739112747032186,\"t0\":-0.5086785567303166}],\"n\":400.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":17.934247696983494,\"ui\":992.7127015768666,\"lower\":3.875,\"upper\":4.5125,\"t0\":4.18},{\"alpha\":0.99,\"li\":8.082693046939715,\"ui\":998.1357424210653,\"lower\":3.8279336913202546,\"upper\":4.616161830853282,\"t0\":4.18}],\"variance\":[{\"alpha\":0.975,\"li\":23.50507771395785,\"ui\":995.2937346128323,\"lower\":7.628513178189983,\"upper\":9.319984747002348,\"t0\":8.322600000000005},{\"alpha\":0.99,\"li\":11.275180698016742,\"ui\":999.2249394872628,\"lower\":7.515996998360224,\"upper\":9.562271352084549,\"t0\":8.322600000000005}],\"skewness\":[{\"alpha\":0.975,\"li\":4.800798052046192,\"ui\":974.7723596754158,\"lower\":-0.14680097912043247,\"upper\":0.19613974298109926,\"t0\":0.06434722625461556},{\"alpha\":0.99,\"li\":1.416247401358393,\"ui\":988.0834915007305,\"lower\":-0.1793392580117366,\"upper\":0.22665980345721032,\"t0\":0.06434722625461556}],\"kurtosis\":[{\"alpha\":0.975,\"li\":13.048592089193747,\"ui\":989.0603810366453,\"lower\":-1.3693450482928553,\"upper\":-1.1277274724890543,\"t0\":-1.2604129665112098},{\"alpha\":0.99,\"li\":5.803864494004486,\"ui\":996.7773413304948,\"lower\":-1.3780234678769976,\"upper\":-1.1018634816615733,\"t0\":-1.2604129665112098}],\"n\":400.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":13.001820720442986,\"ui\":988.952408067859,\"lower\":0.031467343336621,\"upper\":0.26262403381819843,\"t0\":0.148522063003541},{\"alpha\":0.99,\"li\":5.126075945592325,\"ui\":996.1110974667636,\"lower\":0.02078524404195243,\"upper\":0.2783651445051017,\"t0\":0.148522063003541}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":400.0}}}}",
      "{\"groupId_1\":{\"idxLevel\":1,\"depth\":1,\"CIs\":{\"d1d2\":{\"mean\":[{\"alpha\":0.975,\"li\":7.701681483921061,\"ui\":981.6576174125446,\"lower\":36.24401631641499,\"upper\":40.47856270976209,\"t0\":38.47666666666667},{\"alpha\":0.99,\"li\":2.759995588578292,\"ui\":992.4911549117165,\"lower\":35.73933671928579,\"upper\":40.75434762115576,\"t0\":38.47666666666667}],\"variance\":[{\"alpha\":0.975,\"li\":10.774028331068894,\"ui\":986.569144027905,\"lower\":545.2834044110515,\"upper\":683.993422004782,\"t0\":615.9761222222221},{\"alpha\":0.99,\"li\":4.108188810082528,\"ui\":994.9644368176669,\"lower\":540.2233777227452,\"upper\":697.8207063331744,\"t0\":615.9761222222221}],\"skewness\":[{\"alpha\":0.975,\"li\":27.835746996160374,\"ui\":996.7151770055613,\"lower\":0.7054089498108999,\"upper\":1.0323931085686044,\"t0\":0.8314262615548288},{\"alpha\":0.99,\"li\":14.026503098741388,\"ui\":999.8004352390903,\"lower\":0.6845663948357598,\"upper\":1.0575518873186498,\"t0\":0.8314262615548288}],\"kurtosis\":[{\"alpha\":0.975,\"li\":40.222494700488596,\"ui\":999.4202276639612,\"lower\":-0.6940711972386032,\"upper\":0.1833244676633252,\"t0\":-0.4441265259643384},{\"alpha\":0.99,\"li\":23.522432826258047,\"ui\":1000.0,\"lower\":-0.7182784006670586,\"upper\":0.3474653904997046,\"t0\":-0.4441265259643384}],\"n\":600.0},\"d1\":{\"mean\":[{\"alpha\":0.975,\"li\":7.656277722671019,\"ui\":981.6434909582745,\"lower\":3.191666666666667,\"upper\":3.6198590181183548,\"t0\":3.4166666666666665},{\"alpha\":0.99,\"li\":2.708482268002058,\"ui\":992.4081604028345,\"lower\":3.131666666666667,\"upper\":3.6486455055364306,\"t0\":3.4166666666666665}],\"variance\":[{\"alpha\":0.975,\"li\":9.792451700147137,\"ui\":985.2391524103057,\"lower\":5.264030570038333,\"upper\":6.639668381420138,\"t0\":5.989722222222223},{\"alpha\":0.99,\"li\":3.6899017669141996,\"ui\":994.3397144017969,\"lower\":5.196164934392337,\"upper\":6.760944725065862,\"t0\":5.989722222222223}],\"skewness\":[{\"alpha\":0.975,\"li\":30.432443798519852,\"ui\":997.2748906067527,\"lower\":0.7293452697038588,\"upper\":1.0636955746702363,\"t0\":0.8552433320675884},{\"alpha\":0.99,\"li\":15.49167406546206,\"ui\":999.9812796230228,\"lower\":0.7106837334911889,\"upper\":1.0940042685496782,\"t0\":0.8552433320675884}],\"kurtosis\":[{\"alpha\":0.975,\"li\":38.016812731591216,\"ui\":999.1237031685939,\"lower\":-0.7011201644677231,\"upper\":0.12657781128176815,\"t0\":-0.44016533712385203},{\"alpha\":0.99,\"li\":21.868306551526416,\"ui\":1000.0,\"lower\":-0.7322615921897895,\"upper\":0.3677063471106695,\"t0\":-0.44016533712385203}],\"n\":600.0},\"d2\":{\"mean\":[{\"alpha\":0.975,\"li\":15.062527490511325,\"ui\":990.6044948163249,\"lower\":4.056880601935006,\"upper\":4.567657510816443,\"t0\":4.31},{\"alpha\":0.99,\"li\":6.0007889579710785,\"ui\":996.8182719760445,\"lower\":4.0050098635305655,\"upper\":4.601689818191923,\"t0\":4.31}],\"variance\":[{\"alpha\":0.975,\"li\":9.491916552346751,\"ui\":984.7382792726111,\"lower\":7.434816871708476,\"upper\":8.698818004472793,\"t0\":8.087233333333337},{\"alpha\":0.99,\"li\":3.610298746226806,\"ui\":994.1794547399652,\"lower\":7.398152745167515,\"upper\":8.805088969237126,\"t0\":8.087233333333337}],\"skewness\":[{\"alpha\":0.975,\"li\":10.598832080283746,\"ui\":986.3389072816548,\"lower\":-0.05334125437905046,\"upper\":0.21514685244521595,\"t0\":0.08300889305900883},{\"alpha\":0.99,\"li\":4.048608805793303,\"ui\":994.8773868527499,\"lower\":-0.07368834122172291,\"upper\":0.2320181970449949,\"t0\":0.08300889305900883}],\"kurtosis\":[{\"alpha\":0.975,\"li\":22.915854861305334,\"ui\":995.4907973244096,\"lower\":-1.3035902717684495,\"upper\":-1.0710559494885825,\"t0\":-1.2128782358238617},{\"alpha\":0.99,\"li\":11.674070544614652,\"ui\":999.4982585545698,\"lower\":-1.3124248972764776,\"upper\":-1.0595667129248596,\"t0\":-1.2128782358238617}],\"n\":600.0},\"r\":{\"pearson\":[{\"alpha\":0.975,\"li\":7.790761946131509,\"ui\":981.6504796042149,\"lower\":-0.030439323413083665,\"upper\":0.14568500671818368,\"t0\":0.06405738537356781},{\"alpha\":0.99,\"li\":2.8772461134871192,\"ui\":992.6720670934233,\"lower\":-0.041629419338242386,\"upper\":0.15697307730955684,\"t0\":0.06405738537356781}],\"alpha0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"alpha1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta0\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"beta1\":[{\"alpha\":0.975,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0},{\"alpha\":0.99,\"li\":\"Infinity\",\"ui\":\"-Infinity\",\"lower\":\"Infinity\",\"upper\":\"-Infinity\",\"t0\":0.0}],\"n\":600.0}}}}"))*/
  }

  test("results by Group ID are correct") {
    val r0 = boot.showResultsByGroupId(resultsRDD, 0)
    r0 must be("{\"groupId_0\":{\"idxLevel\":0,\"depth\":0,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":true,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":true,\"contains\":true},\"alpha1\":{\"overlaps\":true,\"contains\":true},\"beta0\":{\"overlaps\":true,\"contains\":true},\"beta1\":{\"overlaps\":true,\"contains\":true}}}}}")
    val r1 = boot.showResultsByGroupId(resultsRDD, 1)
    r1 must be("{\"groupId_1\":{\"idxLevel\":1,\"depth\":1,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}")
    val r2 = boot.showResultsByGroupId(resultsRDD, 2)
    r2 must be("{\"groupId_2\":{\"idxLevel\":2,\"depth\":2,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}")
    val r3 = boot.showResultsByGroupId(resultsRDD, 3)
    r3 must be("{\"groupId_3\":{\"idxLevel\":3,\"depth\":2,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}")
    val r4 = boot.showResultsByGroupId(resultsRDD, 4)
    r4 must be("{\"groupId_4\":{\"idxLevel\":4,\"depth\":1,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}")
    val r5 = boot.showResultsByGroupId(resultsRDD, 5)
    r5 must be("{\"groupId_5\":{\"idxLevel\":5,\"depth\":2,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}")
    val r6 = boot.showResultsByGroupId(resultsRDD, 6)
    r6 must be("{\"groupId_6\":{\"idxLevel\":6,\"depth\":2,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}")
  }

  test("results by Level are correct") {
    val r1 = boot.showResultsByLevel(resultsRDD, 1)
    r1 must be(Array("{\"groupId_4\":{\"idxLevel\":4,\"depth\":1,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}",
      "{\"groupId_1\":{\"idxLevel\":1,\"depth\":1,\"results\":{\"stats\":true,\"d1d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d1\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"d2\":{\"mean\":{\"overlaps\":true,\"contains\":true},\"variance\":{\"overlaps\":true,\"contains\":true},\"skewness\":{\"overlaps\":true,\"contains\":true},\"kurtosis\":{\"overlaps\":true,\"contains\":true}},\"regs\":false,\"r\":{\"pearson\":{\"overlaps\":true,\"contains\":true},\"alpha0\":{\"overlaps\":false,\"contains\":false},\"alpha1\":{\"overlaps\":false,\"contains\":false},\"beta0\":{\"overlaps\":false,\"contains\":false},\"beta1\":{\"overlaps\":false,\"contains\":false}}}}}"))
  }
}
